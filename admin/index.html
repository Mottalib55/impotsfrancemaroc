<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - NetSalaire</title>

    <!-- IMPORTANT: No indexing -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">

    <link href="/assets/css/tailwind.min.css" rel="stylesheet">
    <script defer src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <style>
        body { font-family: 'Inter', system-ui, sans-serif; }
        .card { transition: all 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-slate-900 min-h-screen">

    <!-- Access Control -->
    <div id="lockScreen" class="fixed inset-0 bg-slate-900 z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="w-16 h-16 bg-indigo-600 rounded-2xl flex items-center justify-center text-white text-2xl font-bold mx-auto mb-4">N.</div>
            <h1 class="text-white text-xl font-semibold mb-2">Admin Dashboard</h1>
            <p class="text-slate-400 text-sm mb-6">Entrez le code d'acces</p>
            <input type="password" id="accessCode" placeholder="Code..."
                   class="bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 text-white text-center w-48 focus:outline-none focus:border-indigo-500"
                   onkeypress="if(event.key==='Enter')checkAccess()">
            <br>
            <button onclick="checkAccess()" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg text-sm">
                Acceder
            </button>
            <p id="errorMsg" class="text-red-400 text-sm mt-3 hidden">Code incorrect</p>
        </div>
    </div>

    <script>
        const AUTH_DURATION = 24 * 60 * 60 * 1000; // 24 heures en ms

        function checkAccess() {
            const code = document.getElementById('accessCode').value;
            if (code === 'Sofia') {
                document.getElementById('lockScreen').style.display = 'none';
                // Sauvegarder avec expiration de 24h
                const expiry = Date.now() + AUTH_DURATION;
                localStorage.setItem('admin_auth', JSON.stringify({ granted: true, expiry: expiry }));
            } else {
                document.getElementById('errorMsg').classList.remove('hidden');
                document.getElementById('accessCode').value = '';
            }
        }

        // Verifier si deja authentifie (valide 24h)
        function isAuthenticated() {
            const auth = localStorage.getItem('admin_auth');
            if (!auth) return false;
            try {
                const { granted, expiry } = JSON.parse(auth);
                if (granted && expiry > Date.now()) return true;
                localStorage.removeItem('admin_auth'); // Expire, on supprime
            } catch (e) {}
            return false;
        }

        if (isAuthenticated()) {
            document.getElementById('lockScreen').style.display = 'none';
        }
    </script>

    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold">N.</div>
                <div>
                    <h1 class="text-white font-semibold">NetSalaire Admin</h1>
                    <p class="text-slate-400 text-xs">Dashboard prive</p>
                </div>
            </div>
            <a href="/" class="text-slate-400 hover:text-white text-sm flex items-center gap-2">
                <iconify-icon icon="lucide:external-link" width="16"></iconify-icon>
                Voir le site
            </a>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-8">

        <!-- Quick Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <p class="text-slate-400 text-sm">Pages FR</p>
                <p class="text-2xl font-bold text-white">15+</p>
            </div>
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <p class="text-slate-400 text-sm">Pages EN</p>
                <p class="text-2xl font-bold text-white">12+</p>
            </div>
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <p class="text-slate-400 text-sm">Simulateurs</p>
                <p class="text-2xl font-bold text-emerald-400">10</p>
            </div>
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <p class="text-slate-400 text-sm">Pays</p>
                <p class="text-2xl font-bold text-amber-400">2</p>
            </div>
        </div>

        <!-- Quick Links -->
        <h2 class="text-white font-semibold mb-4 flex items-center gap-2">
            <iconify-icon icon="lucide:link" width="20" class="text-indigo-400"></iconify-icon>
            Liens Rapides
        </h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <a href="https://analytics.google.com/" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-indigo-500">
                <div class="w-10 h-10 bg-amber-500/20 rounded-lg flex items-center justify-center mb-3">
                    <iconify-icon icon="logos:google-analytics" width="24"></iconify-icon>
                </div>
                <p class="text-white font-medium">Google Analytics</p>
                <p class="text-slate-400 text-xs">Statistiques du site</p>
            </a>
            <a href="https://search.google.com/search-console" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-indigo-500">
                <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center mb-3">
                    <iconify-icon icon="logos:google-icon" width="24"></iconify-icon>
                </div>
                <p class="text-white font-medium">Search Console</p>
                <p class="text-slate-400 text-xs">SEO & Indexation</p>
            </a>
            <a href="https://github.com/Mottalib55/impotsfrancemaroc" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-indigo-500">
                <div class="w-10 h-10 bg-slate-500/20 rounded-lg flex items-center justify-center mb-3">
                    <iconify-icon icon="mdi:github" width="24" class="text-white"></iconify-icon>
                </div>
                <p class="text-white font-medium">GitHub Repo</p>
                <p class="text-slate-400 text-xs">Code source</p>
            </a>
            <a href="https://pagespeed.web.dev/" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-indigo-500">
                <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center mb-3">
                    <iconify-icon icon="lucide:zap" width="24" class="text-green-400"></iconify-icon>
                </div>
                <p class="text-white font-medium">PageSpeed</p>
                <p class="text-slate-400 text-xs">Performance</p>
            </a>
        </div>

        <!-- Site Structure -->
        <h2 class="text-white font-semibold mb-4 flex items-center gap-2">
            <iconify-icon icon="lucide:folder-tree" width="20" class="text-indigo-400"></iconify-icon>
            Structure du Site
        </h2>
        <div class="grid md:grid-cols-2 gap-6 mb-8">

            <!-- France FR -->
            <div class="bg-slate-800 rounded-xl border border-slate-700 overflow-hidden">
                <div class="bg-indigo-600/20 px-4 py-3 border-b border-slate-700 flex items-center gap-2">
                    <iconify-icon icon="circle-flags:fr" width="20"></iconify-icon>
                    <span class="text-white font-medium">France (FR)</span>
                </div>
                <div class="p-4 space-y-2">
                    <a href="/fr/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Accueil</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-salaire-brut-net/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Brut vers Net</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-impot-revenu/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Impot sur le Revenu</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-chomage-are/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Chomage ARE</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-indemnite-licenciement/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Indemnite Licenciement</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-rupture-conventionnelle/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Rupture Conventionnelle</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-apl/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>APL</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/simulateur-indemnite-kilometrique/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Frais Kilometriques</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/france/guide/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Guide Fiscal</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                </div>
            </div>

            <!-- France EN -->
            <div class="bg-slate-800 rounded-xl border border-slate-700 overflow-hidden">
                <div class="bg-blue-600/20 px-4 py-3 border-b border-slate-700 flex items-center gap-2">
                    <iconify-icon icon="circle-flags:gb" width="20"></iconify-icon>
                    <span class="text-white font-medium">France (EN)</span>
                </div>
                <div class="p-4 space-y-2">
                    <a href="/en/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Home</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/gross-to-net/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Gross to Net</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/income-tax/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Income Tax</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/unemployment-calculator/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Unemployment Calculator</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/severance-calculator/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Severance Calculator</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/mutual-termination-calculator/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Mutual Termination</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/housing-benefit-calculator/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Housing Benefit (APL)</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/mileage-calculator/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Mileage Calculator</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/en/france/tax-guide/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Tax Guide</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                </div>
            </div>

            <!-- Maroc FR -->
            <div class="bg-slate-800 rounded-xl border border-slate-700 overflow-hidden">
                <div class="bg-emerald-600/20 px-4 py-3 border-b border-slate-700 flex items-center gap-2">
                    <iconify-icon icon="circle-flags:ma" width="20"></iconify-icon>
                    <span class="text-white font-medium">Maroc (FR)</span>
                </div>
                <div class="p-4 space-y-2">
                    <a href="/fr/maroc/simulateur-salaire-brut-net/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Brut vers Net</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/maroc/simulateur-impot-revenu/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Simulateur IR</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/maroc/guide/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Guide Fiscal</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                </div>
            </div>

            <!-- Other Pages -->
            <div class="bg-slate-800 rounded-xl border border-slate-700 overflow-hidden">
                <div class="bg-purple-600/20 px-4 py-3 border-b border-slate-700 flex items-center gap-2">
                    <iconify-icon icon="lucide:file-text" width="20" class="text-purple-400"></iconify-icon>
                    <span class="text-white font-medium">Autres Pages</span>
                </div>
                <div class="p-4 space-y-2">
                    <a href="/fr/comparateur-salaire-france-maroc/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Comparateur France/Maroc</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/comparateur-global/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Comparateur Global</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/faq/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>FAQ</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/fr/mentions-legales/" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Mentions Legales</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/sitemap.xml" target="_blank" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Sitemap XML</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                    <a href="/robots.txt" target="_blank" class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50 text-slate-300 hover:text-white">
                        <span>Robots.txt</span>
                        <iconify-icon icon="lucide:external-link" width="14" class="text-slate-500"></iconify-icon>
                    </a>
                </div>
            </div>
        </div>

        <!-- SEO Tools -->
        <h2 class="text-white font-semibold mb-4 flex items-center gap-2">
            <iconify-icon icon="lucide:search" width="20" class="text-indigo-400"></iconify-icon>
            Outils SEO
        </h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <a href="https://www.google.com/search?q=site:netsalaire.com" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-emerald-500 text-center">
                <iconify-icon icon="logos:google-icon" width="28" class="mb-2"></iconify-icon>
                <p class="text-white text-sm">Pages indexees</p>
            </a>
            <a href="https://search.google.com/test/rich-results?url=https://netsalaire.com" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-emerald-500 text-center">
                <iconify-icon icon="lucide:star" width="28" class="text-amber-400 mb-2"></iconify-icon>
                <p class="text-white text-sm">Rich Results Test</p>
            </a>
            <a href="https://search.google.com/test/mobile-friendly?url=https://netsalaire.com" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-emerald-500 text-center">
                <iconify-icon icon="lucide:smartphone" width="28" class="text-blue-400 mb-2"></iconify-icon>
                <p class="text-white text-sm">Mobile Test</p>
            </a>
            <a href="https://validator.w3.org/nu/?doc=https://netsalaire.com" target="_blank" class="card bg-slate-800 rounded-xl p-4 border border-slate-700 hover:border-emerald-500 text-center">
                <iconify-icon icon="lucide:code" width="28" class="text-purple-400 mb-2"></iconify-icon>
                <p class="text-white text-sm">HTML Validator</p>
            </a>
        </div>

        <!-- SEO Analyzer Section -->
        <h2 class="text-white font-semibold mb-4 flex items-center gap-2">
            <iconify-icon icon="lucide:search-check" width="20" class="text-indigo-400"></iconify-icon>
            Analyseur SEO Complet
        </h2>

        <!-- SEO Overview Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-8 h-8 bg-emerald-500/20 rounded-lg flex items-center justify-center">
                        <iconify-icon icon="lucide:check-circle" width="18" class="text-emerald-400"></iconify-icon>
                    </div>
                    <span class="text-slate-400 text-sm">Score Moyen</span>
                </div>
                <p class="text-2xl font-bold text-emerald-400" id="avgScore">--</p>
            </div>
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-8 h-8 bg-emerald-500/20 rounded-lg flex items-center justify-center">
                        <iconify-icon icon="lucide:thumbs-up" width="18" class="text-emerald-400"></iconify-icon>
                    </div>
                    <span class="text-slate-400 text-sm">Pages OK</span>
                </div>
                <p class="text-2xl font-bold text-emerald-400" id="pagesOk">--</p>
            </div>
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-8 h-8 bg-amber-500/20 rounded-lg flex items-center justify-center">
                        <iconify-icon icon="lucide:alert-triangle" width="18" class="text-amber-400"></iconify-icon>
                    </div>
                    <span class="text-slate-400 text-sm">A ameliorer</span>
                </div>
                <p class="text-2xl font-bold text-amber-400" id="pagesWarning">--</p>
            </div>
            <div class="bg-slate-800 rounded-xl p-4 border border-slate-700">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-8 h-8 bg-red-500/20 rounded-lg flex items-center justify-center">
                        <iconify-icon icon="lucide:x-circle" width="18" class="text-red-400"></iconify-icon>
                    </div>
                    <span class="text-slate-400 text-sm">Problemes</span>
                </div>
                <p class="text-2xl font-bold text-red-400" id="pagesError">--</p>
            </div>
        </div>

        <div class="bg-slate-800 rounded-xl border border-slate-700 overflow-hidden mb-8">
            <!-- Toolbar -->
            <div class="flex flex-wrap items-center justify-between gap-3 border-b border-slate-700 px-4 py-3 bg-slate-700/30">
                <div class="flex gap-2">
                    <button onclick="filterByScore('all')" class="seo-score-filter active px-3 py-1.5 text-xs font-medium rounded-lg bg-indigo-600 text-white" data-score="all">Tous</button>
                    <button onclick="filterByScore('good')" class="seo-score-filter px-3 py-1.5 text-xs font-medium rounded-lg bg-slate-600 text-slate-300 hover:bg-slate-500" data-score="good">
                        <span class="text-emerald-400">●</span> OK
                    </button>
                    <button onclick="filterByScore('warning')" class="seo-score-filter px-3 py-1.5 text-xs font-medium rounded-lg bg-slate-600 text-slate-300 hover:bg-slate-500" data-score="warning">
                        <span class="text-amber-400">●</span> Moyen
                    </button>
                    <button onclick="filterByScore('error')" class="seo-score-filter px-3 py-1.5 text-xs font-medium rounded-lg bg-slate-600 text-slate-300 hover:bg-slate-500" data-score="error">
                        <span class="text-red-400">●</span> Faible
                    </button>
                </div>
                <div class="flex gap-2">
                    <span id="changesCount" class="text-slate-400 text-xs hidden"><span class="text-amber-400 font-medium">0</span> modifications</span>
                    <button onclick="exportSEOChanges()" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-1">
                        <iconify-icon icon="lucide:download" width="14"></iconify-icon>
                        Exporter
                    </button>
                </div>
            </div>

            <!-- SEO Cards -->
            <div id="seoContainer" class="p-4 space-y-6 max-h-[800px] overflow-y-auto"></div>

            <!-- Legend -->
            <div class="px-4 py-3 bg-slate-700/30 border-t border-slate-700 flex flex-wrap gap-4 text-xs">
                <span><span class="text-emerald-400">●</span> Optimal (80-100)</span>
                <span><span class="text-amber-400">●</span> Moyen (50-79)</span>
                <span><span class="text-red-400">●</span> Faible (0-49)</span>
                <span class="ml-auto text-slate-500">Title: 50-60 chars | Desc: 140-160 chars</span>
            </div>
        </div>

        <!-- Export Modal -->
        <div id="exportModal" class="fixed inset-0 bg-black/70 z-50 hidden items-center justify-center p-4">
            <div class="bg-slate-800 rounded-xl border border-slate-700 max-w-2xl w-full max-h-[80vh] overflow-hidden">
                <div class="flex items-center justify-between px-4 py-3 border-b border-slate-700">
                    <h3 class="text-white font-medium">Exporter les modifications SEO</h3>
                    <button onclick="closeExportModal()" class="text-slate-400 hover:text-white">
                        <iconify-icon icon="lucide:x" width="20"></iconify-icon>
                    </button>
                </div>
                <div class="p-4">
                    <p class="text-slate-400 text-sm mb-3">Copie ce JSON et colle-le moi dans le chat. Je mettrai a jour tous les fichiers automatiquement.</p>
                    <textarea id="exportData" class="w-full h-64 bg-slate-900 border border-slate-700 rounded-lg p-3 text-slate-300 text-xs font-mono resize-none focus:outline-none focus:border-indigo-500"></textarea>
                    <div class="flex gap-2 mt-3">
                        <button onclick="copyExport()" class="flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium flex items-center justify-center gap-2">
                            <iconify-icon icon="lucide:copy" width="16"></iconify-icon>
                            Copier
                        </button>
                        <button onclick="closeExportModal()" class="px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg text-sm">Fermer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <h2 class="text-white font-semibold mb-4 flex items-center gap-2">
            <iconify-icon icon="lucide:sticky-note" width="20" class="text-indigo-400"></iconify-icon>
            Notes & Todo
        </h2>
        <div class="bg-slate-800 rounded-xl border border-slate-700 p-4 mb-8">
            <textarea id="notes" class="w-full h-40 bg-slate-900 border border-slate-700 rounded-lg p-4 text-slate-300 text-sm resize-none focus:outline-none focus:border-indigo-500" placeholder="Ecris tes notes ici... (sauvegarde automatique en local)"></textarea>
            <p class="text-slate-500 text-xs mt-2">Les notes sont sauvegardees dans le localStorage de ton navigateur.</p>
        </div>

    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-700 px-6 py-4 text-center">
        <p class="text-slate-500 text-sm">NetSalaire Admin - Page privee non indexee</p>
    </footer>

    <script>
        // Load saved notes
        const notesTextarea = document.getElementById('notes');
        const savedNotes = localStorage.getItem('netsalaire_admin_notes');
        if (savedNotes) {
            notesTextarea.value = savedNotes;
        }

        // Auto-save notes
        notesTextarea.addEventListener('input', function() {
            localStorage.setItem('netsalaire_admin_notes', this.value);
        });

        // SEO Data - All pages with current values
        // Paired FR/EN pages
        const seoPairs = [
            {
                name: "Accueil / Home",
                fr: { path: "/fr/", title: "Simulateur Impôts et Salaire Brut ⇒ Net | Gratuit et Rapide ", desc: "Calculez vos impôts et salaire brut en net gratuitement en 2 clics. Simulation détaillée horaire, mensuelle ou annuelle selon votre statut. Barèmes 2026." },
                en: { path: "/en/", title: "Tax & Gross ⇒ Net Salary Calculator 2026 | Free & Fast", desc: "Calculate your taxes and gross to net salary for free in 2 clicks. Detailed simulation with hourly, monthly or annual breakdown. 2026 tax rates." }
            },
            {
                name: "Brut Net France",
                fr: { path: "/fr/france/simulateur-salaire-brut-net/", title: "Calcul Salaire Brut en Net France 2026 → Simulateur Gratuit", desc: "Calculez votre salaire brut en net gratuitement. Simulation détaillée horaire, mensuelle ou annuelle selon votre statut. Barèmes 2026. calcul détaillé." },
                en: { path: "/en/france/gross-to-net/", title: "Gross to Net Salary France 2026 → Free Instant Calculator", desc: "Calculate your gross to net salary for free. Detailed simulation with hourly, monthly or annual breakdown based on your status. 2026 tax rates included." }
            },
            {
                name: "Impot Revenu France",
                fr: { path: "/fr/france/simulateur-impot-revenu/", title: "Simulateur Impôt sur le Revenu 2026 | Rapide et Précis", desc: "Calculez votre impôt sur le revenu et les réductions possibles : PER, crèche, dons, emploi à domicile, frais de scolarité. Simulation gratuite." },
                en: { path: "/en/france/income-tax/", title: "Income Tax Calculator France 2026 | Fast & Accurate", desc: "Calculate your income tax and possible deductions: retirement savings (PER), childcare, donations, home services, tuition fees. Free & instant simulation." }
            },
            {
                name: "Chomage ARE",
                fr: { path: "/fr/france/simulateur-chomage-are/", title: "Simulateur Chomage ARE 2026 - Calcul Gratuit et Instantane", desc: "Calculez votre indemnité et droits à l'allocation chômage ARE de France Travail. Simulateur gratuit avec les taux et tant journalier + duree." },
                en: { path: "/en/france/unemployment-calculator/", title: "Unemployment Benefits Calculator ARE 2026 - Free & Instant", desc: "Calculate your unemployment allowance and entitlements from France Travail (ARE). Free simulator with 2026 rates and scales. Daily amount + duration." }
            },
            {
                name: "Indemnite Licenciement",
                fr: { path: "/fr/france/simulateur-indemnite-licenciement/", title: "Calcul Indemnite Licenciement 2026 - Simulateur Gratuit", desc: "Ce simulateur permet d'estimer le montant de l'indemnité de licenciement d'un salarié. Simulateur basé sur salaire et anciennete. Connaissez vos droits !" },
                en: { path: "/en/france/severance-calculator/", title: "Severance Pay Calculator France 2026 - Free Simulator", desc: "Estimate your severance pay amount based on salary and seniority. Free 2025 calculator based on salary & seniority. Know your rights before negotiating!" }
            },
            {
                name: "Rupture Conventionnelle",
                fr: { path: "/fr/france/simulateur-rupture-conventionnelle/", title: "Simulateur Rupture Conventionnelle 2026 - Calcul Gratuit", desc: "Vous negociez votre depart ? Calculez votre indemnite de rupture conventionnelle instantanement. Minimum legal et conseils de negociation. Outil gratuit 2026." },
                en: { path: "/en/france/mutual-termination-calculator/", title: "Mutual Termination Calculator France 2026 - Quick & Free", desc: "Negotiating your departure? Calculate your severance package instantly. Legal minimum and negotiation tips included. Free and quick tool with 2026 rates." }
            },
            {
                name: "APL",
                fr: { path: "/fr/france/simulateur-apl/", title: "Simulateur APL 2026 - Calcul Aide au Logement Gratuit", desc: "Calculez et verifiez votre eligibilite APL. Simulateur avec baremes CAF officiels 2026. Cette aide peut être versée à toute personne qui loue un logement." },
                en: { path: "/en/france/housing-benefit-calculator/", title: "APL Housing Benefit Calculator France 2026 - Free Simulation", desc: "Check your eligibility for French housing assistance (APL). Free simulator with official CAF rates 2026. Available to anyone renting a property in France." }
            },
            {
                name: "Frais Kilometriques",
                fr: { path: "/fr/france/simulateur-indemnite-kilometrique/", title: "Calcul Frais Kilometriques Pro 2026 - Simulateur Précis", desc: "Vous utilisez votre vehicule pour le travail ? Calculez votre deduction fiscale instantanement. Bareme officiel 2026 + bonus 20% vehicule electrique inclus." },
                en: { path: "/en/france/mileage-calculator/", title: "Mileage Allowance Calculator France 2026 - Pro Simulator", desc: "Use your car for work? Calculate your tax deduction instantly. Official 2026 rates + 20% electric vehicle (EV) bonus included. Car, motorcycle, e-bike." }
            },
            {
                name: "Guide France",
                fr: { path: "/fr/france/guide/", title: "Guide Fiscal France 2025 – Tout Comprendre en 5 Minutes", desc: "Cotisations, tranches d'impôt, quotient familial... La fiscalité française expliquée simplement. Le guide simple et complet que tu aurais aimé avoir avant." },
                en: { path: "/en/france/tax-guide/", title: "French Tax Guide 2025 – Understand Everything in 5 Minutes", desc: "Understand French social charges, income tax brackets and net salary calculation. Taxation explained simply. The complete guide you wish you had before." }
            },
            {
                name: "Brut Net Maroc",
                fr: { path: "/fr/maroc/simulateur-salaire-brut-net/", title: "Calcul Salaire Brut en Net Maroc → Simulateur CNSS & IR", desc: "Calculez votre salaire net marocain instantanément. CNSS, AMO, IR avec barème progressif 2026. Abattement familial inclus. Résultat détaillé en dirhams & Euros." },
                en: { path: "/en/morocco/gross-to-net/", title: "Gross to Net Salary Calculator Morocco → CNSS & IR Simulator", desc: "Calculate your Moroccan net salary instantly. CNSS, AMO, IR with 2026 progressive tax brackets. Family allowance included. Results in dirhams & euros." }
            },
            {
                name: "IR Maroc",
                fr: { path: "/fr/maroc/simulateur-impot-revenu/", title: "Simulateur Impôt sur le Revenu Maroc 2026 | Rapide et Précis", desc: "Calculez votre impôt sur le revenu et les réductions possibles. Tranches 2025, abattements familiaux, frais pro inclus. Résultat instantané et gratuit." },
                en: { path: "/en/morocco/income-tax/", title: "Income Tax Calculator Morocco 2026 | Fast & Accurate", desc: "Calculate your Moroccan income tax and possible deductions. 2026 tax brackets, family allowances, professional expenses included. Free instant results." }
            },
            {
                name: "Guide Maroc",
                fr: { path: "/fr/maroc/guide/", title: "Guide Fiscal Maroc 2025 – CNSS, IR et Salaire Net Expliqués", desc: "CNSS, AMO, tranches impôt sur le revenue IR... La fiscalité au maroc expliquée simplement. Le guide simple et complet que tu aurais aimé avoir avant." },
                en: { path: "/en/morocco/tax-guide/", title: "Morocco Tax Guide 2025 – CNSS, IR & Net Salary Explained", desc: "CNSS, AMO, income tax brackets... Moroccan taxation explained simply. The complete and easy guide you wish you had before working in Morocco." }
            },
            {
                name: "Comparateur France/Maroc",
                fr: { path: "/fr/comparateur-salaire-france-maroc/", title: "France vs Maroc : MRE Où Gagnes-tu Plus ? | Comparateur 2026", desc: "MRE : compare ton salaire net et tes impôts entre la France et le Maroc. Résultat personnalisé selon ta situation familiale. Simulateur gratuit et instantané." },
                en: { path: "/en/france-morocco-comparison/", title: "France vs Morocc You Earn More? | Comparator 2026", desc: "Expat: compare your net salary and taxes between France and Morocco. Personalized results based on your family situation. Free and instant simulator." }
            },
            {
                name: "Comparateur Global",
                fr: { path: "/fr/comparateur-global/", title: "Comparateur Salaire Monde | France, Dubaï, Maroc, Suisse...", desc: "France, Maroc, Dubaï, Suisse, Luxembourg... Où ton salaire vaut-il vraiment le plus ? Compare et trouve le meilleur pays pour toi selon ta situation familiale." },
                en: { path: "/en/global-comparison/", title: "Global Salary Comparator | France, Dubai, UK, Switzerland...", desc: "France, Morocco, Dubai, Switzerland, Luxembourg... Where is your salary really worth the most? Compare and find the best country for your family situation." }
            },
            {
                name: "FAQ",
                fr: { path: "/fr/faq/", title: "FAQ Salaire Brut en Net & Impôts – Toutes les Réponses", desc: "Brut vs net ? Cadre vs non-cadre ? Différence France/Maroc ? Défiscalisation impots ? Toutes les réponses claires aux questions que tout lepose." },
                en: { path: "/en/faq/", title: "FAQ Gross to Net Salary & Taxes– All Your Questions Answered", desc: "Gross vs net? What taxes apply? Executive vs non-executive? France/Morocco differences? Tax deductions? Clear answers to all the questions everyone asks." }
            },
            {
                name: "Mentions Legales",
                fr: { path: "/fr/mentions-legales/", title: "Mentions Légales – NetSalaire.com - site simulateur", desc: "Informations légales, éditeur, hébergeur et politique de confidentialité du site NetSalaire.com. Simulateurs fiscaux gratuits France, Maroc et global." },
                en: { path: "/en/legal-notice/", title: "Legal Notice – NetSalaire.com - Simulator website ", desc: "Legal information, publisher, hosting provider and privacy policy for NetSalaire.com. Free tax simulators for France, Morocco and worldwide." }
            },
            {
                name: "Confidentialite",
                fr: { path: "/fr/politique-confidentialite/", title: "Politique de Confidentialité – NetSalaire.com - simulateur", desc: "Découvrez comment NetSalaire.com protège vos données personnelles. Aucune donnée calculs sont effectués localement dans votre navigateur." },
                en: { path: "/en/privacy-policy/", title: "Privacy Policy – NetSalaire.com - Simulator website", desc: "How NetSalaire.com protects your data. NetSalaire.com protects your personal data. No data stored, all calculations are performed locally in your browser." }
            }
        ];

        // Flatten for duplicate detection
        const seoData = seoPairs.flatMap(pair => [
            { path: pair.fr.path, lang: "fr", title: pair.fr.title, desc: pair.fr.desc },
            { path: pair.en.path, lang: "en", title: pair.en.title, desc: pair.en.desc }
        ]);

        // Track changes
        let seoChanges = JSON.parse(localStorage.getItem('seoChanges') || '{}');
        let currentScoreFilter = null;

        // Find duplicates across all pages
        function findDuplicates() {
            const titles = {};
            const descs = {};

            seoData.forEach(item => {
                const title = (seoChanges[item.path]?.title || item.title).toLowerCase().trim();
                const desc = (seoChanges[item.path]?.desc || item.desc).toLowerCase().trim();

                if (!titles[title]) titles[title] = [];
                titles[title].push(item.path);

                if (!descs[desc]) descs[desc] = [];
                descs[desc].push(item.path);
            });

            return { titles, descs };
        }

        // Calculate SEO score for a page
        function calculateSEOScore(title, desc, path, duplicates) {
            let score = 0;
            let checks = [];

            // Title length check (40 points max)
            const titleLen = title.length;
            if (titleLen >= 50 && titleLen <= 60) {
                score += 40;
                checks.push({ text: `Title: ${titleLen} caracteres (optimal: 50-60)`, status: 'good' });
            } else if (titleLen >= 40 && titleLen <= 70) {
                score += 20;
                checks.push({ text: `Title: ${titleLen} caracteres (optimal: 50-60)`, status: 'warning' });
            } else {
                checks.push({ text: `Title: ${titleLen} caracteres (optimal: 50-60)`, status: 'error' });
            }

            // Title uniqueness check (10 points)
            const titleKey = title.toLowerCase().trim();
            const titleDupes = duplicates.titles[titleKey] || [];
            if (titleDupes.length <= 1) {
                score += 10;
                checks.push({ text: 'Title unique', status: 'good' });
            } else {
                const otherPages = titleDupes.filter(p => p !== path);
                checks.push({ text: `Title duplique avec: ${otherPages.join(', ')}`, status: 'error' });
            }

            // Description length check (40 points max)
            const descLen = desc.length;
            if (descLen >= 140 && descLen <= 160) {
                score += 40;
                checks.push({ text: `Description: ${descLen} caracteres (optimal: 140-160)`, status: 'good' });
            } else if (descLen >= 120 && descLen <= 180) {
                score += 20;
                checks.push({ text: `Description: ${descLen} caracteres (optimal: 140-160)`, status: 'warning' });
            } else {
                checks.push({ text: `Description: ${descLen} caracteres (optimal: 140-160)`, status: 'error' });
            }

            // Description uniqueness check (10 points)
            const descKey = desc.toLowerCase().trim();
            const descDupes = duplicates.descs[descKey] || [];
            if (descDupes.length <= 1) {
                score += 10;
                checks.push({ text: 'Description unique', status: 'good' });
            } else {
                const otherPages = descDupes.filter(p => p !== path);
                checks.push({ text: `Description dupliquee avec: ${otherPages.join(', ')}`, status: 'error' });
            }

            return { score, checks };
        }

        // Get score color and status
        function getScoreColor(score) {
            if (score >= 80) return { color: 'emerald', status: 'good', label: 'Excellent' };
            if (score >= 50) return { color: 'amber', status: 'warning', label: 'Moyen' };
            return { color: 'red', status: 'error', label: 'A ameliorer' };
        }

        // Get char count color
        function getCountColor(len, min, max) {
            if (len >= min && len <= max) return 'text-emerald-400';
            if (len > max) return 'text-amber-400';
            return 'text-red-400';
        }

        // Update overview stats
        function updateOverviewStats() {
            let totalScore = 0;
            let pagesOk = 0;
            let pagesWarning = 0;
            let pagesError = 0;

            const duplicates = findDuplicates();

            seoData.forEach(item => {
                const savedTitle = seoChanges[item.path]?.title || item.title;
                const savedDesc = seoChanges[item.path]?.desc || item.desc;
                const { score } = calculateSEOScore(savedTitle, savedDesc, item.path, duplicates);
                totalScore += score;

                const { status } = getScoreColor(score);
                if (status === 'good') pagesOk++;
                else if (status === 'warning') pagesWarning++;
                else pagesError++;
            });

            document.getElementById('avgScore').textContent = Math.round(totalScore / seoData.length) + '/100';
            document.getElementById('pagesOk').textContent = pagesOk;
            document.getElementById('pagesWarning').textContent = pagesWarning;
            document.getElementById('pagesError').textContent = pagesError;
        }

        // Render SEO cards (FR + EN paired)
        function renderSEOCards() {
            const container = document.getElementById('seoContainer');
            container.innerHTML = '';

            const duplicates = findDuplicates();

            seoPairs.forEach((pair, pairIndex) => {
                const frPath = pair.fr.path;
                const enPath = pair.en.path;

                const frTitle = seoChanges[frPath]?.title || pair.fr.title;
                const frDesc = seoChanges[frPath]?.desc || pair.fr.desc;
                const enTitle = seoChanges[enPath]?.title || pair.en.title;
                const enDesc = seoChanges[enPath]?.desc || pair.en.desc;

                const frHasChanges = seoChanges[frPath] !== undefined;
                const enHasChanges = seoChanges[enPath] !== undefined;
                const hasChanges = frHasChanges || enHasChanges;

                const frScore = calculateSEOScore(frTitle, frDesc, frPath, duplicates);
                const enScore = calculateSEOScore(enTitle, enDesc, enPath, duplicates);
                const avgScore = Math.round((frScore.score + enScore.score) / 2);
                const { color, status, label } = getScoreColor(avgScore);

                const card = document.createElement('div');
                card.className = `seo-card fr en ${status} bg-slate-700/30 rounded-xl p-5 border-2 ${hasChanges ? 'border-amber-500/50' : `border-${color}-500/30`}`;
                card.dataset.score = status;

                card.innerHTML = `
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-4 pb-4 border-b border-slate-600">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 rounded-xl bg-${color}-500/20 flex items-center justify-center">
                                <span class="text-${color}-400 font-bold text-lg">${avgScore}</span>
                            </div>
                            <div>
                                <span class="text-white font-semibold">${pair.name}</span>
                                <div class="text-xs text-${color}-400">${label}</div>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <span class="text-xs px-2 py-1 rounded-lg bg-indigo-600/30 text-indigo-300">FR: ${frScore.score}</span>
                            <span class="text-xs px-2 py-1 rounded-lg bg-blue-600/30 text-blue-300">EN: ${enScore.score}</span>
                        </div>
                    </div>

                    <!-- FR Section -->
                    <div class="mb-6">
                        <div class="flex items-center gap-2 mb-3">
                            <iconify-icon icon="circle-flags:fr" width="20"></iconify-icon>
                            <span class="text-white font-medium">Francais</span>
                            <a href="${frPath}" target="_blank" class="text-slate-400 hover:text-indigo-400 text-xs ml-auto flex items-center gap-1">
                                ${frPath}
                                <iconify-icon icon="lucide:external-link" width="12"></iconify-icon>
                            </a>
                        </div>
                        <!-- FR SERP Preview -->
                        <div class="bg-white rounded-lg p-3 mb-3">
                            <div class="text-xs text-green-700 mb-0.5">netsalaire.com${frPath}</div>
                            <div class="text-blue-800 text-base hover:underline cursor-pointer mb-0.5 font-medium" style="font-family: arial, sans-serif;">${frTitle.length > 60 ? frTitle.substring(0, 57) + '...' : frTitle}</div>
                            <div class="text-xs text-gray-600" style="font-family: arial, sans-serif;">${frDesc.length > 160 ? frDesc.substring(0, 157) + '...' : frDesc}</div>
                        </div>
                        <div class="space-y-3">
                            <div>
                                <label class="text-slate-400 text-xs flex items-center justify-between mb-1">
                                    <span>Title</span>
                                    <span class="${getCountColor(frTitle.length, 50, 60)}" id="titleCount-fr-${pairIndex}">${frTitle.length}/60</span>
                                </label>
                                <input type="text"
                                       value="${frTitle.replace(/"/g, '&quot;')}"
                                       data-path="${frPath}"
                                       data-field="title"
                                       data-original="${pair.fr.title.replace(/"/g, '&quot;')}"
                                       data-index="fr-${pairIndex}"
                                       id="titleInput-fr-${pairIndex}"
                                       class="w-full bg-slate-900 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-indigo-500"
                                       oninput="updateCounter(this)">
                            </div>
                            <div>
                                <label class="text-slate-400 text-xs flex items-center justify-between mb-1">
                                    <span>Description</span>
                                    <span class="${getCountColor(frDesc.length, 140, 160)}" id="descCount-fr-${pairIndex}">${frDesc.length}/160</span>
                                </label>
                                <textarea data-path="${frPath}"
                                          data-field="desc"
                                          data-original="${pair.fr.desc.replace(/"/g, '&quot;')}"
                                          data-index="fr-${pairIndex}"
                                          id="descInput-fr-${pairIndex}"
                                          class="w-full bg-slate-900 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-indigo-500 resize-none h-16"
                                          oninput="updateCounter(this)">${frDesc}</textarea>
                            </div>
                        </div>
                    </div>

                    <!-- EN Section -->
                    <div class="mb-4">
                        <div class="flex items-center gap-2 mb-3">
                            <iconify-icon icon="circle-flags:gb" width="20"></iconify-icon>
                            <span class="text-white font-medium">English</span>
                            <a href="${enPath}" target="_blank" class="text-slate-400 hover:text-indigo-400 text-xs ml-auto flex items-center gap-1">
                                ${enPath}
                                <iconify-icon icon="lucide:external-link" width="12"></iconify-icon>
                            </a>
                        </div>
                        <!-- EN SERP Preview -->
                        <div class="bg-white rounded-lg p-3 mb-3">
                            <div class="text-xs text-green-700 mb-0.5">netsalaire.com${enPath}</div>
                            <div class="text-blue-800 text-base hover:underline cursor-pointer mb-0.5 font-medium" style="font-family: arial, sans-serif;">${enTitle.length > 60 ? enTitle.substring(0, 57) + '...' : enTitle}</div>
                            <div class="text-xs text-gray-600" style="font-family: arial, sans-serif;">${enDesc.length > 160 ? enDesc.substring(0, 157) + '...' : enDesc}</div>
                        </div>
                        <div class="space-y-3">
                            <div>
                                <label class="text-slate-400 text-xs flex items-center justify-between mb-1">
                                    <span>Title</span>
                                    <span class="${getCountColor(enTitle.length, 50, 60)}" id="titleCount-en-${pairIndex}">${enTitle.length}/60</span>
                                </label>
                                <input type="text"
                                       value="${enTitle.replace(/"/g, '&quot;')}"
                                       data-path="${enPath}"
                                       data-field="title"
                                       data-original="${pair.en.title.replace(/"/g, '&quot;')}"
                                       data-index="en-${pairIndex}"
                                       id="titleInput-en-${pairIndex}"
                                       class="w-full bg-slate-900 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-indigo-500"
                                       oninput="updateCounter(this)">
                            </div>
                            <div>
                                <label class="text-slate-400 text-xs flex items-center justify-between mb-1">
                                    <span>Description</span>
                                    <span class="${getCountColor(enDesc.length, 140, 160)}" id="descCount-en-${pairIndex}">${enDesc.length}/160</span>
                                </label>
                                <textarea data-path="${enPath}"
                                          data-field="desc"
                                          data-original="${pair.en.desc.replace(/"/g, '&quot;')}"
                                          data-index="en-${pairIndex}"
                                          id="descInput-en-${pairIndex}"
                                          class="w-full bg-slate-900 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-indigo-500 resize-none h-16"
                                          oninput="updateCounter(this)">${enDesc}</textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Save Button -->
                    <button onclick="saveSEOPair(${pairIndex})" id="saveBtn-${pairIndex}" class="w-full px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg flex items-center justify-center gap-2">
                        <iconify-icon icon="lucide:save" width="16"></iconify-icon>
                        Enregistrer FR + EN
                    </button>

                    ${hasChanges ? `
                        <div class="mt-4 pt-4 border-t border-slate-600 flex justify-between items-center">
                            <span class="text-amber-400 text-xs flex items-center gap-1">
                                <iconify-icon icon="lucide:edit-3" width="12"></iconify-icon>
                                Modifie (non sauvegarde)
                            </span>
                            <button onclick="resetSEOPair(${pairIndex})" class="text-xs text-slate-400 hover:text-red-400 flex items-center gap-1">
                                <iconify-icon icon="lucide:undo" width="12"></iconify-icon>
                                Reset
                            </button>
                        </div>
                    ` : ''}
                `;
                container.appendChild(card);
            });

            updateChangesCount();
            updateOverviewStats();
        }

        // Update counter only (no save)
        function updateCounter(input) {
            const field = input.dataset.field;
            const index = input.dataset.index;
            const value = input.value;

            // Update counter
            const counterId = field === 'title' ? `titleCount-${index}` : `descCount-${index}`;
            const barId = field === 'title' ? `titleBar-${index}` : `descBar-${index}`;
            const min = field === 'title' ? 50 : 140;
            const max = field === 'title' ? 60 : 160;

            const counter = document.getElementById(counterId);
            counter.textContent = `${value.length}/${max}`;
            counter.className = getCountColor(value.length, min, max);

            // Update progress bar
            const bar = document.getElementById(barId);
            if (bar) {
                const isOptimal = value.length >= min && value.length <= max;
                const isTooLong = value.length > max;
                bar.className = `h-full ${isOptimal ? 'bg-emerald-500' : isTooLong ? 'bg-amber-500' : 'bg-red-500'}`;
                bar.style.width = `${Math.min(value.length / max * 100, 100)}%`;
            }
        }

        // Save FR + EN pair (called by button)
        function saveSEOPair(pairIndex) {
            const pair = seoPairs[pairIndex];

            // Save FR
            const frTitleInput = document.getElementById(`titleInput-fr-${pairIndex}`);
            const frDescInput = document.getElementById(`descInput-fr-${pairIndex}`);
            saveSinglePage(pair.fr.path, frTitleInput, frDescInput);

            // Save EN
            const enTitleInput = document.getElementById(`titleInput-en-${pairIndex}`);
            const enDescInput = document.getElementById(`descInput-en-${pairIndex}`);
            saveSinglePage(pair.en.path, enTitleInput, enDescInput);

            localStorage.setItem('seoChanges', JSON.stringify(seoChanges));

            // Show confirmation
            const btn = document.getElementById(`saveBtn-${pairIndex}`);
            btn.innerHTML = '<iconify-icon icon="lucide:check" width="16"></iconify-icon> Enregistre !';
            btn.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
            btn.classList.add('bg-emerald-600');

            setTimeout(() => {
                renderSEOCards();
            }, 500);
        }

        // Helper to save single page
        function saveSinglePage(path, titleInput, descInput) {
            const titleValue = titleInput.value;
            const descValue = descInput.value;
            const titleOriginal = titleInput.dataset.original;
            const descOriginal = descInput.dataset.original;

            if (titleValue !== titleOriginal) {
                if (!seoChanges[path]) seoChanges[path] = {};
                seoChanges[path].title = titleValue;
            } else if (seoChanges[path]) {
                delete seoChanges[path].title;
            }

            if (descValue !== descOriginal) {
                if (!seoChanges[path]) seoChanges[path] = {};
                seoChanges[path].desc = descValue;
            } else if (seoChanges[path]) {
                delete seoChanges[path].desc;
            }

            if (seoChanges[path] && Object.keys(seoChanges[path]).length === 0) {
                delete seoChanges[path];
            }
        }

        // Reset pair
        function resetSEOPair(pairIndex) {
            const pair = seoPairs[pairIndex];
            delete seoChanges[pair.fr.path];
            delete seoChanges[pair.en.path];
            localStorage.setItem('seoChanges', JSON.stringify(seoChanges));
            renderSEOCards();
        }

        // Update changes count
        function updateChangesCount() {
            const count = Object.keys(seoChanges).length;
            const countEl = document.getElementById('changesCount');
            if (count > 0) {
                countEl.classList.remove('hidden');
                countEl.innerHTML = `<span class="text-amber-400 font-medium">${count}</span> modification${count > 1 ? 's' : ''}`;
            } else {
                countEl.classList.add('hidden');
            }
        }

        // Filter SEO cards by language
        // Filter by score
        function filterByScore(scoreStatus) {
            currentScoreFilter = scoreStatus === 'all' ? null : scoreStatus;

            document.querySelectorAll('.seo-score-filter').forEach(btn => {
                btn.classList.remove('bg-indigo-600', 'text-white');
                btn.classList.add('bg-slate-600', 'text-slate-300');
            });
            document.querySelector(`[data-score="${scoreStatus}"]`).classList.remove('bg-slate-600', 'text-slate-300');
            document.querySelector(`[data-score="${scoreStatus}"]`).classList.add('bg-indigo-600', 'text-white');

            document.querySelectorAll('.seo-card').forEach(card => {
                if (scoreStatus === 'all' || card.dataset.score === scoreStatus) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Export changes
        function exportSEOChanges() {
            if (Object.keys(seoChanges).length === 0) {
                alert('Aucune modification a exporter.');
                return;
            }
            document.getElementById('exportData').value = JSON.stringify(seoChanges, null, 2);
            document.getElementById('exportModal').classList.remove('hidden');
            document.getElementById('exportModal').classList.add('flex');
        }

        function closeExportModal() {
            document.getElementById('exportModal').classList.add('hidden');
            document.getElementById('exportModal').classList.remove('flex');
        }

        function copyExport() {
            const textarea = document.getElementById('exportData');
            textarea.select();
            document.execCommand('copy');
            alert('Copie ! Colle-le dans le chat.');
        }

        // Initialize
        renderSEOCards();
    </script>
</body>
</html>
