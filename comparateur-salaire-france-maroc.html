<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z328SB8DZ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-Z328SB8DZ8');
    </script>

    <title>Comparateur Salaire France vs Maroc - Simulateur Fiscal | NetSalaire</title>
    <meta name="description" content="Comparez votre salaire net entre la France et le Maroc. Simulateur fiscal complet avec IR, cotisations sociales, quotient familial. Calculez la difference de pression fiscale.">
    <meta name="keywords" content="comparateur salaire france maroc, simulateur fiscal, impot france maroc, salaire net, IR, cotisations sociales, expatriation">
    <link rel="canonical" href="https://netsalaire.com/comparateur-salaire-france-maroc.html">

    <!-- Open Graph -->
    <meta property="og:title" content="Comparateur Salaire France vs Maroc - NetSalaire">
    <meta property="og:description" content="Comparez votre salaire net entre la France et le Maroc. Simulateur fiscal complet.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://netsalaire.com/comparateur-salaire-france-maroc.html">
    <meta property="og:image" content="https://netsalaire.com/assets/images/og-comparateur.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Comparateur Salaire France vs Maroc">
    <meta name="twitter:description" content="Comparez votre salaire net entre la France et le Maroc.">
    <meta name="twitter:image" content="https://netsalaire.com/assets/images/og-comparateur.png">

    <!-- Additional SEO -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="NetSalaire">
    <meta property="og:site_name" content="NetSalaire">
    <meta property="og:locale" content="fr_FR">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">

    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        .toggle-checkbox:checked {
            right: 0;
            border-color: #0f172a;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #0f172a;
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .transition-all-300 { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Comparateur Salaire France vs Maroc",
        "description": "Simulateur fiscal pour comparer le salaire net entre la France et le Maroc",
        "url": "https://netsalaire.com/comparateur-salaire-france-maroc.html",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "EUR"
        },
        "publisher": {
            "@type": "Organization",
            "name": "NetSalaire",
            "url": "https://netsalaire.com"
        }
    }
    </script>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- Navigation -->
    <nav class="nav-container">
        <div class="nav-inner">
            <a href="/" class="nav-logo">
                <img src="/assets/images/logo.svg" alt="NetSalaire" height="32">
            </a>

            <button class="nav-toggle" onclick="document.querySelector('.nav-menu').classList.toggle('active')">
                <span class="iconify" data-icon="lucide:menu" width="24"></span>
            </button>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="/#france" class="nav-link">
                        <span class="iconify" data-icon="circle-flags:fr" width="18"></span>
                        <span data-i18n="nav.france">France</span>
                        <span class="iconify" data-icon="lucide:chevron-down" width="14"></span>
                    </a>
                    <ul class="nav-dropdown">
                        <li><a href="/france/simulateur-impot-revenu.html"><span class="iconify" data-icon="lucide:landmark" width="16"></span> <span data-i18n="nav.tax_simulator">Simulateur Imp√¥t</span></a></li>
                        <li><a href="/france/simulateur-salaire-brut-net.html"><span class="iconify" data-icon="lucide:calculator" width="16"></span> <span data-i18n="nav.brut_to_net">Brut vers Net</span></a></li>
                        <li><a href="/france/guide/"><span class="iconify" data-icon="lucide:book-open" width="16"></span> <span data-i18n="nav.fiscal_guide">Guide Fiscal</span></a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="/#maroc" class="nav-link">
                        <span class="iconify" data-icon="circle-flags:ma" width="18"></span>
                        <span data-i18n="nav.maroc">Maroc</span>
                        <span class="iconify" data-icon="lucide:chevron-down" width="14"></span>
                    </a>
                    <ul class="nav-dropdown nav-dropdown-ma">
                        <li><a href="/maroc/simulateur-ir.html"><span class="iconify" data-icon="lucide:landmark" width="16"></span> <span data-i18n="nav.tax_simulator">Simulateur Imp√¥t</span></a></li>
                        <li><a href="/maroc/simulateur-salaire-brut-net.html"><span class="iconify" data-icon="lucide:calculator" width="16"></span> <span data-i18n="nav.brut_to_net">Brut vers Net</span></a></li>
                        <li><a href="/maroc/guide/"><span class="iconify" data-icon="lucide:book-open" width="16"></span> <span data-i18n="nav.fiscal_guide">Guide Fiscal</span></a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="/comparateur-salaire-france-maroc.html" class="nav-link" style="background: var(--bg); color: var(--primary);">
                        <span class="iconify" data-icon="lucide:scale" width="18"></span>
                        <span data-i18n="nav.france_vs_maroc">France vs Maroc</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/comparateur-global.html" class="nav-link">
                        <span class="iconify" data-icon="lucide:globe" width="18"></span>
                        <span data-i18n="nav.global_comparator">Comparateur Global</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/faq.html" class="nav-link">
                        <span class="iconify" data-icon="lucide:help-circle" width="18"></span>
                        <span data-i18n="nav.faq">FAQ</span>
                    </a>
                </li>
            </ul>

            <!-- Language Switcher -->
            <div class="lang-switcher-container">
                <button onclick="document.querySelector('.lang-dropdown').classList.toggle('show')" class="lang-switcher" title="Switch language">
                    <span class="lang-flag">üá´üá∑</span>
                    <span class="iconify" data-icon="lucide:chevron-down" width="14"></span>
                </button>
                <div class="lang-dropdown">
                    <button onclick="i18n.setLang('fr'); document.querySelector('.lang-dropdown').classList.remove('show');" class="lang-option" data-lang="fr">
                        <span>üá´üá∑</span> Fran√ßais
                    </button>
                    <button onclick="i18n.setLang('en'); document.querySelector('.lang-dropdown').classList.remove('show');" class="lang-option" data-lang="en">
                        <span>üá¨üáß</span> English
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="w-full max-w-6xl mx-auto space-y-6 py-8 px-4 sm:px-6 lg:px-8">

        <!-- Page Header -->
        <header class="text-center mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-900 mb-2" data-i18n="comp.fr_ma_title">Comparateur Fiscal France vs Maroc</h1>
            <p class="text-slate-500 max-w-2xl mx-auto" data-i18n="comp.subtitle">Comparez votre salaire net et votre pression fiscale entre les deux pays. Simulateur mis a jour avec les baremes 2025.</p>
        </header>

        <!-- Input Section -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-500 via-slate-200 to-indigo-500"></div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Salary Inputs -->
                <div class="space-y-5">
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-xs font-semibold uppercase tracking-tight text-slate-500" data-i18n="comp.gross_salary">Salaire Brut</label>
                        <div class="flex bg-slate-100 rounded-lg p-0.5">
                            <button id="period-monthly" class="px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300" data-i18n="comp_global.monthly">Mensuel</button>
                            <button id="period-annual" class="px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300" data-i18n="comp_global.annual">Annuel</button>
                        </div>
                    </div>

                    <div class="relative grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Divider "OU" -->
                        <div class="hidden sm:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-8 h-8 items-center justify-center bg-white rounded-full border border-slate-200 shadow-sm">
                            <span class="text-[10px] font-bold text-slate-400 uppercase">ou</span>
                        </div>
                        <div class="sm:hidden w-full text-center -my-2 order-2">
                            <span class="text-[10px] font-bold text-slate-300 uppercase bg-white px-2 relative z-10">ou</span>
                        </div>

                        <!-- France Input -->
                        <div class="relative group order-1 sm:order-2">
                            <label class="block text-xs font-medium text-slate-500 mb-1.5">France (EUR)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium text-sm">‚Ç¨</span>
                                <input type="text" inputmode="numeric" id="input-eur" class="w-full pl-10 pr-4 py-2.5 text-sm font-semibold text-slate-900 bg-white border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all-300" placeholder="0">
                            </div>
                            <div class="flex items-center justify-end gap-2 mt-2">
                                <span class="text-[10px] text-slate-400 font-medium" data-i18n="comp.cadre_status">Statut Cadre</span>
                                <button id="toggle-cadre" class="relative inline-flex h-4 w-7 items-center rounded-full bg-slate-200 transition-colors focus:outline-none">
                                    <span class="translate-x-0.5 inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm"></span>
                                </button>
                            </div>
                        </div>

                        <!-- Morocco Input -->
                        <div class="relative group order-3 sm:order-1">
                            <label class="block text-xs font-medium text-slate-500 mb-1.5">Maroc (MAD)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium text-sm">Dh</span>
                                <input type="text" inputmode="numeric" id="input-mad" class="w-full pl-10 pr-4 py-2.5 text-sm font-semibold text-slate-900 bg-white border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all-300" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-2 mt-2">
                        <span class="text-[10px] text-slate-400 font-medium" data-i18n="comp.exchange_rate">Taux DH/EUR du jour :</span>
                        <input type="number" id="exchange-rate" value="10.8" class="w-16 py-0.5 px-1 text-[10px] font-mono text-slate-500 bg-slate-50 border border-slate-200 rounded text-center focus:outline-none focus:border-slate-400">
                        <span id="rate-status" class="text-[10px] text-emerald-500"></span>
                    </div>
                </div>

                <!-- Family Situation -->
                <div class="space-y-5 lg:border-l lg:border-slate-100 lg:pl-8">
                    <label class="block text-xs font-semibold uppercase tracking-tight text-slate-500 mb-2" data-i18n="comp_global.family_status">Situation Familiale</label>

                    <div class="space-y-4">
                        <div>
                            <span class="text-xs font-medium text-slate-600 mb-2 block" data-i18n="comp_global.marital_status">Statut Marital</span>
                            <div class="flex w-full bg-slate-50 border border-slate-200 rounded-lg p-1">
                                <button id="status-single" class="flex-1 py-1.5 text-[11px] font-medium rounded-md bg-white shadow-sm text-slate-900 border border-slate-100 transition-all-300" data-i18n="comp_global.single">Celibataire</button>
                                <button id="status-married" class="flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300" data-i18n="comp_global.married">Marie(e)</button>
                                <button id="status-divorced" class="flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300" data-i18n="comp.divorced">Divorce(e)</button>
                            </div>
                        </div>

                        <div>
                            <span class="text-xs font-medium text-slate-600 mb-2 block" data-i18n="comp_global.children">Enfants a charge</span>
                            <div class="flex items-center w-full bg-white border border-slate-200 rounded-lg h-[38px]">
                                <button id="child-minus" class="w-10 h-full flex items-center justify-center text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-l-lg transition-colors border-r border-slate-100">
                                    <span class="iconify" data-icon="lucide:minus" width="14"></span>
                                </button>
                                <div id="children-display" class="flex-1 text-center text-sm font-semibold text-slate-900 select-none">0</div>
                                <button id="child-plus" class="w-10 h-full flex items-center justify-center text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-r-lg transition-colors border-l border-slate-100">
                                    <span class="iconify" data-icon="lucide:plus" width="14"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Comparison Results -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- MAROC COLUMN -->
            <article class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col order-2 md:order-1">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üá≤üá¶</span>
                        <h2 class="text-base font-semibold text-slate-900">Maroc</h2>
                    </div>
                    <span class="text-[10px] font-medium text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100">IR Progressif</span>
                </div>

                <div class="p-6 flex-1 flex flex-col gap-6">
                    <!-- KPIs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Net "En Poche"</p>
                            <p class="text-2xl font-semibold text-slate-900 tracking-tight" id="ma-net">0 <span class="text-sm font-normal text-slate-400">MAD</span></p>
                            <p class="text-[10px] text-slate-400 mt-1" id="ma-net-eur">‚âà 0 ‚Ç¨</p>
                        </div>
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Taux d'Imposition</p>
                            <p class="text-2xl font-semibold text-emerald-600 tracking-tight" id="ma-rate">0%</p>
                            <p class="text-[10px] text-slate-400 mt-1">Pression Totale</p>
                        </div>
                    </div>

                    <!-- Stacked Bar Chart -->
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-medium text-slate-500 uppercase tracking-wide">
                            <span>Distribution</span>
                            <span>100% du Brut</span>
                        </div>
                        <div class="h-6 w-full bg-slate-100 rounded-md overflow-hidden flex shadow-inner relative group">
                            <div id="bar-ma-net" class="h-full bg-emerald-500 transition-all-300 relative group/segment" style="width: 60%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Salaire Net</div>
                            </div>
                            <div id="bar-ma-tax" class="h-full bg-emerald-300 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Impot (IR)</div>
                            </div>
                            <div id="bar-ma-soc" class="h-full bg-emerald-100 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Cotisations</div>
                            </div>
                        </div>
                        <div class="flex justify-between text-[10px] text-slate-400">
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-500"></div>Net</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-300"></div>Impot</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-100"></div>Social</div>
                        </div>
                    </div>

                    <!-- Breakdown Table -->
                    <div class="mt-2 border rounded-lg border-slate-200 overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-[10px] uppercase text-slate-500 font-semibold border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3">Poste</th>
                                    <th class="px-4 py-3 text-right" colspan="2">Montant</th>
                                    <th class="px-4 py-3 text-right text-slate-400">%</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="ma-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </article>

            <!-- FRANCE COLUMN -->
            <article class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col order-1 md:order-2">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üá´üá∑</span>
                        <h2 class="text-base font-semibold text-slate-900">France</h2>
                    </div>
                    <span class="text-[10px] font-medium text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-full border border-indigo-100">Quotient Familial</span>
                </div>

                <div class="p-6 flex-1 flex flex-col gap-6">
                    <!-- KPIs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Net "En Poche"</p>
                            <p class="text-2xl font-semibold text-slate-900 tracking-tight" id="fr-net">0 <span class="text-sm font-normal text-slate-400">‚Ç¨</span></p>
                            <p class="text-[10px] text-slate-400 mt-1" id="fr-net-mad">‚âà 0 MAD</p>
                        </div>
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Taux d'Imposition</p>
                            <p class="text-2xl font-semibold text-indigo-600 tracking-tight" id="fr-rate">0%</p>
                            <p class="text-[10px] text-slate-400 mt-1">Pression Totale</p>
                        </div>
                    </div>

                    <!-- Stacked Bar Chart -->
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-medium text-slate-500 uppercase tracking-wide">
                            <span>Distribution</span>
                            <span>100% du Brut</span>
                        </div>
                        <div class="h-6 w-full bg-slate-100 rounded-md overflow-hidden flex shadow-inner relative">
                            <div id="bar-fr-net" class="h-full bg-indigo-500 transition-all-300 relative group/segment" style="width: 60%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Salaire Net</div>
                            </div>
                            <div id="bar-fr-tax" class="h-full bg-indigo-300 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Impot (IR)</div>
                            </div>
                            <div id="bar-fr-soc" class="h-full bg-indigo-100 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Cotisations</div>
                            </div>
                        </div>
                        <div class="flex justify-between text-[10px] text-slate-400">
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-500"></div>Net</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-300"></div>Impot</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-100"></div>Social</div>
                        </div>
                    </div>

                    <!-- Breakdown Table -->
                    <div class="mt-2 border rounded-lg border-slate-200 overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-[10px] uppercase text-slate-500 font-semibold border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3">Poste</th>
                                    <th class="px-4 py-3 text-right" colspan="2">Montant</th>
                                    <th class="px-4 py-3 text-right text-slate-400">%</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="fr-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </article>

        </div>

        <!-- Verdict Banner -->
        <div class="bg-slate-900 text-white rounded-xl shadow-lg p-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <span class="iconify w-8 h-8 text-yellow-400" data-icon="lucide:trophy"></span>
                <div>
                    <h3 class="font-semibold text-lg tracking-tight" id="verdict-title">Analyse Prete</h3>
                    <p class="text-sm text-slate-400" id="verdict-text">Saisissez votre salaire pour comparer.</p>
                </div>
            </div>
            <div class="text-right flex flex-col items-end">
                <p class="text-xs uppercase tracking-widest text-slate-500 font-medium mb-1">Difference Annuelle</p>
                <div class="flex flex-col items-end">
                    <p class="text-2xl font-bold font-mono tracking-tight text-white leading-none mb-1" id="verdict-diff">--</p>
                    <p class="text-sm font-medium text-slate-400 font-mono tracking-tight" id="verdict-diff-eur"></p>
                </div>
            </div>
        </div>

        <!-- Reassurance -->
        <section class="bg-white rounded-xl border border-slate-200 p-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div>
                    <div class="text-2xl mb-2">üîí</div>
                    <h4 class="text-sm font-semibold text-slate-900">100% Securise</h4>
                    <p class="text-xs text-slate-500">Aucune donnee stockee</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">üìä</div>
                    <h4 class="text-sm font-semibold text-slate-900">Baremes 2025</h4>
                    <p class="text-xs text-slate-500">Loi de finances actuelle</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">‚ö°</div>
                    <h4 class="text-sm font-semibold text-slate-900">Calcul Instantane</h4>
                    <p class="text-xs text-slate-500">Resultats en temps reel</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">üåç</div>
                    <h4 class="text-sm font-semibold text-slate-900">Taux Live</h4>
                    <p class="text-xs text-slate-500">Taux de change du jour</p>
                </div>
            </div>
        </section>

        <p class="text-center text-[10px] text-slate-400 mt-8 pb-4 max-w-2xl mx-auto leading-relaxed">
            Avertissement Legal : Cet outil est fourni a titre indicatif uniquement. Les lois fiscales en France et au Maroc sont complexes et sujettes a modifications (Loi de Finances 2025). Les cotisations sociales sont des estimations moyennes. Les calculs excluent les niches fiscales complexes.
        </p>

        <!-- SEO Content Section -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">Comprendre les differences fiscales France-Maroc</h2>

            <div class="prose prose-slate max-w-none">
                <h3 class="text-xl font-semibold text-slate-800 mt-6 mb-3">Deux systemes fiscaux differents</h3>
                <p class="text-slate-600 mb-4">
                    La <strong>France</strong> et le <strong>Maroc</strong> ont des systemes fiscaux fondamentalement differents. En France, le systeme repose sur le <strong>quotient familial</strong> qui divise le revenu imposable par le nombre de parts du foyer, reduisant ainsi l'impot pour les familles. Au Maroc, c'est un systeme d'<strong>abattement familial</strong> forfaitaire qui s'applique : 500 MAD par personne a charge, avec un plafond de 3 000 MAD par an.
                </p>
                <p class="text-slate-600 mb-4">
                    Les <strong>cotisations sociales</strong> representent egalement une difference majeure. En France, elles atteignent environ 22% a 25% du salaire brut (selon le statut cadre/non-cadre), finan√ßant un systeme de protection sociale complet. Au Maroc, les cotisations CNSS et AMO sont plus faibles (environ 6,7%), mais la couverture sociale est egalement moins etendue.
                </p>

                <h3 class="text-xl font-semibold text-slate-800 mt-8 mb-3">Pourquoi utiliser ce comparateur ?</h3>
                <p class="text-slate-600 mb-4">
                    Ce comparateur est indispensable pour les <strong>Marocains Residant en France (MRE)</strong> qui envisagent un retour au pays, les <strong>expatries francais</strong> considerant une mobilite au Maroc, ou les <strong>binationaux</strong> hesitant entre les deux pays. Il permet de comparer objectivement la <strong>pression fiscale totale</strong> (cotisations + impots) et le <strong>salaire net reel</strong> dans chaque pays.
                </p>
                <p class="text-slate-600 mb-4">
                    Le comparateur prend en compte le <strong>taux de change EUR/MAD en temps reel</strong>, permettant une comparaison precise des montants. Il integre egalement les specificites de chaque systeme : quotient familial francais, abattement pour frais professionnels marocain (20%), plafond CNSS, etc.
                </p>

                <h3 class="text-xl font-semibold text-slate-800 mt-8 mb-3">Les facteurs a considerer</h3>
                <ul class="list-disc pl-6 text-slate-600 space-y-2 mb-6">
                    <li><strong>Cout de la vie</strong> : Le Maroc est generalement 40-60% moins cher que la France</li>
                    <li><strong>Couverture sociale</strong> : La France offre une protection plus complete (chomage, retraite, sante)</li>
                    <li><strong>Impot progressif</strong> : Les hauts revenus sont plus taxes en France (jusqu'a 45%) qu'au Maroc (37%)</li>
                    <li><strong>Situation familiale</strong> : Le quotient familial francais avantage les familles nombreuses</li>
                    <li><strong>Conventions fiscales</strong> : La France et le Maroc ont signe une convention pour eviter la double imposition</li>
                </ul>
            </div>
        </section>

        <!-- Examples Section -->
        <section class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-2xl p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">3 exemples concrets de comparaison</h2>

            <div class="grid md:grid-cols-3 gap-6">
                <!-- Example 1 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üë®‚Äçüéì</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Jeune diplome : 35 000 ‚Ç¨/an</h3>
                    <p class="text-xs text-slate-500 mb-3">Celibataire, sans enfant</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Cotisations: ~7 700 ‚Ç¨ | IR: ~1 800 ‚Ç¨</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~25 500 ‚Ç¨/an</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Maroc (378 000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~25 400 MAD | IR: ~45 000 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~307 600 MAD (~28 500 ‚Ç¨)</div>
                    </div>
                    <p class="text-xs text-emerald-600 mt-4 font-semibold">‚Üí Maroc +3 000 ‚Ç¨/an</p>
                </div>

                <!-- Example 2 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Famille : 60 000 ‚Ç¨/an</h3>
                    <p class="text-xs text-slate-500 mb-3">Marie, 2 enfants</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Cotisations: ~13 200 ‚Ç¨ | IR: ~2 100 ‚Ç¨ (3 parts)</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~44 700 ‚Ç¨/an</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Maroc (648 000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~43 500 MAD | IR: ~98 000 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~506 500 MAD (~46 900 ‚Ç¨)</div>
                    </div>
                    <p class="text-xs text-emerald-600 mt-4 font-semibold">‚Üí Maroc +2 200 ‚Ç¨/an</p>
                </div>

                <!-- Example 3 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üëî</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Cadre superieur : 120 000 ‚Ç¨/an</h3>
                    <p class="text-xs text-slate-500 mb-3">Marie, 3 enfants, statut cadre</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Cotisations: ~30 000 ‚Ç¨ | IR: ~12 500 ‚Ç¨ (4 parts)</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~77 500 ‚Ç¨/an</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Maroc (1 296 000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~87 000 MAD | IR: ~295 000 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~914 000 MAD (~84 600 ‚Ç¨)</div>
                    </div>
                    <p class="text-xs text-emerald-600 mt-4 font-semibold">‚Üí Maroc +7 100 ‚Ç¨/an</p>
                </div>
            </div>

            <p class="text-xs text-slate-500 text-center mt-6">
                * Estimations basees sur les baremes 2025. Taux de change: 1 EUR = 10.8 MAD. Les montants reels peuvent varier.
            </p>
        </section>

        <!-- FAQ Section -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">Questions frequentes France vs Maroc</h2>

            <div class="space-y-6">
                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Quel pays est le plus avantageux fiscalement ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">En general, le Maroc offre une pression fiscale plus faible, surtout pour les celibataires et les hauts revenus. Cependant, la France peut etre competitive pour les familles nombreuses grace au quotient familial. Au-dela de 3 enfants, la France devient souvent plus avantageuse.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Comment fonctionne le quotient familial francais ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Le quotient familial divise le revenu imposable par le nombre de parts : 1 part pour un celibataire, 2 parts pour un couple marie, +0.5 part pour les 2 premiers enfants, +1 part par enfant supplementaire. Cela reduit la progressivite de l'impot et avantage significativement les familles.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Qu'est-ce que l'abattement familial au Maroc ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Au Maroc, l'abattement familial est une reduction forfaitaire de 500 MAD par an et par personne a charge (conjoint + enfants), plafonnee a 3 000 MAD par an (soit 6 personnes maximum). C'est moins avantageux que le quotient familial francais pour les grandes familles.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Les MRE doivent-ils payer des impots en France ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Les Marocains Residant en France (MRE) sont soumis a l'impot francais sur leurs revenus de source francaise. Grace a la convention fiscale franco-marocaine, ils ne sont pas doublement imposes sur les memes revenus. Leurs revenus marocains peuvent etre declares en France mais avec un credit d'impot.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Quelle est la difference entre CNSS et Securite sociale ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">La CNSS (Caisse Nationale de Securite Sociale) marocaine preleve environ 4,48% du salaire (plafonne a 6 000 MAD/mois) contre ~22-25% pour les cotisations sociales francaises. La difference majeure : la France finance chomage, retraite complete et allocations familiales, tandis que la CNSS offre une couverture plus limitee.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Les frais professionnels sont-ils deduits pareil ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">En France, un abattement forfaitaire de 10% est applique automatiquement sur le revenu imposable. Au Maroc, c'est 20% du salaire brut apres cotisations sociales, mais plafonne a 30 000 MAD par an. Le systeme marocain est donc plus genereux pour les salaires moyens.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Comment est calcule le taux de change ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Notre comparateur utilise le taux de change EUR/MAD fourni par la Banque Centrale Europeenne via l'API Frankfurter. Le taux est mis a jour en temps reel. Vous pouvez egalement saisir un taux personnalise si vous avez un taux specifique en tete.</p>
                </details>

                <details class="group pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Faut-il considerer le cout de la vie ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Absolument ! Ce comparateur ne montre que la fiscalite. Le cout de la vie au Maroc est environ 40-60% moins eleve qu'en France (loyer, alimentation, services). Un salaire net inferieur au Maroc peut donc offrir un meilleur pouvoir d'achat qu'en France.</p>
                </details>
            </div>
        </section>

        <!-- Sources Section -->
        <section class="bg-slate-50 rounded-2xl p-6 mt-8">
            <h3 class="font-semibold text-slate-800 mb-4">Sources officielles</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm text-slate-600">
                <div>
                    <p>üá´üá∑ <a href="https://www.impots.gouv.fr" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">impots.gouv.fr</a> - Bareme IR 2025</p>
                    <p>üá´üá∑ <a href="https://www.urssaf.fr" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">urssaf.fr</a> - Taux de cotisations sociales</p>
                </div>
                <div>
                    <p>üá≤üá¶ <a href="https://www.tax.gov.ma" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">tax.gov.ma</a> - Bareme IR Maroc 2025</p>
                    <p>üá≤üá¶ <a href="https://www.cnss.ma" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">cnss.ma</a> - Taux CNSS et AMO</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-grid">
                <div>
                    <h4>NetSalaire</h4>
                    <p data-i18n="footer.description">Simulateurs fiscaux gratuits pour la France et le Maroc.</p>
                </div>
                <div>
                    <h4 data-i18n="nav.france">France</h4>
                    <ul>
                        <li><a href="/france/simulateur-salaire-brut-net.html" data-i18n="nav.brut_to_net">Brut vers Net</a></li>
                        <li><a href="/france/simulateur-impot-revenu.html" data-i18n="nav.tax_simulator">Simulateur IR</a></li>
                        <li><a href="/france/guide/" data-i18n="nav.fiscal_guide">Guide Fiscal</a></li>
                    </ul>
                </div>
                <div>
                    <h4 data-i18n="nav.maroc">Maroc</h4>
                    <ul>
                        <li><a href="/maroc/simulateur-salaire-brut-net.html" data-i18n="nav.brut_to_net">Brut vers Net</a></li>
                        <li><a href="/maroc/simulateur-ir.html" data-i18n="nav.tax_simulator">Simulateur IR</a></li>
                    </ul>
                </div>
                <div>
                    <h4 data-i18n="footer.info">Informations</h4>
                    <ul>
                        <li><a href="/faq.html" data-i18n="nav.faq">FAQ</a></li>
                        <li><a href="/mentions-legales.html" data-i18n="footer.legal">Mentions Legales</a></li>
                        <li><a href="/politique-confidentialite.html" data-i18n="footer.privacy">Confidentialite</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 NetSalaire.com - <span data-i18n="footer.rights">Tous droits reserves</span></p>
            </div>
        </div>
    </footer>

    <!-- i18n Script -->
    <script src="/assets/js/i18n.js"></script>

    <script>
        // --- CONSTANTS & CONFIG ---
        const TAX_CONFIG = {
            fr: {
                brackets: [
                    { limit: 11294, rate: 0 },
                    { limit: 28797, rate: 0.11 },
                    { limit: 82341, rate: 0.30 },
                    { limit: 177106, rate: 0.41 },
                    { limit: Infinity, rate: 0.45 }
                ],
                cotis_rate_noncadre: 0.22,
                cotis_rate_cadre: 0.25,
                abattement: 0.10
            },
            ma: {
                brackets: [
                    { limit: 40000, rate: 0, deduct: 0 },
                    { limit: 60000, rate: 0.10, deduct: 4000 },
                    { limit: 80000, rate: 0.20, deduct: 10000 },
                    { limit: 100000, rate: 0.30, deduct: 18000 },
                    { limit: 180000, rate: 0.34, deduct: 22000 },
                    { limit: Infinity, rate: 0.37, deduct: 27400 }
                ],
                cnss_rate: 0.0448,
                cnss_ceiling_monthly: 6000,
                amo_rate: 0.0226,
                family_deduction: 500,
                family_deduction_cap: 3000
            }
        };

        // --- STATE ---
        const state = {
            salaryInput: 0,
            salaryCurrency: 'EUR',
            exchangeRate: 10.8,
            period: 'monthly',
            status: 'single',
            children: 0,
            isCadre: false
        };

        // --- DOM ELEMENTS ---
        const els = {
            inputMad: document.getElementById('input-mad'),
            inputEur: document.getElementById('input-eur'),
            inputRate: document.getElementById('exchange-rate'),
            btnMonthly: document.getElementById('period-monthly'),
            btnAnnual: document.getElementById('period-annual'),

            btnSingle: document.getElementById('status-single'),
            btnMarried: document.getElementById('status-married'),
            btnDivorced: document.getElementById('status-divorced'),

            btnChildMinus: document.getElementById('child-minus'),
            btnChildPlus: document.getElementById('child-plus'),
            displayChildren: document.getElementById('children-display'),

            toggleCadre: document.getElementById('toggle-cadre'),

            maNet: document.getElementById('ma-net'),
            maNetEur: document.getElementById('ma-net-eur'),
            maRate: document.getElementById('ma-rate'),
            maTable: document.getElementById('ma-table-body'),
            barMaNet: document.getElementById('bar-ma-net'),
            barMaTax: document.getElementById('bar-ma-tax'),
            barMaSoc: document.getElementById('bar-ma-soc'),

            frNet: document.getElementById('fr-net'),
            frNetMad: document.getElementById('fr-net-mad'),
            frRate: document.getElementById('fr-rate'),
            frTable: document.getElementById('fr-table-body'),
            barFrNet: document.getElementById('bar-fr-net'),
            barFrTax: document.getElementById('bar-fr-tax'),
            barFrSoc: document.getElementById('bar-fr-soc'),

            verdictTitle: document.getElementById('verdict-title'),
            verdictText: document.getElementById('verdict-text'),
            verdictDiff: document.getElementById('verdict-diff'),
            verdictDiffEur: document.getElementById('verdict-diff-eur'),
        };

        // --- FORMATTERS ---
        const formatNumber = (num) => {
            return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        const formatMoney = (amount, currency) => {
            const formatted = formatNumber(amount);
            if (currency === 'MAD') return formatted + ' MAD';
            if (currency === 'EUR') return formatted + ' ‚Ç¨';
            return formatted + ' ' + currency;
        };
        const formatPct = (val) => (val * 100).toFixed(1) + '%';

        const formatInputValue = (value) => {
            const num = value.toString().replace(/\s/g, '').replace(/[^\d]/g, '');
            if (!num) return '';
            return num.replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        const parseInputValue = (value) => {
            return parseFloat(value.replace(/\s/g, '')) || 0;
        };

        function toggleTranches(country) {
            const rows = document.querySelectorAll(`.${country}-tranches-row`);
            const arrow = document.getElementById(`${country}-tranches-arrow`);
            const isHidden = rows[0]?.classList.contains('hidden');

            rows.forEach(row => {
                if (isHidden) {
                    row.classList.remove('hidden');
                } else {
                    row.classList.add('hidden');
                }
            });

            if (arrow) {
                arrow.textContent = isHidden ? '‚ñº' : '‚ñ∂';
            }
        }

        // --- LOGIC ---

        function calculateFrance() {
            let annualGrossEur = state.salaryInput;
            if (state.salaryCurrency === 'MAD') annualGrossEur /= state.exchangeRate;
            if (state.period === 'monthly') annualGrossEur *= 12;

            if (annualGrossEur === 0) return null;

            const cotisRate = state.isCadre ? TAX_CONFIG.fr.cotis_rate_cadre : TAX_CONFIG.fr.cotis_rate_noncadre;
            const socialContrib = annualGrossEur * cotisRate;

            const netImposable = (annualGrossEur - socialContrib) * 0.90;

            let parts = state.status === 'married' ? 2 : 1;

            if (state.children > 0) {
                if (state.children === 1) parts += 0.5;
                else if (state.children === 2) parts += 1.0;
                else parts += 1.0 + (state.children - 2);
            }

            const incomePerPart = netImposable / parts;
            let taxPerPart = 0;
            let previousLimit = 0;
            const bracketsDetail = [];

            for (let i = 0; i < TAX_CONFIG.fr.brackets.length; i++) {
                const bracket = TAX_CONFIG.fr.brackets[i];
                const prevLimit = i === 0 ? 0 : TAX_CONFIG.fr.brackets[i-1].limit;

                if (incomePerPart > prevLimit) {
                    const taxableInBracket = Math.min(incomePerPart, bracket.limit) - prevLimit;
                    const taxInBracket = taxableInBracket * bracket.rate;
                    taxPerPart += taxInBracket;

                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: taxableInBracket,
                        rate: bracket.rate,
                        tax: taxInBracket
                    });
                } else {
                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: 0,
                        rate: bracket.rate,
                        tax: 0
                    });
                }
                previousLimit = bracket.limit;
            }

            const totalTax = taxPerPart * parts;
            const netInPocket = annualGrossEur - socialContrib - totalTax;

            return {
                gross: annualGrossEur,
                social: socialContrib,
                tax: totalTax,
                taxPerPart: taxPerPart,
                parts: parts,
                netImposable: netImposable,
                incomePerPart: incomePerPart,
                bracketsDetail: bracketsDetail,
                net: netInPocket,
                rate: (socialContrib + totalTax) / annualGrossEur
            };
        }

        function calculateMorocco() {
            let annualGrossMad = state.salaryInput;
            if (state.salaryCurrency === 'EUR') annualGrossMad *= state.exchangeRate;
            if (state.period === 'monthly') annualGrossMad *= 12;

            if (annualGrossMad === 0) return null;

            const cnssBase = Math.min(annualGrossMad, 72000);
            const cnss = cnssBase * TAX_CONFIG.ma.cnss_rate;
            const amo = annualGrossMad * TAX_CONFIG.ma.amo_rate;
            const socialContrib = cnss + amo;

            const grossLessSocial = annualGrossMad - socialContrib;
            const proDeduction = Math.min(grossLessSocial * 0.20, 30000);
            const netImposable = grossLessSocial - proDeduction;

            let tax = 0;
            let taxPerPart = 0;
            let previousLimit = 0;
            const bracketsDetail = [];

            for (let i = 0; i < TAX_CONFIG.ma.brackets.length; i++) {
                const bracket = TAX_CONFIG.ma.brackets[i];
                const prevLimit = i === 0 ? 0 : TAX_CONFIG.ma.brackets[i-1].limit;

                if (netImposable > prevLimit) {
                    const taxableInBracket = Math.min(netImposable, bracket.limit) - prevLimit;
                    const taxInBracket = taxableInBracket * bracket.rate;
                    taxPerPart += taxInBracket;

                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: taxableInBracket,
                        rate: bracket.rate,
                        tax: taxInBracket
                    });
                } else {
                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: 0,
                        rate: bracket.rate,
                        tax: 0
                    });
                }
                previousLimit = bracket.limit;
            }

            tax = taxPerPart;
            if(tax < 0) tax = 0;

            const spouseCount = state.status === 'married' ? 1 : 0;
            const dependants = spouseCount + state.children;
            const familyReduc = Math.min(dependants * TAX_CONFIG.ma.family_deduction, TAX_CONFIG.ma.family_deduction_cap);
            const taxBeforeReduc = tax;
            tax = Math.max(0, tax - familyReduc);

            const netInPocket = annualGrossMad - socialContrib - tax;

            return {
                gross: annualGrossMad,
                social: socialContrib,
                tax: tax,
                taxBeforeReduc: taxBeforeReduc,
                familyReduc: familyReduc,
                dependants: dependants,
                net: netInPocket,
                rate: (socialContrib + tax) / annualGrossMad,
                netImposable: netImposable,
                bracketsDetail: bracketsDetail
            };
        }

        // --- UI UPDATER ---

        function render() {
            const frData = calculateFrance();
            const maData = calculateMorocco();

            if (!frData || !maData) {
                els.verdictDiff.textContent = "--";
                els.verdictDiffEur.textContent = "";
                return;
            }

            const maMultiplier = state.period === 'monthly' ? 1/12 : 1;

            els.maNet.innerHTML = `${formatNumber(maData.net * maMultiplier)} <span class="text-sm font-normal text-slate-400">MAD</span>`;
            els.maNetEur.textContent = `‚âà ${formatMoney((maData.net * maMultiplier) / state.exchangeRate, 'EUR')}`;
            els.maRate.textContent = formatPct(maData.rate);

            const maTotal = maData.gross;
            els.barMaNet.style.width = (maData.net / maTotal * 100) + '%';
            els.barMaTax.style.width = (maData.tax / maTotal * 100) + '%';
            els.barMaSoc.style.width = (maData.social / maTotal * 100) + '%';

            const familyReducRow = maData.familyReduc > 0
                ? `<tr class="text-emerald-600"><td class="px-4 py-2 pl-6 text-xs">Abattement familial (${maData.dependants} pers.)</td><td class="px-4 py-2 text-right text-xs" colspan="2">+${formatMoney(maData.familyReduc * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>`
                : '';

            let maBracketsHtml = '';
            maData.bracketsDetail.forEach((b, i) => {
                if (b.amount > 0) {
                    const toLabel = b.to === Infinity ? '+' : formatMoney(b.to, 'MAD');
                    maBracketsHtml += `<tr class="text-slate-900 text-[10px]">
                        <td class="px-4 py-1">${formatMoney(b.from, 'MAD')} ‚Üí ${toLabel}</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.amount, 'MAD')}</td>
                        <td class="px-4 py-1 text-right">${(b.rate * 100).toFixed(0)}%</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.tax, 'MAD')}</td>
                    </tr>`;
                }
            });

            els.maTable.innerHTML = `
                <tr><td class="px-4 py-2 font-medium">Salaire Brut</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(maData.gross * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-slate-400">100%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Social (CNSS/AMO)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(maData.social * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(maData.social/maData.gross)}</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Net imposable</td><td class="px-4 py-2 text-right text-xs" colspan="2">${formatMoney(maData.netImposable * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Impot (IR)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(maData.tax * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(maData.tax/maData.gross)}</td></tr>
                ${familyReducRow}
                <tr class="bg-emerald-50/50 font-semibold text-emerald-900"><td class="px-4 py-2">Salaire Net</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(maData.net * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-emerald-600">${formatPct(maData.net/maData.gross)}</td></tr>
                <tr class="bg-emerald-50 cursor-pointer hover:bg-emerald-100 transition-colors border-t border-emerald-200" onclick="toggleTranches('ma')">
                    <td colspan="4" class="px-4 py-2.5">
                        <span class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2">
                            <span class="flex items-center gap-2 text-[11px] font-semibold text-emerald-700">
                                <span id="ma-tranches-arrow" class="text-emerald-500 transition-transform">‚ñ∂</span>
                                Tranches IR appliquees
                            </span>
                            <span class="text-[10px] text-emerald-600 bg-emerald-100 px-2 py-0.5 rounded-full w-fit">Cliquez pour voir</span>
                        </span>
                    </td>
                </tr>
                <tr class="bg-slate-50 text-[10px] text-slate-500 font-medium ma-tranches-row hidden">
                    <td class="px-4 py-1">Tranche</td>
                    <td class="px-4 py-1 text-right">Montant</td>
                    <td class="px-4 py-1 text-right">Taux</td>
                    <td class="px-4 py-1 text-right">Impot</td>
                </tr>
                ${maBracketsHtml.replace(/class="text-slate-900 text-\[10px\]"/g, 'class="text-slate-900 text-[10px] ma-tranches-row hidden"')}
            `;

            els.frNet.innerHTML = `${formatNumber(frData.net * maMultiplier)} <span class="text-sm font-normal text-slate-400">‚Ç¨</span>`;
            els.frNetMad.textContent = `‚âà ${formatMoney((frData.net * maMultiplier) * state.exchangeRate, 'MAD')}`;
            els.frRate.textContent = formatPct(frData.rate);

            const frTotal = frData.gross;
            els.barFrNet.style.width = (frData.net / frTotal * 100) + '%';
            els.barFrTax.style.width = (frData.tax / frTotal * 100) + '%';
            els.barFrSoc.style.width = (frData.social / frTotal * 100) + '%';

            const netAvantAbattement = (frData.gross - frData.social) * maMultiplier;
            const abattement10 = netAvantAbattement * 0.10;

            let frBracketsHtml = '';
            frData.bracketsDetail.forEach((b, i) => {
                if (b.amount > 0) {
                    const toLabel = b.to === Infinity ? '+' : formatMoney(b.to, 'EUR');
                    frBracketsHtml += `<tr class="text-slate-900 text-[10px]">
                        <td class="px-4 py-1">${formatMoney(b.from, 'EUR')} ‚Üí ${toLabel}</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.amount, 'EUR')}</td>
                        <td class="px-4 py-1 text-right">${(b.rate * 100).toFixed(0)}%</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.tax, 'EUR')}</td>
                    </tr>`;
                }
            });

            els.frTable.innerHTML = `
                <tr><td class="px-4 py-2 font-medium">Salaire Brut</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(frData.gross * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-slate-400">100%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Charges Sociales (Est.)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(frData.social * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(frData.social/frData.gross)}</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Abattement 10%</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(abattement10, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">10%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Net imposable</td><td class="px-4 py-2 text-right text-xs" colspan="2">${formatMoney(frData.netImposable * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Impot (IR)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(frData.tax * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(frData.tax/frData.gross)}</td></tr>
                <tr class="bg-indigo-50/50 font-semibold text-indigo-900"><td class="px-4 py-2">Salaire Net</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(frData.net * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-indigo-600">${formatPct(frData.net/frData.gross)}</td></tr>
                <tr class="bg-indigo-50 cursor-pointer hover:bg-indigo-100 transition-colors border-t border-indigo-200" onclick="toggleTranches('fr')">
                    <td colspan="4" class="px-4 py-2.5">
                        <span class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2">
                            <span class="flex items-center gap-2 text-[11px] font-semibold text-indigo-700">
                                <span id="fr-tranches-arrow" class="text-indigo-500 transition-transform">‚ñ∂</span>
                                Tranches IR appliquees (${frData.parts} part${frData.parts > 1 ? 's' : ''})
                            </span>
                            <span class="text-[10px] text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded-full w-fit">Cliquez pour voir</span>
                        </span>
                    </td>
                </tr>
                <tr class="bg-slate-50 text-[10px] text-slate-500 font-medium fr-tranches-row hidden">
                    <td class="px-4 py-1">Tranche</td>
                    <td class="px-4 py-1 text-right">Montant</td>
                    <td class="px-4 py-1 text-right">Taux</td>
                    <td class="px-4 py-1 text-right">Impot</td>
                </tr>
                ${frBracketsHtml.replace(/class="text-slate-900 text-\[10px\]"/g, 'class="text-slate-900 text-[10px] fr-tranches-row hidden"')}
                <tr class="text-slate-900 text-[10px] border-t border-slate-200 font-semibold fr-tranches-row hidden">
                    <td class="px-4 py-1">Total (${frData.parts} part${frData.parts > 1 ? 's' : ''})</td>
                    <td class="px-4 py-1 text-right" colspan="2"></td>
                    <td class="px-4 py-1 text-right">${formatMoney(frData.tax, 'EUR')}</td>
                </tr>
            `;

            const frNetInMad = frData.net * state.exchangeRate;
            const maNetInMad = maData.net;
            const diffAnnualMad = Math.abs(frNetInMad - maNetInMad);
            const diffAnnualEur = diffAnnualMad / state.exchangeRate;

            const winner = frNetInMad > maNetInMad ? 'France' : 'Maroc';

            els.verdictDiff.textContent = formatMoney(diffAnnualEur, 'EUR');
            els.verdictDiffEur.textContent = formatMoney(diffAnnualMad, 'MAD');

            const diffPct = Math.abs(frData.rate - maData.rate) * 100;

            if(winner === 'Maroc') {
                els.verdictTitle.innerHTML = `<span class="text-2xl mr-2">üá≤üá¶</span> Le Maroc l'emporte !`;
                els.verdictTitle.className = "font-semibold text-xl tracking-tight text-emerald-400 flex items-center";
                els.verdictText.innerHTML = `
                    <div class="flex items-center gap-4 mt-2">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-emerald-500/20 rounded-lg">
                            <span>üá≤üá¶</span>
                            <span class="font-bold text-emerald-400">${formatPct(maData.rate)}</span>
                        </div>
                        <span class="text-slate-500">vs</span>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 rounded-lg">
                            <span>üá´üá∑</span>
                            <span class="text-slate-300">${formatPct(frData.rate)}</span>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mt-2">Vous economisez <span class="text-emerald-400 font-semibold">${diffPct.toFixed(1)} points</span> de pression fiscale</p>
                `;
            } else {
                els.verdictTitle.innerHTML = `<span class="text-2xl mr-2">üá´üá∑</span> La France l'emporte !`;
                els.verdictTitle.className = "font-semibold text-xl tracking-tight text-indigo-400 flex items-center";
                els.verdictText.innerHTML = `
                    <div class="flex items-center gap-4 mt-2">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-indigo-500/20 rounded-lg">
                            <span>üá´üá∑</span>
                            <span class="font-bold text-indigo-400">${formatPct(frData.rate)}</span>
                        </div>
                        <span class="text-slate-500">vs</span>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 rounded-lg">
                            <span>üá≤üá¶</span>
                            <span class="text-slate-300">${formatPct(maData.rate)}</span>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mt-2">Vous economisez <span class="text-indigo-400 font-semibold">${diffPct.toFixed(1)} points</span> de pression fiscale</p>
                `;
            }
        }

        // --- EVENT LISTENERS ---

        els.inputMad.addEventListener('input', (e) => {
            const cursorPos = e.target.selectionStart;
            const oldLen = e.target.value.length;

            if(!e.target.value.replace(/\s/g, '')) {
                state.salaryInput = 0;
                e.target.value = '';
                els.inputEur.value = '';
                render();
                return;
            }

            const val = parseInputValue(e.target.value);
            state.salaryInput = val;
            state.salaryCurrency = 'MAD';

            e.target.value = formatInputValue(e.target.value);
            els.inputEur.value = formatInputValue(Math.round(val / state.exchangeRate));

            const newLen = e.target.value.length;
            const newPos = cursorPos + (newLen - oldLen);
            e.target.setSelectionRange(newPos, newPos);

            render();
        });

        els.inputEur.addEventListener('input', (e) => {
            const cursorPos = e.target.selectionStart;
            const oldLen = e.target.value.length;

            if(!e.target.value.replace(/\s/g, '')) {
                state.salaryInput = 0;
                e.target.value = '';
                els.inputMad.value = '';
                render();
                return;
            }

            const val = parseInputValue(e.target.value);
            state.salaryInput = val;
            state.salaryCurrency = 'EUR';

            e.target.value = formatInputValue(e.target.value);
            els.inputMad.value = formatInputValue(Math.round(val * state.exchangeRate));

            const newLen = e.target.value.length;
            const newPos = cursorPos + (newLen - oldLen);
            e.target.setSelectionRange(newPos, newPos);

            render();
        });

        els.inputRate.addEventListener('change', (e) => {
            state.exchangeRate = parseFloat(e.target.value) || 10.8;
            render();
        });

        const setPeriod = (p) => {
            state.period = p;
            if(p === 'monthly') {
                els.btnMonthly.className = "px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300";
                els.btnAnnual.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";
            } else {
                els.btnAnnual.className = "px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300";
                els.btnMonthly.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";
            }
            render();
        };
        els.btnMonthly.addEventListener('click', () => setPeriod('monthly'));
        els.btnAnnual.addEventListener('click', () => setPeriod('annual'));

        const setStatus = (status) => {
            state.status = status;

            const activeClass = "flex-1 py-1.5 text-[11px] font-medium rounded-md bg-white shadow-sm text-slate-900 border border-slate-100 transition-all-300";
            const inactiveClass = "flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";

            els.btnSingle.className = status === 'single' ? activeClass : inactiveClass;
            els.btnMarried.className = status === 'married' ? activeClass : inactiveClass;
            els.btnDivorced.className = status === 'divorced' ? activeClass : inactiveClass;

            render();
        };
        els.btnSingle.addEventListener('click', () => setStatus('single'));
        els.btnMarried.addEventListener('click', () => setStatus('married'));
        els.btnDivorced.addEventListener('click', () => setStatus('divorced'));

        const updateChildren = (val) => {
            if (val < 0) val = 0;
            if (val > 10) val = 10;
            state.children = val;
            els.displayChildren.textContent = state.children;
            render();
        };
        els.btnChildMinus.addEventListener('click', () => updateChildren(state.children - 1));
        els.btnChildPlus.addEventListener('click', () => updateChildren(state.children + 1));

        els.toggleCadre.addEventListener('click', () => {
            state.isCadre = !state.isCadre;
            const dot = els.toggleCadre.querySelector('span');
            if(state.isCadre) {
                els.toggleCadre.classList.replace('bg-slate-200', 'bg-indigo-500');
                dot.classList.add('translate-x-3');
                dot.classList.remove('translate-x-0.5');
            } else {
                els.toggleCadre.classList.replace('bg-indigo-500', 'bg-slate-200');
                dot.classList.remove('translate-x-3');
                dot.classList.add('translate-x-0.5');
            }
            render();
        });

        async function fetchExchangeRate() {
            const rateStatus = document.getElementById('rate-status');
            try {
                const response = await fetch('https://api.frankfurter.app/latest?from=EUR&to=MAD');
                const data = await response.json();
                if (data.rates && data.rates.MAD) {
                    const rate = data.rates.MAD;
                    els.inputRate.value = rate.toFixed(2);
                    state.exchangeRate = rate;
                    rateStatus.textContent = '‚úì';
                    rateStatus.className = 'text-[10px] text-emerald-500';
                    render();
                }
            } catch (error) {
                rateStatus.textContent = '(defaut)';
                rateStatus.className = 'text-[10px] text-slate-400';
            }
        }

        // Init
        fetchExchangeRate();
        setPeriod('annual');
        els.inputEur.value = '100 000';
        els.inputEur.dispatchEvent(new Event('input'));

    </script>

</body>
</html>
