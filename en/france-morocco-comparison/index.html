<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Analytics (charg√© apr√®s interaction pour performance) -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        function loadGA() {
            if (window.gaLoaded) return;
            window.gaLoaded = true;

            var script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z328SB8DZ8';
            script.async = true;
            document.head.appendChild(script);

            gtag('js', new Date());
            gtag('config', 'G-Z328SB8DZ8');
        }

        // Charger GA apr√®s interaction utilisateur ou apr√®s 3s
        ['scroll', 'click', 'touchstart', 'keydown'].forEach(function(evt) {
            window.addEventListener(evt, loadGA, {once: true, passive: true});
        });
        setTimeout(loadGA, 3000);
    </script>

    <!-- Language Router (must be early for redirect) -->
    <script defer src="/assets/js/lang-router.js"></script>

    <script>
    </script>

    <title>France vs Morocco Salary Comparison for MRE 2025 | NetSalaire</title>
    <meta name="description" content="MRE: France or Morocco, where do you really earn more? Compare net salary, taxes and contributions. Free calculator for Moroccans Living Abroad.">
    <meta name="keywords" content="MRE, Moroccans living abroad, france morocco salary comparison, MRE tax simulator, france morocco tax, net salary, moroccan expats, return to morocco">

    <!-- Canonical & Hreflang -->
    <link rel="canonical" href="https://netsalaire.com/en/france-morocco-comparison/">
    <link rel="alternate" hreflang="en" href="https://netsalaire.com/en/france-morocco-comparison/">
    <link rel="alternate" hreflang="fr" href="https://netsalaire.com/fr/comparateur-salaire-france-maroc/">
    <link rel="alternate" hreflang="x-default" href="https://netsalaire.com/fr/comparateur-salaire-france-maroc/">

    <!-- Open Graph -->
    <meta property="og:title" content="France vs Morocco Salary Comparison for MRE 2025 | NetSalaire">
    <meta property="og:description" content="MRE: France or Morocco, where do you really earn more? Free tax simulator for Moroccans Living Abroad.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://netsalaire.com/en/france-morocco-comparison/">
    <meta property="og:image" content="https://netsalaire.com/assets/images/og-comparateur.png">
    <meta property="og:site_name" content="NetSalaire">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="France vs Morocco Salary Comparison for MRE 2025">
    <meta name="twitter:description" content="MRE: France or Morocco, where do you really earn more? Free tax simulator.">
    <meta name="twitter:image" content="https://netsalaire.com/assets/images/og-comparateur.png">

    <!-- Additional SEO -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="NetSalaire">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">

    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <!-- Preconnect pour performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://code.iconify.design">
    <link rel="preconnect" href="https://api.iconify.design">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Icons (defer pour ne pas bloquer) -->
    <script defer src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        .toggle-checkbox:checked {
            right: 0;
            border-color: #0f172a;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #0f172a;
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .transition-all-300 { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "France vs Morocco Salary Comparison for MRE",
        "description": "Free tax simulator for MRE (Moroccans Living Abroad): compare your net salary between France and Morocco",
        "url": "https://netsalaire.com/en/france-morocco-comparison/",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "EUR"
        },
        "publisher": {
            "@type": "Organization",
            "name": "NetSalaire",
            "url": "https://netsalaire.com"
        }
    }
    </script>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- Navbar -->
    <nav class="fixed top-0 w-full z-50 border-b border-slate-200 bg-white/80 backdrop-blur-md">
        <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
            <a href="/en/" class="flex items-center gap-2 group">
                <div class="w-8 h-8 bg-slate-900 rounded flex items-center justify-center text-white font-semibold tracking-tighter shadow-md group-hover:bg-indigo-600 transition-colors duration-300">
                    N.
                </div>
                <span class="font-semibold tracking-tight text-slate-900">NetSalaire</span>
            </a>
            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-slate-600">
                <div class="relative group">
                    <a href="/en/#france" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="circle-flags:fr" width="16"></iconify-icon> France
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[220px]">
                            <a href="/en/france/income-tax/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:landmark" width="18" class="text-indigo-500"></iconify-icon> Tax Simulator
                            </a>
                            <a href="/en/france/gross-to-net/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:calculator" width="18" class="text-indigo-500"></iconify-icon> Gross to Net
                            </a>
                            <a href="/en/france/tax-guide/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:book-open" width="18" class="text-indigo-500"></iconify-icon> Tax Guide
                            </a>
                        </div>
                    </div>
                </div>
                <div class="relative group">
                    <a href="/en/#morocco" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="circle-flags:ma" width="16"></iconify-icon> Morocco
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[220px]">
                            <a href="/en/morocco/income-tax/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:landmark" width="18" class="text-emerald-500"></iconify-icon> Tax Simulator
                            </a>
                            <a href="/en/morocco/gross-to-net/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:calculator" width="18" class="text-emerald-500"></iconify-icon> Gross to Net
                            </a>
                            <a href="/en/morocco/tax-guide/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:book-open" width="18" class="text-emerald-500"></iconify-icon> Tax Guide
                            </a>
                        </div>
                    </div>
                </div>
                <a href="/en/france-morocco-comparison/" class="hover:text-slate-900 transition-colors">France vs Morocco</a>
                <a href="/en/global-comparison/" class="hover:text-slate-900 transition-colors flex items-center gap-1.5">
                    <iconify-icon icon="lucide:globe" width="16"></iconify-icon> Global Comparison
                </a>
                <a href="/en/faq/" class="hover:text-slate-900 transition-colors">FAQ</a>
            </div>
            <div class="flex items-center gap-3">
                <div class="relative">
                    <button onclick="document.getElementById('lang-dropdown').classList.toggle('hidden')" class="flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-900 bg-slate-100 hover:bg-slate-200 border border-slate-200 rounded-full transition-all">
                        <span>üá¨üáß</span>
                        <iconify-icon icon="lucide:chevron-down" width="14"></iconify-icon>
                    </button>
                    <div id="lang-dropdown" class="hidden absolute top-full right-0 mt-2 bg-white border border-slate-200 rounded-lg shadow-lg min-w-[140px] py-1 z-50">
                        <a href="/fr/comparateur-salaire-france-maroc/" class="flex items-center gap-2 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50">
                            <span>üá´üá∑</span> Francais
                        </a>
                        <a href="/en/france-morocco-comparison/" class="flex items-center gap-2 px-3 py-2 text-sm text-slate-700 bg-slate-50">
                            <span>üá¨üáß</span> English
                        </a>
                    </div>
                </div>
                <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="md:hidden p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg">
                    <iconify-icon icon="lucide:menu" width="24"></iconify-icon>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-200">
            <div class="px-6 py-4 space-y-4">
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-900">
                        <iconify-icon icon="circle-flags:fr" width="18"></iconify-icon> France
                    </div>
                    <div class="pl-6 space-y-2">
                        <a href="/en/france/income-tax/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600">
                            <iconify-icon icon="lucide:landmark" width="16" class="text-indigo-500"></iconify-icon> Tax Simulator
                        </a>
                        <a href="/en/france/gross-to-net/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600">
                            <iconify-icon icon="lucide:calculator" width="16" class="text-indigo-500"></iconify-icon> Gross to Net
                        </a>
                        <a href="/en/france/tax-guide/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600">
                            <iconify-icon icon="lucide:book-open" width="16" class="text-indigo-500"></iconify-icon> Tax Guide
                        </a>
                    </div>
                </div>
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-900">
                        <iconify-icon icon="circle-flags:ma" width="18"></iconify-icon> Morocco
                    </div>
                    <div class="pl-6 space-y-2">
                        <a href="/en/morocco/income-tax/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600">
                            <iconify-icon icon="lucide:landmark" width="16" class="text-emerald-500"></iconify-icon> Tax Simulator
                        </a>
                        <a href="/en/morocco/gross-to-net/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600">
                            <iconify-icon icon="lucide:calculator" width="16" class="text-emerald-500"></iconify-icon> Gross to Net
                        </a>
                        <a href="/en/morocco/tax-guide/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600">
                            <iconify-icon icon="lucide:book-open" width="16" class="text-emerald-500"></iconify-icon> Tax Guide
                        </a>
                    </div>
                </div>
                <div class="pt-2 border-t border-slate-100 space-y-2">
                    <a href="/en/france-morocco-comparison/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900">
                        <iconify-icon icon="lucide:scale" width="16"></iconify-icon> France vs Morocco
                    </a>
                    <a href="/en/global-comparison/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900">
                        <iconify-icon icon="lucide:globe" width="16"></iconify-icon> Global Comparison
                    </a>
                    <a href="/en/faq/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900">
                        <iconify-icon icon="lucide:help-circle" width="16"></iconify-icon> FAQ
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="w-full max-w-6xl mx-auto space-y-6 pt-24 pb-8 px-4 sm:px-6 lg:px-8">

        <!-- Page Header -->
        <header class="text-center mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-900 mb-2">France vs Morocco Tax Comparison for MRE</h1>
            <p class="text-slate-500 max-w-2xl mx-auto">Compare your net salary and tax burden between the two countries. Simulator updated with 2025 tax brackets.</p>
        </header>

        <!-- Input Section -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-500 via-slate-200 to-indigo-500"></div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Salary Inputs -->
                <div class="space-y-5">
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-xs font-semibold uppercase tracking-tight text-slate-500">Gross Salary</label>
                        <div class="flex bg-slate-100 rounded-lg p-0.5">
                            <button id="period-monthly" class="px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300">Monthly</button>
                            <button id="period-annual" class="px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300">Annual</button>
                        </div>
                    </div>

                    <div class="relative grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Divider "OR" -->
                        <div class="hidden sm:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-8 h-8 items-center justify-center bg-white rounded-full border border-slate-200 shadow-sm">
                            <span class="text-[10px] font-bold text-slate-400 uppercase">or</span>
                        </div>
                        <div class="sm:hidden w-full text-center -my-2 order-2">
                            <span class="text-[10px] font-bold text-slate-300 uppercase bg-white px-2 relative z-10">or</span>
                        </div>

                        <!-- France Input -->
                        <div class="relative group order-1 sm:order-2">
                            <label class="block text-xs font-medium text-slate-500 mb-1.5">France (EUR)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium text-sm">‚Ç¨</span>
                                <input type="text" inputmode="numeric" id="input-eur" class="w-full pl-10 pr-4 py-2.5 text-sm font-semibold text-slate-900 bg-white border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all-300" placeholder="0">
                            </div>
                            <div class="flex items-center justify-end gap-2 mt-2">
                                <span class="text-[10px] text-slate-400 font-medium">Executive Status</span>
                                <button id="toggle-cadre" class="relative inline-flex h-4 w-7 items-center rounded-full bg-slate-200 transition-colors focus:outline-none">
                                    <span class="translate-x-0.5 inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm"></span>
                                </button>
                            </div>
                        </div>

                        <!-- Morocco Input -->
                        <div class="relative group order-3 sm:order-1">
                            <label class="block text-xs font-medium text-slate-500 mb-1.5">Morocco (MAD)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium text-sm">Dh</span>
                                <input type="text" inputmode="numeric" id="input-mad" class="w-full pl-10 pr-4 py-2.5 text-sm font-semibold text-slate-900 bg-white border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all-300" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-2 mt-2">
                        <span class="text-[10px] text-slate-400 font-medium">Today's MAD/EUR rate:</span>
                        <input type="number" id="exchange-rate" value="10.8" class="w-16 py-0.5 px-1 text-[10px] font-mono text-slate-500 bg-slate-50 border border-slate-200 rounded text-center focus:outline-none focus:border-slate-400">
                        <span id="rate-status" class="text-[10px] text-emerald-500"></span>
                    </div>
                </div>

                <!-- Family Situation -->
                <div class="space-y-5 lg:border-l lg:border-slate-100 lg:pl-8">
                    <label class="block text-xs font-semibold uppercase tracking-tight text-slate-500 mb-2">Family Status</label>

                    <div class="space-y-4">
                        <div>
                            <span class="text-xs font-medium text-slate-600 mb-2 block">Marital Status</span>
                            <div class="flex w-full bg-slate-50 border border-slate-200 rounded-lg p-1">
                                <button id="status-single" class="flex-1 py-1.5 text-[11px] font-medium rounded-md bg-white shadow-sm text-slate-900 border border-slate-100 transition-all-300">Single</button>
                                <button id="status-married" class="flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300">Married</button>
                                <button id="status-divorced" class="flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300">Divorced</button>
                            </div>
                        </div>

                        <div>
                            <span class="text-xs font-medium text-slate-600 mb-2 block">Dependent Children</span>
                            <div class="flex items-center w-full bg-white border border-slate-200 rounded-lg h-[38px]">
                                <button id="child-minus" class="w-10 h-full flex items-center justify-center text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-l-lg transition-colors border-r border-slate-100">
                                    <span class="iconify" data-icon="lucide:minus" width="14"></span>
                                </button>
                                <div id="children-display" class="flex-1 text-center text-sm font-semibold text-slate-900 select-none">0</div>
                                <button id="child-plus" class="w-10 h-full flex items-center justify-center text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-r-lg transition-colors border-l border-slate-100">
                                    <span class="iconify" data-icon="lucide:plus" width="14"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Comparison Results -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- MOROCCO COLUMN -->
            <article class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col order-2 md:order-1">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üá≤üá¶</span>
                        <h2 class="text-base font-semibold text-slate-900">Morocco</h2>
                    </div>
                    <span class="text-[10px] font-medium text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100">Progressive IR</span>
                </div>

                <div class="p-6 flex-1 flex flex-col gap-6">
                    <!-- KPIs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Take-Home Pay</p>
                            <p class="text-2xl font-semibold text-slate-900 tracking-tight" id="ma-net">0 <span class="text-sm font-normal text-slate-400">MAD</span></p>
                            <p class="text-[10px] text-slate-400 mt-1" id="ma-net-eur">‚âà 0 ‚Ç¨</p>
                        </div>
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Tax Rate</p>
                            <p class="text-2xl font-semibold text-emerald-600 tracking-tight" id="ma-rate">0%</p>
                            <p class="text-[10px] text-slate-400 mt-1">Total Burden</p>
                        </div>
                    </div>

                    <!-- Stacked Bar Chart -->
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-medium text-slate-500 uppercase tracking-wide">
                            <span>Distribution</span>
                            <span>100% of Gross</span>
                        </div>
                        <div class="h-6 w-full bg-slate-100 rounded-md overflow-hidden flex shadow-inner relative group">
                            <div id="bar-ma-net" class="h-full bg-emerald-500 transition-all-300 relative group/segment" style="width: 60%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Net Salary</div>
                            </div>
                            <div id="bar-ma-tax" class="h-full bg-emerald-300 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Income Tax</div>
                            </div>
                            <div id="bar-ma-soc" class="h-full bg-emerald-100 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Contributions</div>
                            </div>
                        </div>
                        <div class="flex justify-between text-[10px] text-slate-400">
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-500"></div>Net</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-300"></div>Tax</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-100"></div>Social</div>
                        </div>
                    </div>

                    <!-- Breakdown Table -->
                    <div class="mt-2 border rounded-lg border-slate-200 overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-[10px] uppercase text-slate-500 font-semibold border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3">Item</th>
                                    <th class="px-4 py-3 text-right" colspan="2">Amount</th>
                                    <th class="px-4 py-3 text-right text-slate-400">%</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="ma-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </article>

            <!-- FRANCE COLUMN -->
            <article class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col order-1 md:order-2">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üá´üá∑</span>
                        <h2 class="text-base font-semibold text-slate-900">France</h2>
                    </div>
                    <span class="text-[10px] font-medium text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-full border border-indigo-100">Family Quotient</span>
                </div>

                <div class="p-6 flex-1 flex flex-col gap-6">
                    <!-- KPIs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Take-Home Pay</p>
                            <p class="text-2xl font-semibold text-slate-900 tracking-tight" id="fr-net">0 <span class="text-sm font-normal text-slate-400">‚Ç¨</span></p>
                            <p class="text-[10px] text-slate-400 mt-1" id="fr-net-mad">‚âà 0 MAD</p>
                        </div>
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Tax Rate</p>
                            <p class="text-2xl font-semibold text-indigo-600 tracking-tight" id="fr-rate">0%</p>
                            <p class="text-[10px] text-slate-400 mt-1">Total Burden</p>
                        </div>
                    </div>

                    <!-- Stacked Bar Chart -->
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-medium text-slate-500 uppercase tracking-wide">
                            <span>Distribution</span>
                            <span>100% of Gross</span>
                        </div>
                        <div class="h-6 w-full bg-slate-100 rounded-md overflow-hidden flex shadow-inner relative">
                            <div id="bar-fr-net" class="h-full bg-indigo-500 transition-all-300 relative group/segment" style="width: 60%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Net Salary</div>
                            </div>
                            <div id="bar-fr-tax" class="h-full bg-indigo-300 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Income Tax</div>
                            </div>
                            <div id="bar-fr-soc" class="h-full bg-indigo-100 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Contributions</div>
                            </div>
                        </div>
                        <div class="flex justify-between text-[10px] text-slate-400">
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-500"></div>Net</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-300"></div>Tax</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-100"></div>Social</div>
                        </div>
                    </div>

                    <!-- Breakdown Table -->
                    <div class="mt-2 border rounded-lg border-slate-200 overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-[10px] uppercase text-slate-500 font-semibold border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3">Item</th>
                                    <th class="px-4 py-3 text-right" colspan="2">Amount</th>
                                    <th class="px-4 py-3 text-right text-slate-400">%</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="fr-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </article>

        </div>

        <!-- Verdict Banner -->
        <div class="bg-slate-900 text-white rounded-xl shadow-lg p-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <span class="iconify w-8 h-8 text-yellow-400" data-icon="lucide:trophy"></span>
                <div>
                    <h3 class="font-semibold text-lg tracking-tight" id="verdict-title">Analysis Ready</h3>
                    <p class="text-sm text-slate-400" id="verdict-text">Enter your salary to compare.</p>
                </div>
            </div>
            <div class="text-right flex flex-col items-end">
                <p class="text-xs uppercase tracking-widest text-slate-500 font-medium mb-1">Annual Difference</p>
                <div class="flex flex-col items-end">
                    <p class="text-2xl font-bold font-mono tracking-tight text-white leading-none mb-1" id="verdict-diff">--</p>
                    <p class="text-sm font-medium text-slate-400 font-mono tracking-tight" id="verdict-diff-eur"></p>
                </div>
            </div>
        </div>

        <!-- Reassurance -->
        <section class="bg-white rounded-xl border border-slate-200 p-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div>
                    <div class="text-2xl mb-2">üîí</div>
                    <h4 class="text-sm font-semibold text-slate-900">100% Secure</h4>
                    <p class="text-xs text-slate-500">No data stored</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">üìä</div>
                    <h4 class="text-sm font-semibold text-slate-900">2025 Tax Brackets</h4>
                    <p class="text-xs text-slate-500">Current finance law</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">‚ö°</div>
                    <h4 class="text-sm font-semibold text-slate-900">Instant Calculation</h4>
                    <p class="text-xs text-slate-500">Real-time results</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">üåç</div>
                    <h4 class="text-sm font-semibold text-slate-900">Live Rate</h4>
                    <p class="text-xs text-slate-500">Today's exchange rate</p>
                </div>
            </div>
        </section>

        <p class="text-center text-[10px] text-slate-400 mt-8 pb-4 max-w-2xl mx-auto leading-relaxed">
            Legal Disclaimer: This tool is provided for informational purposes only. Tax laws in France and Morocco are complex and subject to change (Finance Law 2025). Social contributions are average estimates. Calculations exclude complex tax niches.
        </p>

        <!-- SEO Content Section -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">Understanding France-Morocco Tax Differences</h2>

            <div class="prose prose-slate max-w-none">
                <h3 class="text-xl font-semibold text-slate-800 mt-6 mb-3">Two Different Tax Systems</h3>
                <p class="text-slate-600 mb-4">
                    <strong>France</strong> and <strong>Morocco</strong> have fundamentally different tax systems. In France, the system relies on the <strong>family quotient</strong> which divides taxable income by the number of household shares, thus reducing tax for families. In Morocco, a flat-rate <strong>family deduction</strong> applies: 360 MAD per dependent, with a cap of 2,160 MAD per year (6 people max).
                </p>
                <p class="text-slate-600 mb-4">
                    <strong>Social contributions</strong> also represent a major difference. In France, they reach about 22% to 25% of gross salary (depending on executive/non-executive status), funding a comprehensive social protection system. In Morocco, CNSS and AMO contributions are lower (about 6.7%), but social coverage is also less extensive.
                </p>

                <h3 class="text-xl font-semibold text-slate-800 mt-8 mb-3">Why Use This Comparator?</h3>
                <p class="text-slate-600 mb-4">
                    This comparator is essential for <strong>Moroccans Living in France (MRE)</strong> considering a return home, <strong>French expatriates</strong> considering mobility to Morocco, or <strong>dual nationals</strong> hesitating between the two countries. It allows for an objective comparison of the <strong>total tax burden</strong> (contributions + taxes) and the <strong>real net salary</strong> in each country.
                </p>
                <p class="text-slate-600 mb-4">
                    The comparator takes into account the <strong>real-time EUR/MAD exchange rate</strong>, allowing for precise amount comparisons. It also integrates the specificities of each system: French family quotient, Moroccan professional expense deduction (20%), CNSS ceiling, etc.
                </p>

                <h3 class="text-xl font-semibold text-slate-800 mt-8 mb-3">Factors to Consider</h3>
                <ul class="list-disc pl-6 text-slate-600 space-y-2 mb-6">
                    <li><strong>Cost of living</strong>: Morocco is generally 40-60% cheaper than France</li>
                    <li><strong>Social coverage</strong>: France offers more comprehensive protection (unemployment, retirement, health)</li>
                    <li><strong>Progressive tax</strong>: High incomes are taxed more in France (up to 45%) than in Morocco (37%)</li>
                    <li><strong>Family situation</strong>: The French family quotient benefits large families</li>
                    <li><strong>Tax treaties</strong>: France and Morocco have signed a treaty to avoid double taxation</li>
                </ul>
            </div>
        </section>

        <!-- Examples Section -->
        <section class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-2xl p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">3 Concrete Comparison Examples</h2>

            <div class="grid md:grid-cols-3 gap-6">
                <!-- Example 1 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üë®‚Äçüéì</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Young Graduate: ‚Ç¨35,000/year</h3>
                    <p class="text-xs text-slate-500 mb-3">Single, no children</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Contributions: ~‚Ç¨7,700 | Tax: ~‚Ç¨1,460</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~‚Ç¨25,840/year</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Morocco (378,000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~11,800 MAD | Tax: ~103,400 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~262,800 MAD (~‚Ç¨24,300)</div>
                    </div>
                    <p class="text-xs text-indigo-600 mt-4 font-semibold">‚Üí France +‚Ç¨1,500/year</p>
                </div>

                <!-- Example 2 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Family: ‚Ç¨60,000/year</h3>
                    <p class="text-xs text-slate-500 mb-3">Married, 2 children</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Contributions: ~‚Ç¨13,200 | Tax: ~‚Ç¨906 (3 shares)</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~‚Ç¨45,900/year</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Morocco (648,000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~17,900 MAD | Tax: ~202,600 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~427,500 MAD (~‚Ç¨39,600)</div>
                    </div>
                    <p class="text-xs text-indigo-600 mt-4 font-semibold">‚Üí France +‚Ç¨6,300/year</p>
                </div>

                <!-- Example 3 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üëî</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Senior Executive: ‚Ç¨120,000/year</h3>
                    <p class="text-xs text-slate-500 mb-3">Married, 3 children, executive</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Contributions: ~‚Ç¨30,000 | Tax: ~‚Ç¨3,940 (4 shares)</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~‚Ç¨86,060/year</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Morocco (1,296,000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~32,500 MAD | Tax: ~442,900 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~820,600 MAD (~‚Ç¨76,000)</div>
                    </div>
                    <p class="text-xs text-indigo-600 mt-4 font-semibold">‚Üí France +‚Ç¨10,000/year</p>
                </div>
            </div>

            <p class="text-xs text-slate-500 text-center mt-6">
                * Estimates based on 2025 tax brackets. Exchange rate: 1 EUR = 10.8 MAD. Actual amounts may vary.
            </p>
        </section>

        <!-- FAQ Section -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">Frequently Asked Questions: France vs Morocco</h2>

            <div class="space-y-6">
                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Which country is more tax-advantageous?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">France is often more advantageous for salaried employees, especially for families thanks to the family quotient. For singles, the difference can be small. For families with children, France offers a significantly higher net salary. Keep in mind that the cost of living is 40-60% lower in Morocco, which can offset higher taxes.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">How does the French family quotient work?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">The family quotient divides taxable income by the number of shares: 1 share for a single person, 2 shares for a married couple, +0.5 share for the first 2 children, +1 share per additional child. This reduces tax progressivity and significantly benefits families.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">What is the family deduction in Morocco?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">In Morocco, the family deduction is a flat-rate reduction of 360 MAD per year per dependent (spouse + children), capped at 2,160 MAD per year (maximum 6 people). This is much less advantageous than the French family quotient, especially for large families.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Do MREs have to pay taxes in France?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Moroccans Living in France (MRE) are subject to French tax on their French-source income. Thanks to the Franco-Moroccan tax treaty, they are not double-taxed on the same income. Their Moroccan income can be declared in France but with a tax credit.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">What is the difference between CNSS and French Social Security?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">The Moroccan CNSS (National Social Security Fund) deducts about 4.48% of salary (capped at 6,000 MAD/month) versus ~22-25% for French social contributions. The major difference: France funds unemployment, full retirement and family allowances, while CNSS offers more limited coverage.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Are professional expenses deducted the same way?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">In France, a flat-rate 10% deduction is automatically applied to taxable income. In Morocco, it's 20% of gross salary after social contributions, but capped at 30,000 MAD per year. The Moroccan system is therefore more generous for average salaries.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">How is the exchange rate calculated?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Our comparator uses the EUR/MAD exchange rate provided by the European Central Bank via the Frankfurter API. The rate is updated in real-time. You can also enter a custom rate if you have a specific one in mind.</p>
                </details>

                <details class="group pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Should cost of living be considered?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Absolutely! This comparator only shows taxation. The cost of living in Morocco is about 40-60% lower than in France (rent, food, services). A lower net salary in Morocco can therefore offer better purchasing power than in France.</p>
                </details>
            </div>
        </section>

        <!-- Sources Section -->
        <section class="bg-slate-50 rounded-2xl p-6 mt-8">
            <h3 class="font-semibold text-slate-800 mb-4">Official Sources</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm text-slate-600">
                <div>
                    <p>üá´üá∑ <a href="https://www.impots.gouv.fr" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">impots.gouv.fr</a> - 2025 IR brackets</p>
                    <p>üá´üá∑ <a href="https://www.urssaf.fr" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">urssaf.fr</a> - Social contribution rates</p>
                </div>
                <div>
                    <p>üá≤üá¶ <a href="https://www.tax.gov.ma" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">tax.gov.ma</a> - Morocco 2025 IR brackets</p>
                    <p>üá≤üá¶ <a href="https://www.cnss.ma" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">cnss.ma</a> - CNSS and AMO rates</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="py-12 px-6 border-t border-slate-200 bg-white">
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <div class="flex items-center gap-2 mb-4">
                        <div class="w-6 h-6 bg-slate-900 rounded flex items-center justify-center text-white text-xs font-bold">N.</div>
                        <span class="font-semibold text-slate-900">NetSalaire</span>
                    </div>
                    <p class="text-sm text-slate-500">Free tax simulators for France and Morocco.</p>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-3 text-sm">France</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="/en/france/gross-to-net/" class="hover:text-slate-900 transition-colors">Gross to Net</a></li>
                        <li><a href="/en/france/income-tax/" class="hover:text-slate-900 transition-colors">Tax Simulator</a></li>
                        <li><a href="/en/france/tax-guide/" class="hover:text-slate-900 transition-colors">Tax Guide</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-3 text-sm">Morocco</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="/en/morocco/gross-to-net/" class="hover:text-slate-900 transition-colors">Gross to Net</a></li>
                        <li><a href="/en/morocco/income-tax/" class="hover:text-slate-900 transition-colors">Tax Simulator</a></li>
                        <li><a href="/en/morocco/tax-guide/" class="hover:text-slate-900 transition-colors">Tax Guide</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-3 text-sm">Information</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="/en/faq/" class="hover:text-slate-900 transition-colors">FAQ</a></li>
                        <li><a href="/en/legal-notice/" class="hover:text-slate-900 transition-colors">Legal Notice</a></li>
                        <li><a href="/en/privacy-policy/" class="hover:text-slate-900 transition-colors">Privacy</a></li>
                    </ul>
                </div>
            </div>
            <div class="pt-8 border-t border-slate-200">
                <p class="text-sm text-slate-500">&copy; 2025 NetSalaire.com - All rights reserved</p>
            </div>
        </div>
    </footer>

    <script>
        // --- CONSTANTS & CONFIG ---
        const TAX_CONFIG = {
            fr: {
                brackets: [
                    { limit: 11294, rate: 0 },
                    { limit: 28797, rate: 0.11 },
                    { limit: 82341, rate: 0.30 },
                    { limit: 177106, rate: 0.41 },
                    { limit: Infinity, rate: 0.45 }
                ],
                cotis_rate_noncadre: 0.22,
                cotis_rate_cadre: 0.25,
                abattement: 0.10
            },
            ma: {
                brackets: [
                    { limit: 30000, rate: 0, deduct: 0 },
                    { limit: 50000, rate: 0.10, deduct: 3000 },
                    { limit: 60000, rate: 0.20, deduct: 8000 },
                    { limit: 80000, rate: 0.30, deduct: 14000 },
                    { limit: 180000, rate: 0.34, deduct: 17200 },
                    { limit: Infinity, rate: 0.38, deduct: 24400 }
                ],
                cnss_rate: 0.0448,
                cnss_ceiling_monthly: 6000,
                amo_rate: 0.0226,
                family_deduction: 360,
                family_deduction_cap: 2160
            }
        };

        // --- STATE ---
        const state = {
            salaryInput: 0,
            salaryCurrency: 'EUR',
            exchangeRate: 10.8,
            period: 'monthly',
            status: 'single',
            children: 0,
            isCadre: false
        };

        // --- DOM ELEMENTS ---
        const els = {
            inputMad: document.getElementById('input-mad'),
            inputEur: document.getElementById('input-eur'),
            inputRate: document.getElementById('exchange-rate'),
            btnMonthly: document.getElementById('period-monthly'),
            btnAnnual: document.getElementById('period-annual'),

            btnSingle: document.getElementById('status-single'),
            btnMarried: document.getElementById('status-married'),
            btnDivorced: document.getElementById('status-divorced'),

            btnChildMinus: document.getElementById('child-minus'),
            btnChildPlus: document.getElementById('child-plus'),
            displayChildren: document.getElementById('children-display'),

            toggleCadre: document.getElementById('toggle-cadre'),

            maNet: document.getElementById('ma-net'),
            maNetEur: document.getElementById('ma-net-eur'),
            maRate: document.getElementById('ma-rate'),
            maTable: document.getElementById('ma-table-body'),
            barMaNet: document.getElementById('bar-ma-net'),
            barMaTax: document.getElementById('bar-ma-tax'),
            barMaSoc: document.getElementById('bar-ma-soc'),

            frNet: document.getElementById('fr-net'),
            frNetMad: document.getElementById('fr-net-mad'),
            frRate: document.getElementById('fr-rate'),
            frTable: document.getElementById('fr-table-body'),
            barFrNet: document.getElementById('bar-fr-net'),
            barFrTax: document.getElementById('bar-fr-tax'),
            barFrSoc: document.getElementById('bar-fr-soc'),

            verdictTitle: document.getElementById('verdict-title'),
            verdictText: document.getElementById('verdict-text'),
            verdictDiff: document.getElementById('verdict-diff'),
            verdictDiffEur: document.getElementById('verdict-diff-eur'),
        };

        // --- FORMATTERS ---
        const formatNumber = (num) => {
            return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        const formatMoney = (amount, currency) => {
            const formatted = formatNumber(amount);
            if (currency === 'MAD') return formatted + ' MAD';
            if (currency === 'EUR') return formatted + ' ‚Ç¨';
            return formatted + ' ' + currency;
        };
        const formatPct = (val) => (val * 100).toFixed(1) + '%';

        const formatInputValue = (value) => {
            const num = value.toString().replace(/\s/g, '').replace(/[^\d]/g, '');
            if (!num) return '';
            return num.replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        const parseInputValue = (value) => {
            return parseFloat(value.replace(/\s/g, '')) || 0;
        };

        function toggleTranches(country) {
            const rows = document.querySelectorAll(`.${country}-tranches-row`);
            const arrow = document.getElementById(`${country}-tranches-arrow`);
            const isHidden = rows[0]?.classList.contains('hidden');

            rows.forEach(row => {
                if (isHidden) {
                    row.classList.remove('hidden');
                } else {
                    row.classList.add('hidden');
                }
            });

            if (arrow) {
                arrow.textContent = isHidden ? '‚ñº' : '‚ñ∂';
            }
        }

        // --- LOGIC ---

        function calculateFrance() {
            let annualGrossEur = state.salaryInput;
            if (state.salaryCurrency === 'MAD') annualGrossEur /= state.exchangeRate;
            if (state.period === 'monthly') annualGrossEur *= 12;

            if (annualGrossEur === 0) return null;

            const cotisRate = state.isCadre ? TAX_CONFIG.fr.cotis_rate_cadre : TAX_CONFIG.fr.cotis_rate_noncadre;
            const socialContrib = annualGrossEur * cotisRate;

            const netImposable = (annualGrossEur - socialContrib) * 0.90;

            let parts = state.status === 'married' ? 2 : 1;

            if (state.children > 0) {
                if (state.children === 1) parts += 0.5;
                else if (state.children === 2) parts += 1.0;
                else parts += 1.0 + (state.children - 2);
            }

            const incomePerPart = netImposable / parts;
            let taxPerPart = 0;
            let previousLimit = 0;
            const bracketsDetail = [];

            for (let i = 0; i < TAX_CONFIG.fr.brackets.length; i++) {
                const bracket = TAX_CONFIG.fr.brackets[i];
                const prevLimit = i === 0 ? 0 : TAX_CONFIG.fr.brackets[i-1].limit;

                if (incomePerPart > prevLimit) {
                    const taxableInBracket = Math.min(incomePerPart, bracket.limit) - prevLimit;
                    const taxInBracket = taxableInBracket * bracket.rate;
                    taxPerPart += taxInBracket;

                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: taxableInBracket,
                        rate: bracket.rate,
                        tax: taxInBracket
                    });
                } else {
                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: 0,
                        rate: bracket.rate,
                        tax: 0
                    });
                }
                previousLimit = bracket.limit;
            }

            const totalTax = taxPerPart * parts;
            const netInPocket = annualGrossEur - socialContrib - totalTax;

            return {
                gross: annualGrossEur,
                social: socialContrib,
                tax: totalTax,
                taxPerPart: taxPerPart,
                parts: parts,
                netImposable: netImposable,
                incomePerPart: incomePerPart,
                bracketsDetail: bracketsDetail,
                net: netInPocket,
                rate: (socialContrib + totalTax) / annualGrossEur
            };
        }

        function calculateMorocco() {
            let annualGrossMad = state.salaryInput;
            if (state.salaryCurrency === 'EUR') annualGrossMad *= state.exchangeRate;
            if (state.period === 'monthly') annualGrossMad *= 12;

            if (annualGrossMad === 0) return null;

            const cnssBase = Math.min(annualGrossMad, 72000);
            const cnss = cnssBase * TAX_CONFIG.ma.cnss_rate;
            const amo = annualGrossMad * TAX_CONFIG.ma.amo_rate;
            const socialContrib = cnss + amo;

            const grossLessSocial = annualGrossMad - socialContrib;
            const proDeduction = Math.min(grossLessSocial * 0.20, 30000);
            const netImposable = grossLessSocial - proDeduction;

            let tax = 0;
            let taxPerPart = 0;
            let previousLimit = 0;
            const bracketsDetail = [];

            for (let i = 0; i < TAX_CONFIG.ma.brackets.length; i++) {
                const bracket = TAX_CONFIG.ma.brackets[i];
                const prevLimit = i === 0 ? 0 : TAX_CONFIG.ma.brackets[i-1].limit;

                if (netImposable > prevLimit) {
                    const taxableInBracket = Math.min(netImposable, bracket.limit) - prevLimit;
                    const taxInBracket = taxableInBracket * bracket.rate;
                    taxPerPart += taxInBracket;

                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: taxableInBracket,
                        rate: bracket.rate,
                        tax: taxInBracket
                    });
                } else {
                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: 0,
                        rate: bracket.rate,
                        tax: 0
                    });
                }
                previousLimit = bracket.limit;
            }

            tax = taxPerPart;
            if(tax < 0) tax = 0;

            const spouseCount = state.status === 'married' ? 1 : 0;
            const dependants = spouseCount + state.children;
            const familyReduc = Math.min(dependants * TAX_CONFIG.ma.family_deduction, TAX_CONFIG.ma.family_deduction_cap);
            const taxBeforeReduc = tax;
            tax = Math.max(0, tax - familyReduc);

            const netInPocket = annualGrossMad - socialContrib - tax;

            return {
                gross: annualGrossMad,
                social: socialContrib,
                tax: tax,
                taxBeforeReduc: taxBeforeReduc,
                familyReduc: familyReduc,
                dependants: dependants,
                net: netInPocket,
                rate: (socialContrib + tax) / annualGrossMad,
                netImposable: netImposable,
                bracketsDetail: bracketsDetail
            };
        }

        // --- UI UPDATER ---

        function render() {
            const frData = calculateFrance();
            const maData = calculateMorocco();

            if (!frData || !maData) {
                els.verdictDiff.textContent = "--";
                els.verdictDiffEur.textContent = "";
                return;
            }

            const maMultiplier = state.period === 'monthly' ? 1/12 : 1;

            els.maNet.innerHTML = `${formatNumber(maData.net * maMultiplier)} <span class="text-sm font-normal text-slate-400">MAD</span>`;
            els.maNetEur.textContent = `‚âà ${formatMoney((maData.net * maMultiplier) / state.exchangeRate, 'EUR')}`;
            els.maRate.textContent = formatPct(maData.rate);

            const maTotal = maData.gross;
            els.barMaNet.style.width = (maData.net / maTotal * 100) + '%';
            els.barMaTax.style.width = (maData.tax / maTotal * 100) + '%';
            els.barMaSoc.style.width = (maData.social / maTotal * 100) + '%';

            const familyReducRow = maData.familyReduc > 0
                ? `<tr class="text-emerald-600"><td class="px-4 py-2 pl-6 text-xs">Family deduction (${maData.dependants} pers.)</td><td class="px-4 py-2 text-right text-xs" colspan="2">+${formatMoney(maData.familyReduc * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>`
                : '';

            let maBracketsHtml = '';
            maData.bracketsDetail.forEach((b, i) => {
                if (b.amount > 0) {
                    const toLabel = b.to === Infinity ? '+' : formatMoney(b.to, 'MAD');
                    maBracketsHtml += `<tr class="text-slate-900 text-[10px]">
                        <td class="px-4 py-1">${formatMoney(b.from, 'MAD')} ‚Üí ${toLabel}</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.amount, 'MAD')}</td>
                        <td class="px-4 py-1 text-right">${(b.rate * 100).toFixed(0)}%</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.tax, 'MAD')}</td>
                    </tr>`;
                }
            });

            els.maTable.innerHTML = `
                <tr><td class="px-4 py-2 font-medium">Gross Salary</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(maData.gross * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-slate-400">100%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Social (CNSS/AMO)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(maData.social * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(maData.social/maData.gross)}</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Taxable income</td><td class="px-4 py-2 text-right text-xs" colspan="2">${formatMoney(maData.netImposable * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Income Tax (IR)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(maData.tax * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(maData.tax/maData.gross)}</td></tr>
                ${familyReducRow}
                <tr class="bg-emerald-50/50 font-semibold text-emerald-900"><td class="px-4 py-2">Net Salary</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(maData.net * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-emerald-600">${formatPct(maData.net/maData.gross)}</td></tr>
                <tr class="bg-emerald-50 cursor-pointer hover:bg-emerald-100 transition-colors border-t border-emerald-200" onclick="toggleTranches('ma')">
                    <td colspan="4" class="px-4 py-2.5">
                        <span class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2">
                            <span class="flex items-center gap-2 text-[11px] font-semibold text-emerald-700">
                                <span id="ma-tranches-arrow" class="text-emerald-500 transition-transform">‚ñ∂</span>
                                Applied IR brackets
                            </span>
                            <span class="text-[10px] text-emerald-600 bg-emerald-100 px-2 py-0.5 rounded-full w-fit">Click to view</span>
                        </span>
                    </td>
                </tr>
                <tr class="bg-slate-50 text-[10px] text-slate-500 font-medium ma-tranches-row hidden">
                    <td class="px-4 py-1">Bracket</td>
                    <td class="px-4 py-1 text-right">Amount</td>
                    <td class="px-4 py-1 text-right">Rate</td>
                    <td class="px-4 py-1 text-right">Tax</td>
                </tr>
                ${maBracketsHtml.replace(/class="text-slate-900 text-\[10px\]"/g, 'class="text-slate-900 text-[10px] ma-tranches-row hidden"')}
            `;

            els.frNet.innerHTML = `${formatNumber(frData.net * maMultiplier)} <span class="text-sm font-normal text-slate-400">‚Ç¨</span>`;
            els.frNetMad.textContent = `‚âà ${formatMoney((frData.net * maMultiplier) * state.exchangeRate, 'MAD')}`;
            els.frRate.textContent = formatPct(frData.rate);

            const frTotal = frData.gross;
            els.barFrNet.style.width = (frData.net / frTotal * 100) + '%';
            els.barFrTax.style.width = (frData.tax / frTotal * 100) + '%';
            els.barFrSoc.style.width = (frData.social / frTotal * 100) + '%';

            const netAvantAbattement = (frData.gross - frData.social) * maMultiplier;
            const abattement10 = netAvantAbattement * 0.10;

            let frBracketsHtml = '';
            frData.bracketsDetail.forEach((b, i) => {
                if (b.amount > 0) {
                    const toLabel = b.to === Infinity ? '+' : formatMoney(b.to, 'EUR');
                    frBracketsHtml += `<tr class="text-slate-900 text-[10px]">
                        <td class="px-4 py-1">${formatMoney(b.from, 'EUR')} ‚Üí ${toLabel}</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.amount, 'EUR')}</td>
                        <td class="px-4 py-1 text-right">${(b.rate * 100).toFixed(0)}%</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.tax, 'EUR')}</td>
                    </tr>`;
                }
            });

            els.frTable.innerHTML = `
                <tr><td class="px-4 py-2 font-medium">Gross Salary</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(frData.gross * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-slate-400">100%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Social Charges (Est.)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(frData.social * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(frData.social/frData.gross)}</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">10% Deduction</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(abattement10, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">10%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Taxable income</td><td class="px-4 py-2 text-right text-xs" colspan="2">${formatMoney(frData.netImposable * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Income Tax (IR)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(frData.tax * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(frData.tax/frData.gross)}</td></tr>
                <tr class="bg-indigo-50/50 font-semibold text-indigo-900"><td class="px-4 py-2">Net Salary</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(frData.net * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-indigo-600">${formatPct(frData.net/frData.gross)}</td></tr>
                <tr class="bg-indigo-50 cursor-pointer hover:bg-indigo-100 transition-colors border-t border-indigo-200" onclick="toggleTranches('fr')">
                    <td colspan="4" class="px-4 py-2.5">
                        <span class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2">
                            <span class="flex items-center gap-2 text-[11px] font-semibold text-indigo-700">
                                <span id="fr-tranches-arrow" class="text-indigo-500 transition-transform">‚ñ∂</span>
                                Applied IR brackets (${frData.parts} share${frData.parts > 1 ? 's' : ''})
                            </span>
                            <span class="text-[10px] text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded-full w-fit">Click to view</span>
                        </span>
                    </td>
                </tr>
                <tr class="bg-slate-50 text-[10px] text-slate-500 font-medium fr-tranches-row hidden">
                    <td class="px-4 py-1">Bracket</td>
                    <td class="px-4 py-1 text-right">Amount</td>
                    <td class="px-4 py-1 text-right">Rate</td>
                    <td class="px-4 py-1 text-right">Tax</td>
                </tr>
                ${frBracketsHtml.replace(/class="text-slate-900 text-\[10px\]"/g, 'class="text-slate-900 text-[10px] fr-tranches-row hidden"')}
                <tr class="text-slate-900 text-[10px] border-t border-slate-200 font-semibold fr-tranches-row hidden">
                    <td class="px-4 py-1">Total (${frData.parts} share${frData.parts > 1 ? 's' : ''})</td>
                    <td class="px-4 py-1 text-right" colspan="2"></td>
                    <td class="px-4 py-1 text-right">${formatMoney(frData.tax, 'EUR')}</td>
                </tr>
            `;

            const frNetInMad = frData.net * state.exchangeRate;
            const maNetInMad = maData.net;
            const diffAnnualMad = Math.abs(frNetInMad - maNetInMad);
            const diffAnnualEur = diffAnnualMad / state.exchangeRate;

            const winner = frNetInMad > maNetInMad ? 'France' : 'Morocco';

            els.verdictDiff.textContent = formatMoney(diffAnnualEur, 'EUR');
            els.verdictDiffEur.textContent = formatMoney(diffAnnualMad, 'MAD');

            const diffPct = Math.abs(frData.rate - maData.rate) * 100;

            if(winner === 'Morocco') {
                els.verdictTitle.innerHTML = `<span class="text-2xl mr-2">üá≤üá¶</span> Morocco Wins!`;
                els.verdictTitle.className = "font-semibold text-xl tracking-tight text-emerald-400 flex items-center";
                els.verdictText.innerHTML = `
                    <div class="flex items-center gap-4 mt-2">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-emerald-500/20 rounded-lg">
                            <span>üá≤üá¶</span>
                            <span class="font-bold text-emerald-400">${formatPct(maData.rate)}</span>
                        </div>
                        <span class="text-slate-500">vs</span>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 rounded-lg">
                            <span>üá´üá∑</span>
                            <span class="text-slate-300">${formatPct(frData.rate)}</span>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mt-2">You save <span class="text-emerald-400 font-semibold">${diffPct.toFixed(1)} points</span> of tax burden</p>
                `;
            } else {
                els.verdictTitle.innerHTML = `<span class="text-2xl mr-2">üá´üá∑</span> France Wins!`;
                els.verdictTitle.className = "font-semibold text-xl tracking-tight text-indigo-400 flex items-center";
                els.verdictText.innerHTML = `
                    <div class="flex items-center gap-4 mt-2">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-indigo-500/20 rounded-lg">
                            <span>üá´üá∑</span>
                            <span class="font-bold text-indigo-400">${formatPct(frData.rate)}</span>
                        </div>
                        <span class="text-slate-500">vs</span>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 rounded-lg">
                            <span>üá≤üá¶</span>
                            <span class="text-slate-300">${formatPct(maData.rate)}</span>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mt-2">You save <span class="text-indigo-400 font-semibold">${diffPct.toFixed(1)} points</span> of tax burden</p>
                `;
            }
        }

        // --- EVENT LISTENERS ---

        els.inputMad.addEventListener('input', (e) => {
            const cursorPos = e.target.selectionStart;
            const oldLen = e.target.value.length;

            if(!e.target.value.replace(/\s/g, '')) {
                state.salaryInput = 0;
                e.target.value = '';
                els.inputEur.value = '';
                render();
                return;
            }

            const val = parseInputValue(e.target.value);
            state.salaryInput = val;
            state.salaryCurrency = 'MAD';

            e.target.value = formatInputValue(e.target.value);
            els.inputEur.value = formatInputValue(Math.round(val / state.exchangeRate));

            const newLen = e.target.value.length;
            const newPos = cursorPos + (newLen - oldLen);
            e.target.setSelectionRange(newPos, newPos);

            render();
        });

        els.inputEur.addEventListener('input', (e) => {
            const cursorPos = e.target.selectionStart;
            const oldLen = e.target.value.length;

            if(!e.target.value.replace(/\s/g, '')) {
                state.salaryInput = 0;
                e.target.value = '';
                els.inputMad.value = '';
                render();
                return;
            }

            const val = parseInputValue(e.target.value);
            state.salaryInput = val;
            state.salaryCurrency = 'EUR';

            e.target.value = formatInputValue(e.target.value);
            els.inputMad.value = formatInputValue(Math.round(val * state.exchangeRate));

            const newLen = e.target.value.length;
            const newPos = cursorPos + (newLen - oldLen);
            e.target.setSelectionRange(newPos, newPos);

            render();
        });

        els.inputRate.addEventListener('change', (e) => {
            state.exchangeRate = parseFloat(e.target.value) || 10.8;
            render();
        });

        const setPeriod = (p) => {
            state.period = p;
            if(p === 'monthly') {
                els.btnMonthly.className = "px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300";
                els.btnAnnual.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";
            } else {
                els.btnAnnual.className = "px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300";
                els.btnMonthly.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";
            }
            render();
        };
        els.btnMonthly.addEventListener('click', () => setPeriod('monthly'));
        els.btnAnnual.addEventListener('click', () => setPeriod('annual'));

        const setStatus = (status) => {
            state.status = status;

            const activeClass = "flex-1 py-1.5 text-[11px] font-medium rounded-md bg-white shadow-sm text-slate-900 border border-slate-100 transition-all-300";
            const inactiveClass = "flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";

            els.btnSingle.className = status === 'single' ? activeClass : inactiveClass;
            els.btnMarried.className = status === 'married' ? activeClass : inactiveClass;
            els.btnDivorced.className = status === 'divorced' ? activeClass : inactiveClass;

            render();
        };
        els.btnSingle.addEventListener('click', () => setStatus('single'));
        els.btnMarried.addEventListener('click', () => setStatus('married'));
        els.btnDivorced.addEventListener('click', () => setStatus('divorced'));

        const updateChildren = (val) => {
            if (val < 0) val = 0;
            if (val > 10) val = 10;
            state.children = val;
            els.displayChildren.textContent = state.children;
            render();
        };
        els.btnChildMinus.addEventListener('click', () => updateChildren(state.children - 1));
        els.btnChildPlus.addEventListener('click', () => updateChildren(state.children + 1));

        els.toggleCadre.addEventListener('click', () => {
            state.isCadre = !state.isCadre;
            const dot = els.toggleCadre.querySelector('span');
            if(state.isCadre) {
                els.toggleCadre.classList.replace('bg-slate-200', 'bg-indigo-500');
                dot.classList.add('translate-x-3');
                dot.classList.remove('translate-x-0.5');
            } else {
                els.toggleCadre.classList.replace('bg-indigo-500', 'bg-slate-200');
                dot.classList.remove('translate-x-3');
                dot.classList.add('translate-x-0.5');
            }
            render();
        });

        async function fetchExchangeRate() {
            const rateStatus = document.getElementById('rate-status');
            try {
                const response = await fetch('https://api.frankfurter.app/latest?from=EUR&to=MAD');
                const data = await response.json();
                if (data.rates && data.rates.MAD) {
                    const rate = data.rates.MAD;
                    els.inputRate.value = rate.toFixed(2);
                    state.exchangeRate = rate;
                    rateStatus.textContent = '‚úì';
                    rateStatus.className = 'text-[10px] text-emerald-500';
                    render();
                }
            } catch (error) {
                rateStatus.textContent = '(default)';
                rateStatus.className = 'text-[10px] text-slate-400';
            }
        }

        // Init
        fetchExchangeRate();
        setPeriod('annual');
        els.inputEur.value = '100 000';
        els.inputEur.dispatchEvent(new Event('input'));

    </script>

</body>
</html>
