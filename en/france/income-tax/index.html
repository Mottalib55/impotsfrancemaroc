<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Analytics (chargÃ© aprÃ¨s interaction pour performance) -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        function loadGA() {
            if (window.gaLoaded) return;
            window.gaLoaded = true;

            var script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z328SB8DZ8';
            script.async = true;
            document.head.appendChild(script);

            gtag('js', new Date());
            gtag('config', 'G-Z328SB8DZ8');
        }

        // Charger GA aprÃ¨s interaction utilisateur ou aprÃ¨s 3s
        ['scroll', 'click', 'touchstart', 'keydown'].forEach(function(evt) {
            window.addEventListener(evt, loadGA, {once: true, passive: true});
        });
        setTimeout(loadGA, 3000);
    </script>

    <!-- Language Router (must be early for redirect) -->
    <script defer src="/assets/js/lang-router.js"></script>

    <script>
    </script>

    <!-- SEO Primary -->
    <title>Income Tax Calculator France 2026 | Fast & Accurate</title>
    <meta name="description" content="Calculate your income tax and possible deductions: retirement savings (PER), childcare, donations, home services, tuition fees. Free & instant simulation.">
    <meta name="keywords" content="income tax simulator, france tax 2026, tax calculator france, tax brackets, family quotient, PER retirement">

    <!-- Canonical & Hreflang -->
    <link rel="canonical" href="https://netsalaire.com/en/france/income-tax/">
    <link rel="alternate" hreflang="fr" href="https://netsalaire.com/fr/france/simulateur-impot-revenu/">
    <link rel="alternate" hreflang="en" href="https://netsalaire.com/en/france/income-tax/">
    <link rel="alternate" hreflang="x-default" href="https://netsalaire.com/fr/france/simulateur-impot-revenu/">

    <!-- Open Graph -->
    <meta property="og:title" content="France Income Tax Simulator 2026 â€” Calculate Your Tax | NetSalaire">
    <meta property="og:description" content="Calculate your French income tax 2026 for free. Family quotient, tax brackets, PER retirement savings.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://netsalaire.com/en/france/income-tax/">
    <meta property="og:image" content="https://netsalaire.com/assets/images/og-france-ir.png">
    <meta property="og:site_name" content="NetSalaire">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="fr_FR">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="France Income Tax Simulator 2026 â€” Calculate Your Tax">
    <meta name="twitter:description" content="Calculate your French income tax 2026. Family quotient, tax brackets, PER simulation.">
    <meta name="twitter:image" content="https://netsalaire.com/assets/images/og-france-ir.png">

    <!-- Additional SEO -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="NetSalaire">

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "France Income Tax Simulator 2026",
        "description": "Calculate your French income tax with family quotient, tax brackets and PER retirement savings simulation. Official 2026 rates.",
        "url": "https://netsalaire.com/en/france/income-tax/",
        "inLanguage": "en",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "EUR"
        },
        "publisher": {
            "@type": "Organization",
            "name": "NetSalaire",
            "url": "https://netsalaire.com"
        }
    }
    </script>

    <link rel="icon" type="image/png" sizes="48x48" href="/assets/images/favicon-48.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicon-192.png">
    <link rel="apple-touch-icon" href="/assets/images/favicon-192.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <link href="/assets/css/tailwind.min.css" rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Iconify for flags -->
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>

    <!-- Navigation CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            900: '#0c4a6e',
                        },
                        emerald: {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            500: '#10b981',
                            600: '#059669',
                            700: '#047857',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Range slider */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px; width: 20px;
            border-radius: 50%;
            background: #ffffff;
            border: 2px solid #0ea5e9;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            margin-top: -8px;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px;
            cursor: pointer;
            background: linear-gradient(to right, #0ea5e9 0%, #0ea5e9 var(--progress, 0%), #e2e8f0 var(--progress, 0%), #e2e8f0 100%);
            border-radius: 9999px;
        }

        /* Animations */
        .animate-in { animation: fadeSlideIn 0.3s ease-out; }
        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chart-transition { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }

        /* Hide number spinners */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* Tooltip */
        .tooltip { position: relative; }
        .tooltip:hover::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 50;
            margin-bottom: 6px;
        }

        /* Mobile sticky */
        @media (max-width: 1023px) {
            .mobile-sticky-btn {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 40;
            }
        }

        /* Hide details marker */
        details summary { list-style: none; }
        details summary::-webkit-details-marker { display: none; }

        /* Custom slider thumb styling */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            background: #e2e8f0;
            border-radius: 8px;
            height: 8px;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-600 antialiased selection:bg-indigo-100">

    <!-- Navbar -->
    <nav class="fixed top-0 w-full z-50 border-b border-slate-200 bg-white/80 backdrop-blur-md">
        <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
            <a href="/en/" class="flex items-center gap-2 group">
                <div class="w-8 h-8 bg-slate-900 rounded flex items-center justify-center text-white font-semibold tracking-tighter shadow-md group-hover:bg-indigo-600 transition-colors duration-300">
                    N.
                </div>
                <span class="font-semibold tracking-tight text-slate-900">NetSalaire</span>
            </a>
            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-slate-600">
                <!-- France Dropdown -->
                <div class="relative group">
                    <a href="/en/#france" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="circle-flags:fr" width="16"></iconify-icon> France
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400 group-hover:text-slate-600 transition-transform group-hover:rotate-180"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[220px]">
                            <a href="/en/france/income-tax/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:landmark" width="18" class="text-indigo-500"></iconify-icon>
                                Tax Simulator
                            </a>
                            <a href="/en/france/gross-to-net/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:calculator" width="18" class="text-indigo-500"></iconify-icon>
                                Gross to Net
                            </a>
                            <a href="/en/france/tax-guide/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:book-open" width="18" class="text-indigo-500"></iconify-icon>
                                Tax Guide
                            </a>
                            <div class="border-t border-slate-100 my-2"></div>
                            <a href="/en/france/unemployment-calculator/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span class="w-[18px] text-center">ğŸ“‰</span> Unemployment
                            </a>
                            <a href="/en/france/severance-calculator/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span class="w-[18px] text-center">ğŸ“‹</span> Severance
                            </a>
                            <a href="/en/france/housing-benefit-calculator/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span class="w-[18px] text-center">ğŸ </span> Housing Aid
                            </a>
                            <a href="/en/france/daycare-calculator/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span class="w-[18px] text-center">ğŸ‘¶</span> Daycare
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Morocco Dropdown -->
                <div class="relative group">
                    <a href="/en/#morocco" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="circle-flags:ma" width="16"></iconify-icon> Morocco
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400 group-hover:text-slate-600 transition-transform group-hover:rotate-180"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[220px]">
                            <a href="/en/morocco/income-tax/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:landmark" width="18" class="text-emerald-500"></iconify-icon>
                                Tax Simulator
                            </a>
                            <a href="/en/morocco/gross-to-net/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:calculator" width="18" class="text-emerald-500"></iconify-icon>
                                Gross to Net
                            </a>
                            <a href="/en/morocco/tax-guide/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors">
                                <iconify-icon icon="lucide:book-open" width="18" class="text-emerald-500"></iconify-icon>
                                Tax Guide
                            </a>
                        </div>
                    </div>
                </div>
                <!-- All Countries Dropdown -->
                <div class="relative group">
                    <a href="/en/global-comparison/" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="lucide:globe" width="16"></iconify-icon> All Countries
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400 group-hover:text-slate-600 transition-transform group-hover:rotate-180"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[200px] " style="max-height: 250px; overflow-y: scroll;">
                            <a href="/en/france/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm"><span>ğŸ‡«ğŸ‡·</span> France</a>
                            <a href="/en/morocco/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm"><span>ğŸ‡²ğŸ‡¦</span> Morocco</a>
                            <div class="border-t border-slate-100 my-1"></div>
                            <a href="/en/france/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm"><span>ğŸ‡«ğŸ‡·</span> France</a>
                            <a href="/en/morocco/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm"><span>ğŸ‡²ğŸ‡¦</span> Morocco</a>
                            <div class="border-t border-slate-100 my-1"></div>
                            <a href="/en/usa/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡ºğŸ‡¸</span> USA (New York)
                            </a>
                            <a href="/en/uk/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¬ğŸ‡§</span> United Kingdom
                            </a>
                            <a href="/en/switzerland/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¨ğŸ‡­</span> Switzerland (Geneva)
                            </a>
                            <a href="/en/dubai/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¦ğŸ‡ª</span> Dubai (0% tax)
                            </a>
                            <a href="/en/singapore/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¸ğŸ‡¬</span> Singapore
                            </a>
                            <a href="/en/luxembourg/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡±ğŸ‡º</span> Luxembourg
                            </a>
                            <a href="/en/saudi-arabia/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¸ğŸ‡¦</span> Saudi Arabia
                            </a>
                            <a href="/en/spain/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡ªğŸ‡¸</span> Spain
                            </a>
                            <a href="/en/japan/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¯ğŸ‡µ</span> Japan
                            </a>
                            <a href="/en/china/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¨ğŸ‡³</span> China (Shanghai)
                            </a>
                            <a href="/en/india/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡®ğŸ‡³</span> India
                            </a>
                            <a href="/en/pakistan/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡µğŸ‡°</span> Pakistan
                            </a>
                            <a href="/en/mexico/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡²ğŸ‡½</span> Mexico
                            </a>
                            <a href="/en/brazil/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡§ğŸ‡·</span> Brazil
                            </a>
                            <a href="/en/germany/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡©ğŸ‡ª</span> Germany
                            </a>
                            <a href="/en/canada/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¨ğŸ‡¦</span> Canada
                            </a>
                            <a href="/en/australia/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¦ğŸ‡º</span> Australia
                            </a>
                            <a href="/en/italy/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡®ğŸ‡¹</span> Italy
                            </a>
                            <a href="/en/netherlands/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡³ğŸ‡±</span> Netherlands
                            </a>
                            <a href="/en/south-korea/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡°ğŸ‡·</span> South Korea
                            </a>
                            <a href="/en/belgium/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡§ğŸ‡ª</span> Belgium
                            </a>
                            <a href="/en/sweden/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¸ğŸ‡ª</span> Sweden
                            </a>
                            <a href="/en/ireland/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡®ğŸ‡ª</span> Ireland
                            </a>
                            <a href="/en/norway/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡³ğŸ‡´</span> Norway
                            </a>
                            <a href="/en/austria/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¦ğŸ‡¹</span> Austria
                            </a>
                            <a href="/en/denmark/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡©ğŸ‡°</span> Denmark
                            </a>
                            <a href="/en/portugal/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡µğŸ‡¹</span> Portugal
                            </a>
                            <a href="/en/hong-kong/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡­ğŸ‡°</span> Hong Kong
                            </a>                            </a>
                            <a href="/en/greece/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¬ğŸ‡·</span> Greece
                            </a>
                            <a href="/en/finland/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡«ğŸ‡®</span> Finland
                            </a>
                            <a href="/en/czech-republic/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¨ğŸ‡¿</span> Czech Republic
                            </a>
                            <a href="/en/turkey/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¹ğŸ‡·</span> Turkey
                            </a>
                            <a href="/en/romania/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡·ğŸ‡´</span> Romania
                            </a>
                            <a href="/en/hungary/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡­ğŸ‡º</span> Hungary
                            </a>
                            <a href="/en/croatia/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡­ğŸ‡·</span> Croatia
                            </a>
                            <a href="/en/new-zealand/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡³ğŸ‡¿</span> New Zealand
                            </a>
                            <a href="/en/malaysia/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡²ğŸ‡¾</span> Malaysia
                            </a>
                            <a href="/en/thailand/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¹ğŸ‡­</span> Thailand
                            </a>
                            <a href="/en/vietnam/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡»ğŸ‡³</span> Vietnam
                            </a>
                            <a href="/en/indonesia/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡®ğŸ‡©</span> Indonesia
                            </a>
                            <a href="/en/philippines/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡µğŸ‡­</span> Philippines
                            </a>
                            <a href="/en/argentina/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¦ğŸ‡·</span> Argentina
                            </a>
                            <a href="/en/chile/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¨ğŸ‡±</span> Chile
                            </a>
                            <a href="/en/colombia/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¨ğŸ‡´</span> Colombia
                            </a>
                            <a href="/en/peru/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡µğŸ‡ª</span> Peru
                            </a>
                            <a href="/en/qatar/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¶ğŸ‡¦</span> Qatar (0% tax)
                            </a>
                            <a href="/en/kuwait/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡°ğŸ‡¼</span> Kuwait (0% tax)
                            </a>
                            <a href="/en/egypt/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡ªğŸ‡¬</span> Egypt
                            </a>
                            <a href="/en/south-africa/income-tax/" class="flex items-center gap-3 px-4 py-2 text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors text-sm">
                                <span>ğŸ‡¿ğŸ‡¦</span> South Africa
                            <div class="border-t border-slate-100 my-2"></div>
                            <a href="/en/global-comparison/" class="flex items-center gap-3 px-4 py-2 text-indigo-600 hover:bg-indigo-50 hover:text-indigo-700 transition-colors text-sm font-medium">
                                <iconify-icon icon="lucide:bar-chart-3" width="16"></iconify-icon> Compare all
                            </a>
                        </div>
                    </div>
                </div>
                <a href="/en/france-morocco-comparison/" class="hover:text-slate-900 transition-colors">France vs Morocco</a>
                <a href="/en/faq/" class="hover:text-slate-900 transition-colors">FAQ</a>
            </div>
            <div class="flex items-center gap-3">
                <!-- Language Switcher -->
                <div class="relative">
                    <button onclick="document.getElementById('lang-dropdown-page').classList.toggle('hidden')" class="flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-900 bg-slate-100 hover:bg-slate-200 border border-slate-200 rounded-full transition-all">
                        <span>ğŸ‡¬ğŸ‡§</span>
                        <iconify-icon icon="lucide:chevron-down" width="14"></iconify-icon>
                    </button>
                    <div id="lang-dropdown-page" class="hidden absolute top-full right-0 mt-2 bg-white border border-slate-200 rounded-lg shadow-lg min-w-[140px] py-1 z-50">
                        <a href="/fr/france/simulateur-impot-revenu/" class="w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 transition-colors">
                            <span>ğŸ‡«ğŸ‡·</span> Francais
                        </a>
                        <a href="/en/france/income-tax/" class="w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-700 bg-slate-50 transition-colors">
                            <span>ğŸ‡¬ğŸ‡§</span> English
                        </a>
                    </div>
                </div>
                <!-- Mobile Menu Button -->
                <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="md:hidden p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors">
                    <iconify-icon icon="lucide:menu" width="24"></iconify-icon>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-200">
            <div class="px-6 py-4 space-y-4">
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-900">
                        <iconify-icon icon="circle-flags:fr" width="18"></iconify-icon> France
                    </div>
                    <div class="pl-6 space-y-2">
                        <a href="/en/france/income-tax/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600">
                            <iconify-icon icon="lucide:landmark" width="16" class="text-indigo-500"></iconify-icon> Tax Simulator
                        </a>
                        <a href="/en/france/gross-to-net/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600">
                            <iconify-icon icon="lucide:calculator" width="16" class="text-indigo-500"></iconify-icon> Gross to Net
                        </a>
                    </div>
                </div>
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-900">
                        <iconify-icon icon="circle-flags:ma" width="18"></iconify-icon> Morocco
                    </div>
                    <div class="pl-6 space-y-2">
                        <a href="/en/morocco/income-tax/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600">
                            <iconify-icon icon="lucide:landmark" width="16" class="text-emerald-500"></iconify-icon> Tax Simulator
                        </a>
                        <a href="/en/morocco/gross-to-net/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600">
                            <iconify-icon icon="lucide:calculator" width="16" class="text-emerald-500"></iconify-icon> Gross to Net
                        </a>
                    </div>
                </div>
                <div class="pt-2 border-t border-slate-100 space-y-2">
                    <a href="/en/global-comparison/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900">
                        <iconify-icon icon="lucide:globe" width="16"></iconify-icon> All Countries
                    </a>
                    <a href="/en/france-morocco-comparison/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900">
                        <iconify-icon icon="lucide:scale" width="16"></iconify-icon> France vs Morocco
                    </a>
                    <a href="/en/faq/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900">
                        <iconify-icon icon="lucide:help-circle" width="16"></iconify-icon> FAQ
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow pt-16">
        <!-- Hero Section -->
        <section class="pt-8 pb-6 md:pt-10 md:pb-8 text-center px-4">
            <div class="inline-flex items-center gap-2 rounded-full bg-emerald-50 border border-emerald-200 px-4 py-1.5 mb-6">
                <i data-lucide="sparkles" class="h-4 w-4 text-emerald-600"></i>
                <span class="text-sm font-medium text-emerald-700">2026 Rates - 100% Free - Instant Results</span>
            </div>
            <h1 class="mx-auto max-w-4xl text-3xl font-bold tracking-tight text-slate-900 sm:text-5xl lg:text-6xl">
                ğŸ‡«ğŸ‡· <span class="text-indigo-600">Income Tax Calculator</span> France 2026
            </h1>
            <p class="mx-auto mt-6 max-w-2xl text-lg text-slate-500">
                Free and instant tax simulation. Calculate your income tax and discover how much you can save with <strong class="text-slate-700">PER retirement savings</strong> and <strong class="text-slate-700">donations</strong>.
            </p>
        </section>

        <!-- Simulator Container -->
        <div id="simulateur" class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-20">
            <div class="grid grid-cols-1 gap-5 lg:grid-cols-12 items-start">

                <!-- Card: Situation -->
                <div class="order-1 lg:col-span-7 rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-indigo-50 rounded-lg text-indigo-600">
                                <i data-lucide="users" class="h-5 w-5"></i>
                            </div>
                            <h2 class="text-lg font-semibold text-slate-900">Your situation</h2>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-slate-400">Tax shares</span>
                            <p class="text-lg font-bold text-indigo-600" id="display-parts">1</p>
                        </div>
                    </div>

                    <!-- Marital Status -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-3">Marital status</label>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3">
                            <button type="button" id="btn-single" class="status-btn rounded-xl border-2 p-2 sm:p-3 text-center transition-all cursor-pointer" style="border-color: #e2e8f0; background-color: white;">
                                <i data-lucide="user" class="h-5 w-5 mx-auto mb-1 text-slate-400"></i>
                                <span class="block text-xs sm:text-sm font-medium text-slate-700">Single</span>
                            </button>
                            <button type="button" id="btn-married" class="status-btn rounded-xl border-2 p-2 sm:p-3 text-center transition-all cursor-pointer" style="border-color: #e2e8f0; background-color: white;">
                                <i data-lucide="heart" class="h-5 w-5 mx-auto mb-1 text-slate-400"></i>
                                <span class="block text-xs sm:text-sm font-medium text-slate-700">Married/PACS</span>
                            </button>
                            <button type="button" id="btn-divorced" class="status-btn rounded-xl border-2 p-2 sm:p-3 text-center transition-all cursor-pointer" style="border-color: #e2e8f0; background-color: white;">
                                <i data-lucide="user-x" class="h-5 w-5 mx-auto mb-1 text-slate-400"></i>
                                <span class="block text-xs sm:text-sm font-medium text-slate-700">Divorced</span>
                            </button>
                        </div>
                        <input type="hidden" id="status-input" value="single">
                    </div>

                    <!-- Children -->
                    <div class="mb-5 flex items-center justify-between">
                        <div>
                            <label class="block text-sm font-medium text-slate-700">Dependent children</label>
                            <p class="text-xs text-slate-400 mt-0.5">Minors or attached to household</p>
                        </div>
                        <div class="flex items-center gap-3 rounded-lg border border-slate-200 bg-slate-50 p-1">
                            <button id="btn-child-minus" type="button" class="h-9 w-9 rounded-md bg-white text-slate-500 shadow-sm hover:text-indigo-600 hover:bg-slate-50 flex items-center justify-center transition-all active:scale-95">
                                <i data-lucide="minus" class="h-4 w-4"></i>
                            </button>
                            <span id="child-count" class="w-8 text-center text-xl font-bold text-slate-900">0</span>
                            <button id="btn-child-plus" type="button" class="h-9 w-9 rounded-md bg-white text-slate-500 shadow-sm hover:text-indigo-600 hover:bg-slate-50 flex items-center justify-center transition-all active:scale-95">
                                <i data-lucide="plus" class="h-4 w-4"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Single Parent -->
                    <div id="parent-isole-container" class="flex items-center justify-between border-t border-slate-100 pt-4">
                        <div class="flex items-center gap-2">
                            <label class="text-sm font-medium text-slate-700">Single parent</label>
                            <span class="tooltip cursor-help" data-tip="You raise your children alone">
                                <i data-lucide="help-circle" class="h-4 w-4 text-slate-400"></i>
                            </span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="parent-isole" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all after:shadow-sm"></div>
                        </label>
                    </div>
                </div>

                <!-- Card: Revenus -->
                <div class="order-2 lg:col-span-7 rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="p-2 bg-indigo-50 rounded-lg text-indigo-600">
                            <i data-lucide="wallet" class="h-5 w-5"></i>
                        </div>
                        <h2 class="text-lg font-semibold text-slate-900">Your annual income</h2>
                    </div>

                    <!-- Main Income -->
                    <div class="mb-5">
                        <label class="text-sm font-medium text-slate-700 mb-3 block">Net taxable income</label>
                        <div class="grid grid-cols-2 gap-3 mb-3">
                            <div>
                                <label class="block text-xs text-slate-500 mb-1">Monthly</label>
                                <div class="relative">
                                    <input type="number" id="income1-monthly" value="3333" min="0" max="100000" class="block w-full text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-indigo-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs">â‚¬</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs text-slate-500 mb-1">Annual</label>
                                <div class="relative">
                                    <input type="number" id="income1-input" value="40000" min="0" max="500000" class="block w-full text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-indigo-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs">â‚¬</span>
                                </div>
                            </div>
                        </div>
                        <input type="range" id="income1-slider" min="0" max="200000" step="500" value="40000"
                               class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600 touch-pan-x"
                               style="-webkit-appearance: none; padding: 8px 0;">
                        <div class="flex justify-between text-xs text-slate-400 mt-1">
                            <span>0â‚¬</span>
                            <span>200kâ‚¬</span>
                        </div>
                    </div>

                    <!-- Toggle 2 incomes -->
                    <div id="two-incomes-toggle" class="hidden mb-5 flex items-center justify-between border-t border-slate-100 pt-4">
                        <div class="flex items-center gap-2">
                            <label class="text-sm font-medium text-slate-700">Two incomes in household</label>
                            <span class="tooltip cursor-help" data-tip="Enable if your spouse also has income">
                                <i data-lucide="help-circle" class="h-4 w-4 text-slate-400"></i>
                            </span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="has-two-incomes" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all after:shadow-sm"></div>
                        </label>
                    </div>

                    <!-- Spouse Income -->
                    <div id="income2-container" class="hidden mb-5 animate-in">
                        <label class="text-sm font-medium text-slate-700 mb-3 block">Net taxable income <span class="text-slate-400 font-normal">(spouse)</span></label>
                        <div class="grid grid-cols-2 gap-3 mb-3">
                            <div>
                                <label class="block text-xs text-slate-500 mb-1">Monthly</label>
                                <div class="relative">
                                    <input type="number" id="income2-monthly" value="0" min="0" max="100000" class="block w-full text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-indigo-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs">â‚¬</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs text-slate-500 mb-1">Annual</label>
                                <div class="relative">
                                    <input type="number" id="income2-input" value="0" min="0" max="500000" class="block w-full text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-indigo-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs">â‚¬</span>
                                </div>
                            </div>
                        </div>
                        <input type="range" id="income2-slider" min="0" max="200000" step="500" value="0"
                               class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600 touch-pan-x"
                               style="-webkit-appearance: none; padding: 8px 0;">
                        <div class="flex justify-between text-xs text-slate-400 mt-1">
                            <span>0â‚¬</span>
                            <span>200kâ‚¬</span>
                        </div>
                    </div>

                    <!-- Other income -->
                    <details class="border-t border-slate-100 pt-4 group">
                        <summary class="flex cursor-pointer items-center justify-between text-sm font-medium text-indigo-600 hover:text-indigo-700">
                            <span class="flex items-center gap-2">
                                <i data-lucide="plus-circle" class="h-4 w-4"></i>
                                Other income (property, etc.)
                            </span>
                            <i data-lucide="chevron-down" class="h-4 w-4 transition-transform group-open:rotate-180"></i>
                        </summary>
                        <div class="mt-4 space-y-4 animate-in">
                            <div>
                                <label class="block text-xs font-medium text-slate-500 mb-2">Net property income</label>
                                <div class="relative">
                                    <input type="number" id="income-foncier" value="0" min="0" class="block w-full rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-indigo-500 text-sm transition-all">
                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs">EUR</span>
                                </div>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- Card: PER -->
                <div class="order-4 lg:col-span-7 rounded-2xl border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-white p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-emerald-100 rounded-lg text-emerald-600">
                                <i data-lucide="piggy-bank" class="h-5 w-5"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-semibold text-slate-900">Retirement Savings Plan (PER)</h2>
                                <p class="text-xs text-slate-500">Deduct your contributions from taxable income</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center rounded-full bg-emerald-100 px-2.5 py-1 text-xs font-medium text-emerald-700">
                            Optimization
                        </span>
                    </div>

                    <!-- Toggle PER -->
                    <div class="flex items-center justify-between mb-5">
                        <label class="text-sm font-medium text-slate-700">Did you contribute to a PER this year?</label>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="has-per" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-200 rounded-full peer peer-checked:bg-emerald-500 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all after:shadow-sm"></div>
                        </label>
                    </div>

                    <!-- PER Details -->
                    <div id="per-details" class="hidden space-y-4 animate-in">
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-slate-700">Amount contributed to PER</label>
                                <div class="relative">
                                    <input type="number" id="per-amount" value="0" min="0" class="block w-36 text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-emerald-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs">EUR</span>
                                </div>
                            </div>
                            <input type="range" id="per-slider" min="0" max="30000" step="100" value="0" class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600 touch-pan-x"
                           style="-webkit-appearance: none; padding: 8px 0;">
                            <div class="flex justify-between mt-1">
                                <span class="text-xs text-slate-400">0 EUR</span>
                                <span class="text-xs text-slate-400">30 000 EUR</span>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="per-plafond-unknown" class="rounded border-slate-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="per-plafond-unknown" class="text-sm text-slate-600">I don't know my deduction ceiling</label>
                        </div>

                        <div id="per-plafond-container">
                            <div class="flex justify-between items-center mb-2">
                                <div class="flex items-center gap-2">
                                    <label class="text-sm font-medium text-slate-700">Available deduction ceiling</label>
                                    <span class="tooltip cursor-help" data-tip="Visible on your last tax notice">
                                        <i data-lucide="help-circle" class="h-4 w-4 text-slate-400"></i>
                                    </span>
                                </div>
                                <div class="relative">
                                    <input type="number" id="per-plafond" value="0" min="0" class="block w-36 text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-emerald-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs">EUR</span>
                                </div>
                            </div>
                        </div>

                        <!-- PER Summary -->
                        <div class="rounded-xl bg-white border border-emerald-200 p-4">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-slate-600">Deduction applied</span>
                                <span class="text-sm font-bold text-emerald-600" id="per-deduction-display">0 EUR</span>
                            </div>
                            <div class="flex justify-between items-center mt-2 pt-2 border-t border-slate-100">
                                <span class="text-sm text-slate-600">Taxable income after PER</span>
                                <span class="text-sm font-bold text-slate-900" id="income-after-per-display">0 EUR</span>
                            </div>
                        </div>

                        <div id="per-warning" class="hidden rounded-lg bg-amber-50 border border-amber-200 p-3 text-sm text-amber-800">
                            <div class="flex gap-2">
                                <i data-lucide="alert-triangle" class="h-4 w-4 text-amber-500 flex-shrink-0 mt-0.5"></i>
                                <span>Ceiling not provided: deduction is estimated at the amount contributed.</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card: Donations -->
                <div class="order-5 lg:col-span-7 rounded-2xl border-2 border-violet-200 bg-gradient-to-br from-violet-50 to-white p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-violet-100 rounded-lg text-violet-600">
                                <i data-lucide="heart-handshake" class="h-5 w-5"></i>
                            </div>
                            <div>
                                <h2 class="text-lg font-semibold text-slate-900">Donations & Tax Credits</h2>
                                <p class="text-xs text-slate-500">Directly reduce your tax (66% to 75%)</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center rounded-full bg-violet-100 px-2.5 py-1 text-xs font-medium text-violet-700">
                            Credit
                        </span>
                    </div>

                    <!-- Toggle Donations -->
                    <div class="flex items-center justify-between mb-5">
                        <label class="text-sm font-medium text-slate-700">Did you make donations this year?</label>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="has-dons" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-200 rounded-full peer peer-checked:bg-violet-500 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all after:shadow-sm"></div>
                        </label>
                    </div>

                    <!-- Donations Details -->
                    <div id="dons-details" class="hidden space-y-4 animate-in">
                        <!-- Donations 66% -->
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <div class="flex items-center gap-2">
                                    <label class="text-sm font-medium text-slate-700">Charity donations (66%)</label>
                                    <span class="tooltip cursor-help" data-tip="Non-profit organizations, foundations...">
                                        <i data-lucide="help-circle" class="h-4 w-4 text-slate-400"></i>
                                    </span>
                                </div>
                                <div class="relative">
                                    <input type="number" id="dons-66" value="0" min="0" class="block w-36 text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-violet-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs">EUR</span>
                                </div>
                            </div>
                            <input type="range" id="dons-66-slider" min="0" max="10000" step="50" value="0" class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600 touch-pan-x"
                           style="-webkit-appearance: none; padding: 8px 0;">
                        </div>

                        <!-- Donations 75% -->
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <div class="flex items-center gap-2">
                                    <label class="text-sm font-medium text-slate-700">Aid organizations (75%)</label>
                                    <span class="tooltip cursor-help" data-tip="Food banks, homeless shelters... (capped at 1000 EUR)">
                                        <i data-lucide="help-circle" class="h-4 w-4 text-slate-400"></i>
                                    </span>
                                </div>
                                <div class="relative">
                                    <input type="number" id="dons-75" value="0" min="0" class="block w-36 text-right rounded-lg border-0 py-2 pl-3 pr-12 text-slate-900 ring-1 ring-slate-200 focus:ring-2 focus:ring-violet-500 text-sm font-semibold transition-all">
                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs">EUR</span>
                                </div>
                            </div>
                            <input type="range" id="dons-75-slider" min="0" max="2000" step="50" value="0" class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600 touch-pan-x"
                           style="-webkit-appearance: none; padding: 8px 0;">
                            <p class="text-xs text-slate-400 mt-1">75% up to 1000 EUR, then 66% beyond</p>
                        </div>

                        <!-- Donations Summary -->
                        <div class="rounded-xl bg-white border border-violet-200 p-4">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-slate-600">Total donations</span>
                                <span class="text-sm font-bold text-slate-900" id="dons-total-display">0 EUR</span>
                            </div>
                            <div class="flex justify-between items-center mt-2 pt-2 border-t border-slate-100">
                                <span class="text-sm text-slate-600">Tax credit</span>
                                <span class="text-sm font-bold text-violet-600" id="dons-reduction-display">0 EUR</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="order-6 lg:col-span-7 flex items-center justify-between pt-2">
                    <button id="btn-reset" type="button" class="text-sm text-slate-500 hover:text-slate-900 flex items-center gap-1.5 transition-colors">
                        <i data-lucide="rotate-ccw" class="h-4 w-4"></i> Reset
                    </button>
                    <span class="text-xs text-slate-400">2026 rates - Updated January 2026</span>
                </div>

                <!-- Results Column -->
                <div class="order-3 lg:col-span-5 lg:row-span-6 lg:row-start-1 lg:col-start-8 relative">
                    <div class="md:sticky lg:top-24 space-y-5">

                        <!-- Main Result Card -->
                        <div class="rounded-2xl bg-gradient-to-br from-slate-900 to-slate-800 text-white p-6 shadow-xl overflow-hidden relative">
                            <div class="absolute top-0 right-0 -mt-8 -mr-8 h-32 w-32 rounded-full bg-indigo-500 opacity-20 blur-2xl"></div>
                            <div class="absolute bottom-0 left-0 -mb-8 -ml-8 h-24 w-24 rounded-full bg-emerald-500 opacity-10 blur-xl"></div>

                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-sm font-medium text-slate-400 uppercase tracking-wider">2026 Tax Estimate</h3>
                                <span class="inline-flex items-center rounded-full bg-white/10 px-2.5 py-1 text-xs font-medium text-white/80">
                                    <i data-lucide="zap" class="h-3 w-3 mr-1"></i> Real-time
                                </span>
                            </div>

                            <div class="flex items-end gap-2 mb-1">
                                <span class="text-5xl font-bold tracking-tight" id="result-tax">0 EUR</span>
                            </div>
                            <p class="text-sm text-slate-400 mb-4">Estimated income tax</p>

                            <div class="h-1.5 w-full bg-slate-700 rounded-full mb-6 overflow-hidden">
                                <div id="tax-progress-bar" class="h-full bg-gradient-to-r from-indigo-400 to-indigo-500 chart-transition rounded-full" style="width: 0%"></div>
                            </div>

                            <div class="grid grid-cols-2 gap-4 border-t border-slate-700/50 pt-4">
                                <div>
                                    <p class="text-xs text-slate-400 mb-1">Average rate</p>
                                    <p class="text-2xl font-bold text-indigo-400" id="result-avg-rate">0%</p>
                                </div>
                                <div>
                                    <p class="text-xs text-slate-400 mb-1">Marginal rate</p>
                                    <p class="text-2xl font-bold text-white" id="result-marginal-rate">0%</p>
                                </div>
                            </div>
                        </div>

                        <!-- Savings Cards -->
                        <div class="space-y-3">
                            <!-- PER Savings -->
                            <div id="per-savings-card" class="hidden rounded-2xl bg-gradient-to-br from-emerald-500 to-emerald-600 text-white p-5 shadow-lg animate-in">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm text-emerald-100 mb-1">Savings from PER</p>
                                        <p class="text-3xl font-bold" id="result-per-savings">0 EUR</p>
                                    </div>
                                    <div class="h-14 w-14 rounded-full bg-white/20 flex items-center justify-center">
                                        <i data-lucide="piggy-bank" class="h-7 w-7"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-emerald-100 mt-3">
                                    Each EUR contributed reduces your tax by <span id="per-efficiency">0</span> cents.
                                </p>
                            </div>

                            <!-- Donations Savings -->
                            <div id="dons-savings-card" class="hidden rounded-2xl bg-gradient-to-br from-violet-500 to-violet-600 text-white p-5 shadow-lg animate-in">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm text-violet-100 mb-1">Credit from donations</p>
                                        <p class="text-3xl font-bold" id="result-dons-savings">0 EUR</p>
                                    </div>
                                    <div class="h-14 w-14 rounded-full bg-white/20 flex items-center justify-center">
                                        <i data-lucide="heart" class="h-7 w-7"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-violet-100 mt-3">
                                    Your donations of <span id="dons-total-result">0 EUR</span> directly reduce your tax.
                                </p>
                            </div>
                        </div>

                        <!-- Net Result Card -->
                        <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                            <h3 class="text-sm font-semibold text-slate-900 mb-4">Your take-home income</h3>

                            <div class="flex items-center gap-6 mb-6">
                                <!-- Donut Chart -->
                                <div class="relative h-28 w-28 flex-shrink-0">
                                    <div id="chart-donut" class="absolute inset-0 rounded-full chart-transition" style="background: conic-gradient(#0ea5e9 0% 10%, #f1f5f9 10% 100%);"></div>
                                    <div class="absolute inset-3 rounded-full bg-white flex items-center justify-center flex-col shadow-inner">
                                        <span class="text-xs text-slate-400">Net</span>
                                        <span id="chart-percent" class="text-lg font-bold text-slate-900">90%</span>
                                    </div>
                                </div>

                                <div class="flex-grow space-y-3">
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center gap-2">
                                            <span class="h-3 w-3 rounded-full bg-slate-200"></span>
                                            <span class="text-sm text-slate-600">Annual net income</span>
                                        </div>
                                        <span class="text-sm font-semibold text-slate-900" id="result-net-annual">0 EUR</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center gap-2">
                                            <span class="h-3 w-3 rounded-full bg-indigo-500"></span>
                                            <span class="text-sm text-slate-600">Tax</span>
                                        </div>
                                        <span class="text-sm font-medium text-slate-500" id="result-tax-small">- 0 EUR</span>
                                    </div>
                                    <div class="pt-2 border-t border-slate-100">
                                        <div class="flex justify-between items-baseline">
                                            <span class="text-sm font-medium text-slate-900">Monthly net</span>
                                            <span class="text-xl font-bold text-indigo-600" id="result-monthly">0 EUR</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Calculation Details -->
                            <details class="group">
                                <summary class="flex cursor-pointer items-center justify-between rounded-lg bg-slate-50 p-3 text-sm font-medium text-slate-700 hover:bg-slate-100 transition-colors">
                                    <span class="flex items-center gap-2">
                                        <i data-lucide="file-text" class="h-4 w-4"></i>
                                        Calculation details
                                    </span>
                                    <i data-lucide="chevron-down" class="h-4 w-4 transition-transform group-open:rotate-180"></i>
                                </summary>
                                <div class="mt-3 px-1 text-sm text-slate-600 space-y-2" id="calc-details">
                                    <div class="flex justify-between py-1.5 border-b border-slate-100">
                                        <span>Household gross income</span>
                                        <span class="font-medium text-slate-900" id="detail-gross">0 EUR</span>
                                    </div>
                                    <div class="flex justify-between py-1.5 border-b border-slate-100">
                                        <span>10% allowance</span>
                                        <span class="font-medium text-slate-900" id="detail-abattement">- 0 EUR</span>
                                    </div>
                                    <div id="detail-per-row" class="hidden flex justify-between py-1.5 border-b border-slate-100">
                                        <span>PER deduction</span>
                                        <span class="font-medium text-emerald-600" id="detail-per">- 0 EUR</span>
                                    </div>
                                    <div class="flex justify-between py-1.5 border-b border-slate-100">
                                        <span>Taxable income</span>
                                        <span class="font-medium text-slate-900" id="detail-taxable">0 EUR</span>
                                    </div>
                                    <div id="detail-dons-row" class="hidden flex justify-between py-1.5 border-b border-slate-100">
                                        <span>Donation credit</span>
                                        <span class="font-medium text-violet-600" id="detail-dons">- 0 EUR</span>
                                    </div>
                                    <div class="flex justify-between py-1.5 border-b border-slate-100">
                                        <span>Number of shares</span>
                                        <span class="font-medium text-slate-900" id="detail-parts">1</span>
                                    </div>
                                    <div class="flex justify-between py-1.5 border-b border-slate-100">
                                        <span>Family quotient</span>
                                        <span class="font-medium text-slate-900" id="detail-qf">0 EUR</span>
                                    </div>
                                    <div class="mt-3 p-3 bg-slate-50 rounded-lg overflow-x-auto">
                                        <p class="text-xs font-medium text-slate-700 mb-3">Tax brackets applied (per share):</p>
                                        <table class="w-full text-xs">
                                            <thead>
                                                <tr class="text-left text-slate-500 border-b border-slate-200">
                                                    <th class="pb-2 font-medium">Bracket</th>
                                                    <th class="pb-2 font-medium text-right">Amount</th>
                                                    <th class="pb-2 font-medium text-right">Rate</th>
                                                    <th class="pb-2 font-medium text-right">Tax</th>
                                                </tr>
                                            </thead>
                                            <tbody id="detail-tranches" class="text-slate-600"></tbody>
                                        </table>
                                    </div>
                                </div>
                            </details>
                        </div>

                        <!-- Tips Card -->
                        <div class="rounded-xl bg-gradient-to-br from-indigo-50 to-white border border-indigo-100 p-4">
                            <div class="flex gap-3">
                                <div class="text-indigo-600 mt-0.5"><i data-lucide="lightbulb" class="h-5 w-5"></i></div>
                                <div>
                                    <h4 class="text-sm font-semibold text-indigo-900">Personalized tip</h4>
                                    <p class="text-sm text-indigo-700 mt-1 leading-relaxed" id="dynamic-tip">
                                        Analyze your situation to get tailored advice.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Disclaimer -->
                        <div class="text-center text-xs text-slate-400 px-4">
                            <i data-lucide="info" class="h-3 w-3 inline mr-1"></i>
                            Indicative estimate based on official rates. Does not replace official tax authority advice.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEO Content Section -->
        <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 pb-12">

            <!-- Explanations -->
            <section class="mt-12">
                <h2 class="text-xl font-bold text-slate-900 mb-6">Understanding income tax in France</h2>
                <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                    <div class="prose prose-slate max-w-none text-sm text-slate-600 space-y-4">
                        <p>The <strong>income tax (IR)</strong> is one of the main French taxes. It is calculated on income earned the previous year and has been withheld at source since 2019. Understanding how it works allows you to legally optimize your tax situation.</p>

                        <h3 class="text-base font-semibold text-slate-800 mt-6">2026 progressive tax brackets</h3>
                        <p>French income tax uses <strong>progressive tax brackets</strong>. This means only the portion of income exceeding a threshold is taxed at the higher rate:</p>
                        <ul class="list-disc pl-5 space-y-1 mt-2">
                            <li><strong>0%</strong>: up to 11,497 EUR</li>
                            <li><strong>11%</strong>: from 11,497 EUR to 29,315 EUR</li>
                            <li><strong>30%</strong>: from 29,315 EUR to 83,823 EUR</li>
                            <li><strong>41%</strong>: from 83,823 EUR to 180,294 EUR</li>
                            <li><strong>45%</strong>: above 180,294 EUR</li>
                        </ul>

                        <h3 class="text-base font-semibold text-slate-800 mt-6">The family quotient</h3>
                        <p>The <strong>family quotient</strong> divides taxable income by the number of household shares. This mechanism reduces tax for families:</p>
                        <ul class="list-disc pl-5 space-y-1 mt-2">
                            <li>Single: <strong>1 share</strong></li>
                            <li>Married couple/PACS: <strong>2 shares</strong></li>
                            <li>1st and 2nd child: <strong>+0.5 share</strong> each</li>
                            <li>From 3rd child: <strong>+1 share</strong> each</li>
                            <li>Single parent with children: <strong>+0.5 share</strong> additional</li>
                        </ul>

                        <h3 class="text-base font-semibold text-slate-800 mt-6">The 10% allowance</h3>
                        <p>All employees automatically receive a <strong>flat 10% allowance</strong> on their taxable income, representing professional expenses. It is capped at 14,171 EUR and cannot be less than 495 EUR. This allowance directly reduces the tax base.</p>

                        <h3 class="text-base font-semibold text-slate-800 mt-6">Common legal optimizations</h3>
                        <p>Several mechanisms allow you to legally reduce your taxes:</p>
                        <ul class="list-disc pl-5 space-y-2 mt-2">
                            <li><strong>Retirement Savings Plan (PER)</strong>: contributions are deductible from taxable income, reducing tax according to your marginal bracket</li>
                            <li><strong>Charitable donations</strong>: 66% to 75% of the donated amount becomes a tax credit</li>
                            <li><strong>Rental investment</strong>: Pinel and Denormandie schemes offer tax reductions</li>
                            <li><strong>Home employment</strong>: 50% of expenses qualify for a tax credit</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Examples Section -->
            <section class="mt-8">
                <h2 class="text-xl font-bold text-slate-900 mb-6">3 tax calculation examples</h2>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
                        <div class="text-center mb-4">
                            <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full">Example 1</span>
                        </div>
                        <h3 class="font-semibold text-slate-800 text-center mb-3">Single without children</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-slate-500">Net taxable income</span>
                                <span class="font-medium">35,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">10% allowance</span>
                                <span class="font-medium text-red-600">-3,500 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">Taxable income</span>
                                <span class="font-medium">31,500 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">Tax shares</span>
                                <span class="font-medium">1</span>
                            </div>
                            <div class="border-t pt-2 flex justify-between">
                                <span class="font-semibold">Annual tax</span>
                                <span class="font-bold text-indigo-600">2,736 EUR</span>
                            </div>
                            <div class="flex justify-between text-xs text-slate-400">
                                <span>Average rate</span>
                                <span>7.8%</span>
                            </div>
                        </div>
                        <p class="text-xs text-slate-500 mt-3">Young single employee with median salary.</p>
                    </div>

                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
                        <div class="text-center mb-4">
                            <span class="inline-block bg-green-100 text-green-800 text-xs font-semibold px-3 py-1 rounded-full">Example 2</span>
                        </div>
                        <h3 class="font-semibold text-slate-800 text-center mb-3">Couple with 2 children</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-slate-500">Household income</span>
                                <span class="font-medium">70,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">10% allowance</span>
                                <span class="font-medium text-red-600">-7,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">Taxable income</span>
                                <span class="font-medium">63,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">Tax shares</span>
                                <span class="font-medium">3</span>
                            </div>
                            <div class="border-t pt-2 flex justify-between">
                                <span class="font-semibold">Annual tax</span>
                                <span class="font-bold text-indigo-600">3,204 EUR</span>
                            </div>
                            <div class="flex justify-between text-xs text-slate-400">
                                <span>Average rate</span>
                                <span>4.6%</span>
                            </div>
                        </div>
                        <p class="text-xs text-slate-500 mt-3">Typical family with two average incomes.</p>
                    </div>

                    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
                        <div class="text-center mb-4">
                            <span class="inline-block bg-purple-100 text-purple-800 text-xs font-semibold px-3 py-1 rounded-full">Example 3</span>
                        </div>
                        <h3 class="font-semibold text-slate-800 text-center mb-3">Senior executive + PER</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-slate-500">Net taxable income</span>
                                <span class="font-medium">90,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">PER contribution</span>
                                <span class="font-medium text-emerald-600">-10,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">Taxable income</span>
                                <span class="font-medium">71,000 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-500">Tax shares</span>
                                <span class="font-medium">1</span>
                            </div>
                            <div class="border-t pt-2 flex justify-between">
                                <span class="font-semibold">Annual tax</span>
                                <span class="font-bold text-indigo-600">14,586 EUR</span>
                            </div>
                            <div class="flex justify-between text-xs text-emerald-600">
                                <span>PER savings</span>
                                <span>3,000 EUR</span>
                            </div>
                        </div>
                        <p class="text-xs text-slate-500 mt-3">Executive optimizing with PER (30% marginal rate).</p>
                    </div>
                </div>
            </section>

            <!-- FAQ Section -->
            <section class="mt-8">
                <h2 class="text-xl font-bold text-slate-900 mb-6">Frequently asked questions about income tax</h2>
                <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                    <div class="space-y-4">
                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">What is the marginal tax rate (TMI)?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">The <strong>marginal tax rate</strong> is the rate applied to the highest bracket of your income. It determines the savings for each euro deducted (PER, donations...). For example, with a 30% marginal rate, each euro contributed to a PER saves you 30 cents in tax.</p>
                        </details>

                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">How does withholding tax work?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">Since January 2019, tax is withheld monthly from your salary by your employer. The <strong>applied rate is personalized</strong> based on your last return. In September, this rate is recalculated. If you overpaid, you receive a refund. If you underpaid, an additional amount is requested.</p>
                        </details>

                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">What's the difference between a tax reduction and a tax credit?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">A <strong>tax reduction</strong> decreases the tax owed but cannot create a refund (if tax is zero, you get nothing back). A <strong>tax credit</strong> is refunded even if you owe no tax. Donations give a reduction; home employment gives a credit.</p>
                        </details>

                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">How does the PER reduce my tax?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">Contributions to a <strong>Retirement Savings Plan</strong> are deducted from your taxable income (within a ceiling limit). The tax savings equals your marginal rate: with a 30% rate, you save 30% of the amount contributed. Note: savings will be taxed upon withdrawal, but often at a lower rate (in retirement).</p>
                        </details>

                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">At what income level do you start paying taxes?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">In 2026, a single person becomes taxable from about <strong>17,200 EUR of net taxable income</strong> (before allowance). After the 10% allowance, the taxable income of 15,480 EUR exceeds the 11,497 EUR threshold. For a couple, the threshold is approximately 32,200 EUR.</p>
                        </details>

                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">Are overtime hours taxable?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">Overtime hours benefit from an <strong>income tax exemption</strong> up to 7,500 EUR per year. Beyond this ceiling, they are taxed normally. This exemption is automatic and appears on your pre-filled return.</p>
                        </details>

                        <details class="group border-b border-slate-100 pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">How do I declare property income?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">Property income (rent) is added to your other income and taxed at progressive rates. Two schemes exist: <strong>micro-foncier</strong> (30% allowance if rent under 15,000 EUR/year) or <strong>actual expenses</strong> (deduction of real charges). The choice depends on your deductible expenses.</p>
                        </details>

                        <details class="group pb-4">
                            <summary class="flex justify-between items-center cursor-pointer list-none">
                                <span class="font-medium text-slate-800">When and how to file your tax return?</span>
                                <i data-lucide="chevron-down" class="h-5 w-5 text-slate-400 group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="mt-3 text-sm text-slate-600">The return is filed online at <strong>impots.gouv.fr</strong> between April and June (deadline varies by department). Your return is pre-filled with salaries and income known to the administration. You must verify and complete it with your reductions/credits and non-pre-filled income.</p>
                        </details>
                    </div>
                </div>
            </section>

            <!-- Sources Section -->
            <section class="mt-8 mb-8">
                <h2 class="text-xl font-bold text-slate-900 mb-6">Official sources</h2>
                <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
                    <div class="grid md:grid-cols-2 gap-4 text-sm">
                        <a href="https://www.impots.gouv.fr/particulier/questions/comment-est-calcule-limpot-sur-le-revenu" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                            <i data-lucide="external-link" class="h-5 w-5 text-indigo-600"></i>
                            <div>
                                <div class="font-medium text-slate-800">impots.gouv.fr</div>
                                <div class="text-xs text-slate-500">Income tax calculation</div>
                            </div>
                        </a>
                        <a href="https://www.service-public.fr/particuliers/vosdroits/F1419" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                            <i data-lucide="external-link" class="h-5 w-5 text-indigo-600"></i>
                            <div>
                                <div class="font-medium text-slate-800">Service-Public.fr</div>
                                <div class="text-xs text-slate-500">Tax brackets and rates</div>
                            </div>
                        </a>
                        <a href="https://bofip.impots.gouv.fr/bofip/2494-PGP.html" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                            <i data-lucide="external-link" class="h-5 w-5 text-indigo-600"></i>
                            <div>
                                <div class="font-medium text-slate-800">BOFIP</div>
                                <div class="text-xs text-slate-500">Official Tax Bulletin</div>
                            </div>
                        </a>
                        <a href="https://www.economie.gouv.fr/particuliers/prelevement-source-impot-revenu" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                            <i data-lucide="external-link" class="h-5 w-5 text-indigo-600"></i>
                            <div>
                                <div class="font-medium text-slate-800">economie.gouv.fr</div>
                                <div class="text-xs text-slate-500">Withholding tax</div>
                            </div>
                        </a>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Mobile Sticky Button -->
    <button id="mobile-results-btn" class="lg:hidden mobile-sticky-btn inline-flex items-center gap-2 rounded-full px-6 py-3 text-sm font-semibold text-white shadow-lg transition-all" style="background-color: #4f46e5;">
        <i data-lucide="calculator" class="h-4 w-4"></i>
        View my results
    </button>
            <!-- Example Calculation -->
            <div class="bg-gradient-to-br from-indigo-50 to-white rounded-2xl border border-indigo-200 shadow-sm p-6 md:p-8 mt-6">
                <h2 class="text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2">
                    <iconify-icon icon="lucide:calculator" width="20" class="text-indigo-500"></iconify-icon>
                    Calculation Example: â‚¬45,000
                </h2>

                <div class="space-y-4 text-sm">

                    <div class="bg-white rounded-lg p-4 border border-slate-200">
                        <h4 class="font-medium text-slate-900 mb-2">1. Family Quotient</h4>
                        <div class="space-y-1 text-slate-600">
                            <p>Taxable income: 45,000â‚¬</p>
                            <p>Tax shares (single): 1</p>
                            <p>Quotient: 45,000â‚¬</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg p-4 border border-slate-200">
                        <h4 class="font-medium text-slate-900 mb-2">2. 2026 Tax Brackets</h4>
                        <div class="space-y-1 text-slate-600">
                            <p>0â‚¬ - 11,294â‚¬: 0% = 0â‚¬</p>
                            <p>11,294â‚¬ - 28,797â‚¬: 11% = 1,925â‚¬</p>
                            <p>28,797â‚¬ - 45,000â‚¬: 30% = 4,861â‚¬</p>
                            <p class="font-medium text-slate-900 pt-1 border-t">Total Tax: 6,786â‚¬</p>
                        </div>
                    </div>

                    <div class="bg-emerald-50 rounded-lg p-4 border border-emerald-200">
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-emerald-800">Net Tax</span>
                            <span class="text-xl font-bold text-emerald-600">6,786â‚¬</span>
                        </div>
                        <p class="text-xs text-emerald-600 mt-1">That is 566â‚¬/month | Average rate: 15.1%</p>
                    </div>
                </div>
            </div>

            <!-- Tax Brackets Details -->
            <div class="bg-white rounded-2xl border border-slate-200 shadow-sm p-6 md:p-8 mt-6">
                <h2 class="text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2">
                    <iconify-icon icon="lucide:list" width="20" class="text-amber-500"></iconify-icon>
                    2026 Income Tax Brackets
                </h2>

                <div class="grid md:grid-cols-2 gap-6">

                    <div>
                        <h3 class="text-sm font-medium text-slate-700 mb-2">Marginal Brackets</h3>
                        <ul class="space-y-1 text-sm text-slate-600">
                            <li>0 - 11,294â‚¬: <span class="font-medium">0%</span></li>
                            <li>11,294 - 28,797â‚¬: <span class="font-medium">11%</span></li>
                            <li>28,797 - 82,341â‚¬: <span class="font-medium">30%</span></li>
                            <li>82,341 - 177,106â‚¬: <span class="font-medium">41%</span></li>
                            <li>Above: <span class="font-medium">45%</span></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-slate-700 mb-2">Tax Shares</h3>
                        <ul class="space-y-1 text-sm text-slate-600">
                            <li>Single: <span class="font-medium">1 share</span></li>
                            <li>Couple: <span class="font-medium">2 shares</span></li>
                            <li>1st child: <span class="font-medium">+0.5</span></li>
                            <li>2nd child: <span class="font-medium">+0.5</span></li>
                            <li>3rd+ child: <span class="font-medium">+1</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Official Sources -->
            <div class="bg-slate-50 rounded-2xl border border-slate-200 p-6 md:p-8 mt-6">
                <h2 class="text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2">
                    <iconify-icon icon="lucide:link" width="20" class="text-blue-500"></iconify-icon>
                    Official Sources
                </h2>

                <div class="space-y-3 text-sm">
                    <a href="https://www.impots.gouv.fr/particulier/questions/quels-sont-les-taux-dimposition-pour-2026" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition-colors">
                        <iconify-icon icon="lucide:external-link" width="16" class="text-blue-500"></iconify-icon>
                        <div>
                            <p class="font-medium text-slate-900">French Tax Authority</p>
                            <p class="text-xs text-slate-500">impots.gouv.fr - Official 2026 rates</p>
                        </div>
                    </a>
                    <a href="https://www.service-public.fr/particuliers/vosdroits/F1419" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition-colors">
                        <iconify-icon icon="lucide:external-link" width="16" class="text-blue-500"></iconify-icon>
                        <div>
                            <p class="font-medium text-slate-900">Service Public</p>
                            <p class="text-xs text-slate-500">service-public.fr - Tax calculation</p>
                        </div>
                    </a>
                    <a href="https://bofip.impots.gouv.fr/" target="_blank" rel="noopener" class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition-colors">
                        <iconify-icon icon="lucide:external-link" width="16" class="text-blue-500"></iconify-icon>
                        <div>
                            <p class="font-medium text-slate-900">BOFiP</p>
                            <p class="text-xs text-slate-500">bofip.impots.gouv.fr - Tax documentation</p>
                        </div>
                    </a>
                </div>
            </div>


    <!-- Footer -->
    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-grid">
                <div>
                    <h4>NetSalaire</h4>
                    <p>Free tax simulators for France and Morocco. Compare, simulate, optimize.</p>
                </div>
                <div>
                    <h4>France</h4>
                    <ul>
                        <li><a href="/en/france/gross-to-net/">Gross to Net</a></li>
                        <li><a href="/en/france/income-tax/">Income Tax Simulator</a></li>
                        <li><a href="/en/france/tax-guide/">Tax Guide</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Morocco</h4>
                    <ul>
                        <li><a href="/en/morocco/gross-to-net/">Gross to Net</a></li>
                        <li><a href="/en/morocco/income-tax/">Income Tax Simulator</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Information</h4>
                    <ul>
                        <li><a href="/en/faq/">FAQ</a></li>
                        <li><a href="/en/legal-notice/">Legal Notice</a></li>
                        <li><a href="/en/privacy-policy/">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 NetSalaire.com - Indicative estimate, does not replace official tax authority advice</p>
            </div>
        </div>
    </footer>

    <!-- Calculator Script -->
    <script>
    (function() {
        'use strict';

        const TAX_BRACKETS = [
            { limit: 11497, rate: 0 },
            { limit: 29315, rate: 0.11 },
            { limit: 83823, rate: 0.30 },
            { limit: 180294, rate: 0.41 },
            { limit: Infinity, rate: 0.45 }
        ];

        const ABATTEMENT_RATE = 0.10;
        const ABATTEMENT_MAX = 14171;
        const ABATTEMENT_MIN = 495;

        const state = {
            status: 'single',
            children: 0,
            parentIsole: false,
            income1: 40000,
            income2: 0,
            hasTwoIncomes: false,
            incomeFoncier: 0,
            hasPer: false,
            perAmount: 0,
            perPlafond: 0,
            perPlafondUnknown: false,
            hasDons: false,
            dons66: 0,
            dons75: 0
        };

        const $ = (sel) => document.querySelector(sel);
        const $$ = (sel) => document.querySelectorAll(sel);

        const formatMoney = (val) => Math.round(val).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ') + ' EUR';
        const formatPercent = (val) => val.toFixed(1) + '%';
        const clamp = (val, min, max) => Math.min(Math.max(val, min), max);

        function setStatus(value) {
            state.status = value;
            // Reset all buttons to default style
            document.querySelectorAll('.status-btn').forEach(btn => {
                btn.style.borderColor = '#e2e8f0';
                btn.style.backgroundColor = 'white';
                const icon = btn.querySelector('i');
                const span = btn.querySelector('span');
                if (icon) icon.style.color = '#94a3b8';
                if (span) span.style.color = '#334155';
            });
            // Highlight active button with solid indigo background
            const activeBtn = document.getElementById('btn-' + value);
            if (activeBtn) {
                activeBtn.style.borderColor = '#4f46e5';
                activeBtn.style.backgroundColor = '#4f46e5';
                const icon = activeBtn.querySelector('i');
                const span = activeBtn.querySelector('span');
                if (icon) icon.style.color = 'white';
                if (span) span.style.color = 'white';
            }
            updateVisibility();
            calculate();
        }

        function calculateParts() {
            let parts = state.status === 'married' ? 2 : 1;
            if (state.children >= 1) parts += 0.5;
            if (state.children >= 2) parts += 0.5;
            if (state.children >= 3) parts += (state.children - 2);
            if (state.parentIsole && state.children > 0 && state.status !== 'married') {
                parts += 0.5;
            }
            return parts;
        }

        function calculateAbattement(income) {
            const abattement = income * ABATTEMENT_RATE;
            return clamp(abattement, income > 0 ? ABATTEMENT_MIN : 0, ABATTEMENT_MAX);
        }

        function calculateTax(taxableIncome, parts) {
            const qf = taxableIncome / parts;
            let taxPerPart = 0;
            let marginalRate = 0;
            const tranchesApplied = [];

            for (let i = 0; i < TAX_BRACKETS.length; i++) {
                const bracket = TAX_BRACKETS[i];
                const prevLimit = i === 0 ? 0 : TAX_BRACKETS[i - 1].limit;
                let amountInBracket = 0;
                let taxInBracket = 0;

                if (qf > prevLimit) {
                    amountInBracket = Math.min(qf, bracket.limit) - prevLimit;
                    taxInBracket = amountInBracket * bracket.rate;
                    taxPerPart += taxInBracket;
                    marginalRate = bracket.rate;
                }

                tranchesApplied.push({
                    from: prevLimit,
                    to: bracket.limit,
                    rate: bracket.rate,
                    amount: amountInBracket,
                    tax: taxInBracket
                });
            }

            return { tax: Math.floor(taxPerPart * parts), marginalRate, qf, tranchesApplied };
        }

        function calculate() {
            const parts = calculateParts();
            let grossIncome = state.income1 + state.incomeFoncier;
            if (state.status === 'married' && state.hasTwoIncomes) {
                grossIncome += state.income2;
            }

            let totalAbattement = calculateAbattement(state.income1);
            if (state.status === 'married' && state.hasTwoIncomes) {
                totalAbattement += calculateAbattement(state.income2);
            }

            let perDeduction = 0;
            if (state.hasPer && state.perAmount > 0) {
                if (state.perPlafondUnknown || state.perPlafond === 0) {
                    perDeduction = state.perAmount;
                } else {
                    perDeduction = Math.min(state.perAmount, state.perPlafond);
                }
            }

            const incomeAfterAbattement = Math.max(0, grossIncome - totalAbattement);
            const taxableIncome = Math.max(0, incomeAfterAbattement - perDeduction);
            const result = calculateTax(taxableIncome, parts);
            const resultWithoutPer = calculateTax(incomeAfterAbattement, parts);
            const perSavings = resultWithoutPer.tax - result.tax;

            let donsReduction = 0;
            let donsTotal = 0;
            if (state.hasDons) {
                donsTotal = state.dons66 + state.dons75;
                const dons75Capped = Math.min(state.dons75, 1000);
                const dons75Excess = Math.max(0, state.dons75 - 1000);
                donsReduction = Math.floor((state.dons66 * 0.66) + (dons75Capped * 0.75) + (dons75Excess * 0.66));
                const maxDonsReduction = Math.floor(taxableIncome * 0.20);
                donsReduction = Math.min(donsReduction, maxDonsReduction);
            }

            const finalTax = Math.max(0, result.tax - donsReduction);
            const netAfterTax = grossIncome - finalTax;
            const monthly = netAfterTax / 12;
            const avgRate = grossIncome > 0 ? (finalTax / grossIncome) * 100 : 0;
            const taxPercent = grossIncome > 0 ? (finalTax / grossIncome) * 100 : 0;

            updateUI({
                parts, grossIncome, totalAbattement, perDeduction, incomeAfterAbattement, taxableIncome,
                tax: finalTax, taxBeforeDons: result.tax, marginalRate: result.marginalRate, qf: result.qf,
                tranchesApplied: result.tranchesApplied, netAfterTax, monthly, avgRate, taxPercent, perSavings, donsTotal, donsReduction
            });
            if (userHasInteracted) updateURL();
        }

        function updateUI(data) {
            $('#display-parts').textContent = data.parts;

            if (state.hasPer) {
                $('#per-deduction-display').textContent = formatMoney(data.perDeduction);
                $('#income-after-per-display').textContent = formatMoney(data.taxableIncome);
                if (state.perPlafondUnknown || state.perPlafond === 0) {
                    $('#per-warning').classList.remove('hidden');
                } else {
                    $('#per-warning').classList.add('hidden');
                }
            }

            $('#result-tax').textContent = formatMoney(data.tax);
            $('#result-avg-rate').textContent = formatPercent(data.avgRate);
            $('#result-marginal-rate').textContent = (data.marginalRate * 100).toFixed(0) + '%';
            $('#tax-progress-bar').style.width = Math.min(data.avgRate * 2.5, 100) + '%';

            if (state.hasPer && data.perSavings > 0) {
                $('#per-savings-card').classList.remove('hidden');
                $('#result-per-savings').textContent = formatMoney(data.perSavings);
                const efficiency = data.perDeduction > 0 ? Math.round((data.perSavings / data.perDeduction) * 100) : 0;
                $('#per-efficiency').textContent = efficiency;
            } else {
                $('#per-savings-card').classList.add('hidden');
            }

            if (state.hasDons && data.donsReduction > 0) {
                $('#dons-savings-card').classList.remove('hidden');
                $('#result-dons-savings').textContent = formatMoney(data.donsReduction);
                $('#dons-total-result').textContent = formatMoney(data.donsTotal);
            } else {
                $('#dons-savings-card').classList.add('hidden');
            }

            if (state.hasDons) {
                $('#dons-total-display').textContent = formatMoney(data.donsTotal);
                $('#dons-reduction-display').textContent = formatMoney(data.donsReduction);
            }

            $('#chart-percent').textContent = (100 - data.taxPercent).toFixed(0) + '%';
            $('#chart-donut').style.background = `conic-gradient(#0ea5e9 0% ${data.taxPercent}%, #f1f5f9 ${data.taxPercent}% 100%)`;
            $('#result-net-annual').textContent = formatMoney(data.netAfterTax);
            $('#result-tax-small').textContent = '- ' + formatMoney(data.tax);
            $('#result-monthly').textContent = formatMoney(data.monthly);

            $('#detail-gross').textContent = formatMoney(data.grossIncome);
            $('#detail-abattement').textContent = '- ' + formatMoney(data.totalAbattement);

            if (state.hasPer && data.perDeduction > 0) {
                $('#detail-per-row').classList.remove('hidden');
                $('#detail-per').textContent = '- ' + formatMoney(data.perDeduction);
            } else {
                $('#detail-per-row').classList.add('hidden');
            }

            $('#detail-taxable').textContent = formatMoney(data.taxableIncome);

            if (state.hasDons && data.donsReduction > 0) {
                $('#detail-dons-row').classList.remove('hidden');
                $('#detail-dons').textContent = '- ' + formatMoney(data.donsReduction);
            } else {
                $('#detail-dons-row').classList.add('hidden');
            }

            $('#detail-parts').textContent = data.parts;
            $('#detail-qf').textContent = formatMoney(data.qf);

            $('#detail-tranches').innerHTML = data.tranchesApplied.map((t, i) => {
                const isActive = t.amount > 0;
                const rowClass = isActive ? 'text-slate-900 font-medium' : 'text-slate-400';
                const bgClass = isActive ? 'bg-indigo-50/50' : '';
                let trancheLabel;
                if (i === 0) trancheLabel = `Up to ${formatMoney(t.to)}`;
                else if (t.to === Infinity) trancheLabel = `Above ${formatMoney(t.from)}`;
                else trancheLabel = `${formatMoney(t.from + 1)} - ${formatMoney(t.to)}`;
                return `<tr class="${bgClass}"><td class="py-1.5 pr-2 ${rowClass}">${trancheLabel}</td><td class="py-1.5 text-right ${rowClass}">${formatMoney(t.amount)}</td><td class="py-1.5 text-right ${rowClass}">${(t.rate * 100).toFixed(0)}%</td><td class="py-1.5 text-right ${isActive ? 'text-indigo-600 font-semibold' : 'text-slate-400'}">${formatMoney(t.tax)}</td></tr>`;
            }).join('') + `<tr class="border-t border-slate-200 font-semibold text-slate-900"><td class="pt-2">Total x ${data.parts} shares</td><td></td><td></td><td class="pt-2 text-right text-indigo-600">${formatMoney(data.taxBeforeDons)}</td></tr>`;

            updateTip(data);
        }

        function updateTip(data) {
            let tip = '';
            if (data.tax === 0) {
                tip = "You are not taxable. Consider saving via a tax-free savings account.";
            } else if (!state.hasPer && data.marginalRate >= 0.30) {
                tip = `With a ${(data.marginalRate * 100).toFixed(0)}% marginal rate, the PER would be very effective. Each EUR contributed would save you ${(data.marginalRate * 100).toFixed(0)} cents in tax.`;
            } else if (state.hasPer && data.perSavings > 0) {
                tip = `Excellent! Your PER saves you ${formatMoney(data.perSavings)} in tax.`;
            } else {
                tip = "Consider deductions (PER, donations) to reduce your tax.";
            }
            $('#dynamic-tip').textContent = tip;
        }

        function updateURL() {
            const params = new URLSearchParams();
            params.set('status', state.status);
            params.set('children', state.children);
            if (state.parentIsole) params.set('isole', '1');
            params.set('income1', state.income1);
            if (state.status === 'married' && state.hasTwoIncomes) params.set('income2', state.income2);
            if (state.incomeFoncier > 0) params.set('foncier', state.incomeFoncier);
            if (state.hasPer) {
                params.set('per', state.perAmount);
                if (!state.perPlafondUnknown && state.perPlafond > 0) params.set('plafond', state.perPlafond);
            }
            if (state.hasDons) {
                if (state.dons66 > 0) params.set('dons66', state.dons66);
                if (state.dons75 > 0) params.set('dons75', state.dons75);
            }
            history.replaceState(null, '', window.location.pathname + '?' + params.toString());
        }

        function loadFromURL() {
            const params = new URLSearchParams(window.location.search);
            if (params.has('status')) { setStatus(params.get('status')); }
            if (params.has('children')) { state.children = parseInt(params.get('children')) || 0; $('#child-count').textContent = state.children; }
            if (params.has('isole')) { state.parentIsole = params.get('isole') === '1'; $('#parent-isole').checked = state.parentIsole; }
            if (params.has('income1')) { state.income1 = parseInt(params.get('income1')) || 40000; $('#income1-input').value = state.income1; $('#income1-slider').value = Math.min(state.income1, 200000); }
            if (params.has('income2')) { state.income2 = parseInt(params.get('income2')) || 0; state.hasTwoIncomes = true; $('#has-two-incomes').checked = true; $('#income2-input').value = state.income2; $('#income2-slider').value = Math.min(state.income2, 200000); }
            if (params.has('foncier')) { state.incomeFoncier = parseInt(params.get('foncier')) || 0; $('#income-foncier').value = state.incomeFoncier; }
            if (params.has('per')) { state.hasPer = true; state.perAmount = parseInt(params.get('per')) || 0; $('#has-per').checked = true; $('#per-amount').value = state.perAmount; $('#per-slider').value = Math.min(state.perAmount, 30000); $('#per-details').classList.remove('hidden'); if (params.has('plafond')) { state.perPlafond = parseInt(params.get('plafond')) || 0; $('#per-plafond').value = state.perPlafond; } }
            if (params.has('dons66') || params.has('dons75')) { state.hasDons = true; $('#has-dons').checked = true; $('#dons-details').classList.remove('hidden'); if (params.has('dons66')) { state.dons66 = parseInt(params.get('dons66')) || 0; $('#dons-66').value = state.dons66; $('#dons-66-slider').value = Math.min(state.dons66, 10000); } if (params.has('dons75')) { state.dons75 = parseInt(params.get('dons75')) || 0; $('#dons-75').value = state.dons75; $('#dons-75-slider').value = Math.min(state.dons75, 2000); } }
            updateVisibility();
        }

        function updateVisibility() {
            if (state.status === 'married') { $('#two-incomes-toggle').classList.remove('hidden'); $('#two-incomes-toggle').classList.add('flex'); } else { $('#two-incomes-toggle').classList.add('hidden'); state.hasTwoIncomes = false; $('#has-two-incomes').checked = false; }
            if (state.status === 'married' && state.hasTwoIncomes) { $('#income2-container').classList.remove('hidden'); } else { $('#income2-container').classList.add('hidden'); }
            if (state.status === 'married') { $('#parent-isole-container').classList.add('hidden'); state.parentIsole = false; $('#parent-isole').checked = false; } else { $('#parent-isole-container').classList.remove('hidden'); }
            if (state.hasPer) { $('#per-details').classList.remove('hidden'); } else { $('#per-details').classList.add('hidden'); }
            if (state.perPlafondUnknown) { $('#per-plafond-container').classList.add('hidden'); } else { $('#per-plafond-container').classList.remove('hidden'); }
            if (state.hasDons) { $('#dons-details').classList.remove('hidden'); } else { $('#dons-details').classList.add('hidden'); }
        }

        let userHasInteracted = window.location.search.length > 1;

        function setupEventListeners() {
            // Enable URL params writing on first user interaction
            ['input', 'click'].forEach(evt => document.addEventListener(evt, () => { userHasInteracted = true; }, { once: true }));

            // Status buttons
            $('#btn-single').addEventListener('click', () => setStatus('single'));
            $('#btn-married').addEventListener('click', () => setStatus('married'));
            $('#btn-divorced').addEventListener('click', () => setStatus('divorced'));

            $('#btn-child-plus').addEventListener('click', () => { if (state.children < 10) { state.children++; $('#child-count').textContent = state.children; calculate(); } });
            $('#btn-child-minus').addEventListener('click', () => { if (state.children > 0) { state.children--; $('#child-count').textContent = state.children; calculate(); } });
            $('#parent-isole').addEventListener('change', (e) => { state.parentIsole = e.target.checked; calculate(); });

            // Sync monthly/annual/slider for income inputs
            const syncIncomeInputs = (monthlyEl, annualEl, slider, key, max = 200000) => {
                monthlyEl.addEventListener('input', (e) => {
                    const monthly = parseInt(e.target.value) || 0;
                    state[key] = monthly * 12;
                    annualEl.value = state[key];
                    slider.value = Math.min(state[key], max);
                    calculate();
                });
                annualEl.addEventListener('input', (e) => {
                    state[key] = parseInt(e.target.value) || 0;
                    monthlyEl.value = Math.round(state[key] / 12);
                    slider.value = Math.min(state[key], max);
                    calculate();
                });
                slider.addEventListener('input', (e) => {
                    state[key] = parseInt(e.target.value);
                    annualEl.value = state[key];
                    monthlyEl.value = Math.round(state[key] / 12);
                    calculate();
                });
            };
            syncIncomeInputs($('#income1-monthly'), $('#income1-input'), $('#income1-slider'), 'income1');
            syncIncomeInputs($('#income2-monthly'), $('#income2-input'), $('#income2-slider'), 'income2');

            const syncSlider = (input, slider, key, max = 200000) => {
                input.addEventListener('input', (e) => { state[key] = parseInt(e.target.value) || 0; slider.value = Math.min(state[key], max); calculate(); });
                slider.addEventListener('input', (e) => { state[key] = parseInt(e.target.value); input.value = state[key]; calculate(); });
            };
            syncSlider($('#per-amount'), $('#per-slider'), 'perAmount', 30000);
            syncSlider($('#dons-66'), $('#dons-66-slider'), 'dons66', 10000);
            syncSlider($('#dons-75'), $('#dons-75-slider'), 'dons75', 2000);

            $('#has-two-incomes').addEventListener('change', (e) => { state.hasTwoIncomes = e.target.checked; updateVisibility(); calculate(); });
            $('#income-foncier').addEventListener('input', (e) => { state.incomeFoncier = parseInt(e.target.value) || 0; calculate(); });
            $('#has-per').addEventListener('change', (e) => { state.hasPer = e.target.checked; updateVisibility(); calculate(); });
            $('#per-plafond').addEventListener('input', (e) => { state.perPlafond = parseInt(e.target.value) || 0; calculate(); });
            $('#per-plafond-unknown').addEventListener('change', (e) => { state.perPlafondUnknown = e.target.checked; updateVisibility(); calculate(); });
            $('#has-dons').addEventListener('change', (e) => { state.hasDons = e.target.checked; updateVisibility(); calculate(); });
            $('#btn-reset').addEventListener('click', () => { window.location.href = window.location.pathname; });
            $('#mobile-results-btn').addEventListener('click', () => { document.querySelector('.lg\\:col-span-5').scrollIntoView({ behavior: 'smooth', block: 'start' }); });
        }

        function init() {
            lucide.createIcons();
            loadFromURL();
            setupEventListeners();
            calculate();
        }

        if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
        else init();
    })();
    </script>

</body>
</html>
