<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Analytics (charg√© apr√®s interaction pour performance) -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        function loadGA() {
            if (window.gaLoaded) return;
            window.gaLoaded = true;

            var script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-Z328SB8DZ8';
            script.async = true;
            document.head.appendChild(script);

            gtag('js', new Date());
            gtag('config', 'G-Z328SB8DZ8');
        }

        // Charger GA apr√®s interaction utilisateur ou apr√®s 3s
        ['scroll', 'click', 'touchstart', 'keydown'].forEach(function(evt) {
            window.addEventListener(evt, loadGA, {once: true, passive: true});
        });
        setTimeout(loadGA, 3000);
    </script>

    <!-- Language Router (must be early for redirect) -->
    <script defer src="/assets/js/lang-router.js"></script>

    <script>
    </script>

    <title>Comparateur Salaire France vs Maroc pour MRE 2025</title>
    <meta name="description" content="MRE : France ou Maroc, o√π gagnes-tu vraiment le plus ? Compare ton salaire net, imp√¥ts et cotisations. Simulateur gratuit pour Marocains R√©sidant √† l'√âtranger.">
    <meta name="keywords" content="MRE, marocains r√©sidant √† l'√©tranger, comparateur salaire france maroc, simulateur fiscal MRE, impot france maroc, salaire net, expatriation maroc, retour au maroc">
    <link rel="canonical" href="https://netsalaire.com/fr/comparateur-salaire-france-maroc/">
    <link rel="alternate" hreflang="fr" href="https://netsalaire.com/fr/comparateur-salaire-france-maroc/">
    <link rel="alternate" hreflang="en" href="https://netsalaire.com/en/france-morocco-comparison/">
    <link rel="alternate" hreflang="x-default" href="https://netsalaire.com/fr/comparateur-salaire-france-maroc/">

    <!-- Open Graph -->
    <meta property="og:title" content="Comparateur Salaire France vs Maroc pour MRE 2025 | NetSalaire">
    <meta property="og:description" content="MRE : France ou Maroc, o√π gagnes-tu vraiment le plus ? Simulateur fiscal gratuit pour Marocains R√©sidant √† l'√âtranger.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://netsalaire.com/fr/comparateur-salaire-france-maroc/">
    <meta property="og:image" content="https://netsalaire.com/assets/images/og-comparateur.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Comparateur Salaire France vs Maroc pour MRE 2025">
    <meta name="twitter:description" content="MRE : France ou Maroc, o√π gagnes-tu vraiment le plus ? Simulateur fiscal gratuit.">
    <meta name="twitter:image" content="https://netsalaire.com/assets/images/og-comparateur.png">

    <!-- Additional SEO -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="NetSalaire">
    <meta property="og:site_name" content="NetSalaire">
    <meta property="og:locale" content="fr_FR">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">

    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        .toggle-checkbox:checked {
            right: 0;
            border-color: #0f172a;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #0f172a;
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .transition-all-300 { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Comparateur Salaire France vs Maroc pour MRE",
        "description": "Simulateur fiscal gratuit pour MRE (Marocains R√©sidant √† l'√âtranger) : compare ton salaire net entre la France et le Maroc",
        "url": "https://netsalaire.com/fr/comparateur-salaire-france-maroc/",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "EUR"
        },
        "publisher": {
            "@type": "Organization",
            "name": "NetSalaire",
            "url": "https://netsalaire.com"
        }
    }
    </script>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- Navigation -->
        <!-- Navbar -->
    <nav class="fixed top-0 w-full z-50 border-b border-slate-200 bg-white/80 backdrop-blur-md">
        <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
            <a href="/fr/" class="flex items-center gap-2 group">
                <div class="w-8 h-8 bg-slate-900 rounded flex items-center justify-center text-white font-semibold tracking-tighter shadow-md group-hover:bg-indigo-600 transition-colors duration-300">N.</div>
                <span class="font-semibold tracking-tight text-slate-900">NetSalaire</span>
            </a>
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-slate-600">
                <div class="relative group">
                    <a href="/fr/#france" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="circle-flags:fr" width="16"></iconify-icon> France
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[220px]">
                            <a href="/fr/france/simulateur-impot-revenu/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900"><iconify-icon icon="lucide:landmark" width="18" class="text-indigo-500"></iconify-icon> Simulateur Imp√¥t</a>
                            <a href="/fr/france/simulateur-salaire-brut-net/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900"><iconify-icon icon="lucide:calculator" width="18" class="text-indigo-500"></iconify-icon> Brut vers Net</a>
                            <a href="/fr/france/guide/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900"><iconify-icon icon="lucide:book-open" width="18" class="text-indigo-500"></iconify-icon> Guide Fiscal</a>
                        </div>
                    </div>
                </div>
                <div class="relative group">
                    <a href="/fr/#maroc" class="hover:text-slate-900 transition-colors flex items-center gap-1.5 py-2">
                        <iconify-icon icon="circle-flags:ma" width="16"></iconify-icon> Maroc
                        <iconify-icon icon="lucide:chevron-down" width="14" class="text-slate-400"></iconify-icon>
                    </a>
                    <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                        <div class="bg-white border border-slate-200 rounded-lg shadow-lg py-2 min-w-[220px]">
                            <a href="/fr/maroc/simulateur-impot-revenu/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900"><iconify-icon icon="lucide:landmark" width="18" class="text-emerald-500"></iconify-icon> Simulateur Imp√¥t</a>
                            <a href="/fr/maroc/simulateur-salaire-brut-net/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900"><iconify-icon icon="lucide:calculator" width="18" class="text-emerald-500"></iconify-icon> Brut vers Net</a>
                            <a href="/fr/maroc/guide/" class="flex items-center gap-3 px-4 py-2.5 text-slate-600 hover:bg-slate-50 hover:text-slate-900"><iconify-icon icon="lucide:book-open" width="18" class="text-emerald-500"></iconify-icon> Guide Fiscal</a>
                        </div>
                    </div>
                </div>
                <a href="/fr/comparateur-salaire-france-maroc/" class="hover:text-slate-900 transition-colors">France vs Maroc</a>
                <a href="/fr/comparateur-global/" class="hover:text-slate-900 transition-colors flex items-center gap-1.5"><iconify-icon icon="lucide:globe" width="16"></iconify-icon> Comparateur Global</a>
                <a href="/fr/faq/" class="hover:text-slate-900 transition-colors">FAQ</a>
            </div>
            <div class="flex items-center gap-3">
                <div class="relative">
                    <button onclick="document.getElementById('lang-dropdown').classList.toggle('hidden')" class="flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:text-slate-900 bg-slate-100 hover:bg-slate-200 border border-slate-200 rounded-full">
                        <span>üá´üá∑</span><iconify-icon icon="lucide:chevron-down" width="14"></iconify-icon>
                    </button>
                    <div id="lang-dropdown" class="hidden absolute top-full right-0 mt-2 bg-white border border-slate-200 rounded-lg shadow-lg min-w-[140px] py-1 z-50">
                        <a href="/fr/comparateur-salaire-france-maroc/" class="flex items-center gap-2 px-3 py-2 text-sm text-slate-700 bg-slate-50"><span>üá´üá∑</span> Fran√ßais</a>
                        <a href="/en/france-morocco-comparison/" class="flex items-center gap-2 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50"><span>üá¨üáß</span> English</a>
                    </div>
                </div>
                <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="md:hidden p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg">
                    <iconify-icon icon="lucide:menu" width="24"></iconify-icon>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-200">
            <div class="px-6 py-4 space-y-4">
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-900"><iconify-icon icon="circle-flags:fr" width="18"></iconify-icon> France</div>
                    <div class="pl-6 space-y-2">
                        <a href="/fr/france/simulateur-impot-revenu/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600"><iconify-icon icon="lucide:landmark" width="16" class="text-indigo-500"></iconify-icon> Simulateur Imp√¥t</a>
                        <a href="/fr/france/simulateur-salaire-brut-net/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600"><iconify-icon icon="lucide:calculator" width="16" class="text-indigo-500"></iconify-icon> Brut vers Net</a>
                        <a href="/fr/france/guide/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-indigo-600"><iconify-icon icon="lucide:book-open" width="16" class="text-indigo-500"></iconify-icon> Guide Fiscal</a>
                    </div>
                </div>
                <div class="space-y-2">
                    <div class="flex items-center gap-2 text-sm font-semibold text-slate-900"><iconify-icon icon="circle-flags:ma" width="18"></iconify-icon> Maroc</div>
                    <div class="pl-6 space-y-2">
                        <a href="/fr/maroc/simulateur-impot-revenu/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600"><iconify-icon icon="lucide:landmark" width="16" class="text-emerald-500"></iconify-icon> Simulateur Imp√¥t</a>
                        <a href="/fr/maroc/simulateur-salaire-brut-net/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600"><iconify-icon icon="lucide:calculator" width="16" class="text-emerald-500"></iconify-icon> Brut vers Net</a>
                        <a href="/fr/maroc/guide/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-emerald-600"><iconify-icon icon="lucide:book-open" width="16" class="text-emerald-500"></iconify-icon> Guide Fiscal</a>
                    </div>
                </div>
                <div class="pt-2 border-t border-slate-100 space-y-2">
                    <a href="/fr/comparateur-salaire-france-maroc/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900"><iconify-icon icon="lucide:scale" width="16"></iconify-icon> France vs Maroc</a>
                    <a href="/fr/comparateur-global/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900"><iconify-icon icon="lucide:globe" width="16"></iconify-icon> Comparateur Global</a>
                    <a href="/fr/faq/" class="flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900"><iconify-icon icon="lucide:help-circle" width="16"></iconify-icon> FAQ</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="w-full max-w-6xl mx-auto space-y-6 pt-24 pb-8 px-4 sm:px-6 lg:px-8">

        <!-- Page Header -->
        <header class="text-center mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-900 mb-2" data-i18n="comp.fr_ma_title">Comparateur Fiscal France vs Maroc pour MRE</h1>
            <p class="text-slate-500 max-w-2xl mx-auto" data-i18n="comp.subtitle">Comparez votre salaire net et votre pression fiscale entre les deux pays. Simulateur mis √† jour avec les bar√®mes 2025.</p>
        </header>

        <!-- Input Section -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-500 via-slate-200 to-indigo-500"></div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Salary Inputs -->
                <div class="space-y-5">
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-xs font-semibold uppercase tracking-tight text-slate-500" data-i18n="comp.gross_salary">Salaire Brut</label>
                        <div class="flex bg-slate-100 rounded-lg p-0.5">
                            <button id="period-monthly" class="px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300" data-i18n="comp_global.monthly">Mensuel</button>
                            <button id="period-annual" class="px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300" data-i18n="comp_global.annual">Annuel</button>
                        </div>
                    </div>

                    <div class="relative grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Divider "OU" -->
                        <div class="hidden sm:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-8 h-8 items-center justify-center bg-white rounded-full border border-slate-200 shadow-sm">
                            <span class="text-[10px] font-bold text-slate-400 uppercase">ou</span>
                        </div>
                        <div class="sm:hidden w-full text-center -my-2 order-2">
                            <span class="text-[10px] font-bold text-slate-300 uppercase bg-white px-2 relative z-10">ou</span>
                        </div>

                        <!-- France Input -->
                        <div class="relative group order-1 sm:order-2">
                            <label class="block text-xs font-medium text-slate-500 mb-1.5">France (EUR)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium text-sm">‚Ç¨</span>
                                <input type="text" inputmode="numeric" id="input-eur" class="w-full pl-10 pr-4 py-2.5 text-sm font-semibold text-slate-900 bg-white border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all-300" placeholder="0">
                            </div>
                            <div class="flex items-center justify-end gap-2 mt-2">
                                <span class="text-[10px] text-slate-400 font-medium" data-i18n="comp.cadre_status">Statut Cadre</span>
                                <button id="toggle-cadre" class="relative inline-flex h-4 w-7 items-center rounded-full bg-slate-200 transition-colors focus:outline-none">
                                    <span class="translate-x-0.5 inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform shadow-sm"></span>
                                </button>
                            </div>
                        </div>

                        <!-- Morocco Input -->
                        <div class="relative group order-3 sm:order-1">
                            <label class="block text-xs font-medium text-slate-500 mb-1.5">Maroc (MAD)</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium text-sm">Dh</span>
                                <input type="text" inputmode="numeric" id="input-mad" class="w-full pl-10 pr-4 py-2.5 text-sm font-semibold text-slate-900 bg-white border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all-300" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-2 mt-2">
                        <span class="text-[10px] text-slate-400 font-medium" data-i18n="comp.exchange_rate">Taux DH/EUR du jour :</span>
                        <input type="number" id="exchange-rate" value="10.8" class="w-16 py-0.5 px-1 text-[10px] font-mono text-slate-500 bg-slate-50 border border-slate-200 rounded text-center focus:outline-none focus:border-slate-400">
                        <span id="rate-status" class="text-[10px] text-emerald-500"></span>
                    </div>
                </div>

                <!-- Family Situation -->
                <div class="space-y-5 lg:border-l lg:border-slate-100 lg:pl-8">
                    <label class="block text-xs font-semibold uppercase tracking-tight text-slate-500 mb-2" data-i18n="comp_global.family_status">Situation Familiale</label>

                    <div class="space-y-4">
                        <div>
                            <span class="text-xs font-medium text-slate-600 mb-2 block" data-i18n="comp_global.marital_status">Statut Marital</span>
                            <div class="flex w-full bg-slate-50 border border-slate-200 rounded-lg p-1">
                                <button id="status-single" class="flex-1 py-1.5 text-[11px] font-medium rounded-md bg-white shadow-sm text-slate-900 border border-slate-100 transition-all-300" data-i18n="comp_global.single">C√©libataire</button>
                                <button id="status-married" class="flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300" data-i18n="comp_global.married">Mari√©(e)</button>
                                <button id="status-divorced" class="flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300" data-i18n="comp.divorced">Divorc√©(e)</button>
                            </div>
                        </div>

                        <div>
                            <span class="text-xs font-medium text-slate-600 mb-2 block" data-i18n="comp_global.children">Enfants √† charge</span>
                            <div class="flex items-center w-full bg-white border border-slate-200 rounded-lg h-[38px]">
                                <button id="child-minus" class="w-10 h-full flex items-center justify-center text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-l-lg transition-colors border-r border-slate-100">
                                    <span class="iconify" data-icon="lucide:minus" width="14"></span>
                                </button>
                                <div id="children-display" class="flex-1 text-center text-sm font-semibold text-slate-900 select-none">0</div>
                                <button id="child-plus" class="w-10 h-full flex items-center justify-center text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-r-lg transition-colors border-l border-slate-100">
                                    <span class="iconify" data-icon="lucide:plus" width="14"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Comparison Results -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- MAROC COLUMN -->
            <article class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col order-2 md:order-1">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üá≤üá¶</span>
                        <h2 class="text-base font-semibold text-slate-900">Maroc</h2>
                    </div>
                    <span class="text-[10px] font-medium text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100">IR Progressif</span>
                </div>

                <div class="p-6 flex-1 flex flex-col gap-6">
                    <!-- KPIs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Net "En Poche"</p>
                            <p class="text-2xl font-semibold text-slate-900 tracking-tight" id="ma-net">0 <span class="text-sm font-normal text-slate-400">MAD</span></p>
                            <p class="text-[10px] text-slate-400 mt-1" id="ma-net-eur">‚âà 0 ‚Ç¨</p>
                        </div>
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Taux d'Imposition</p>
                            <p class="text-2xl font-semibold text-emerald-600 tracking-tight" id="ma-rate">0%</p>
                            <p class="text-[10px] text-slate-400 mt-1">Pression Totale</p>
                        </div>
                    </div>

                    <!-- Stacked Bar Chart -->
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-medium text-slate-500 uppercase tracking-wide">
                            <span>Distribution</span>
                            <span>100% du Brut</span>
                        </div>
                        <div class="h-6 w-full bg-slate-100 rounded-md overflow-hidden flex shadow-inner relative group">
                            <div id="bar-ma-net" class="h-full bg-emerald-500 transition-all-300 relative group/segment" style="width: 60%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Salaire Net</div>
                            </div>
                            <div id="bar-ma-tax" class="h-full bg-emerald-300 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Imp√¥t (IR)</div>
                            </div>
                            <div id="bar-ma-soc" class="h-full bg-emerald-100 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Cotisations</div>
                            </div>
                        </div>
                        <div class="flex justify-between text-[10px] text-slate-400">
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-500"></div>Net</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-300"></div>Imp√¥t</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-emerald-100"></div>Social</div>
                        </div>
                    </div>

                    <!-- Breakdown Table -->
                    <div class="mt-2 border rounded-lg border-slate-200 overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-[10px] uppercase text-slate-500 font-semibold border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3">Poste</th>
                                    <th class="px-4 py-3 text-right" colspan="2">Montant</th>
                                    <th class="px-4 py-3 text-right text-slate-400">%</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="ma-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </article>

            <!-- FRANCE COLUMN -->
            <article class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col order-1 md:order-2">
                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üá´üá∑</span>
                        <h2 class="text-base font-semibold text-slate-900">France</h2>
                    </div>
                    <span class="text-[10px] font-medium text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-full border border-indigo-100">Quotient Familial</span>
                </div>

                <div class="p-6 flex-1 flex flex-col gap-6">
                    <!-- KPIs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Net "En Poche"</p>
                            <p class="text-2xl font-semibold text-slate-900 tracking-tight" id="fr-net">0 <span class="text-sm font-normal text-slate-400">‚Ç¨</span></p>
                            <p class="text-[10px] text-slate-400 mt-1" id="fr-net-mad">‚âà 0 MAD</p>
                        </div>
                        <div class="p-4 rounded-lg bg-slate-50 border border-slate-100">
                            <p class="text-[11px] font-medium uppercase text-slate-500 mb-1">Taux d'Imposition</p>
                            <p class="text-2xl font-semibold text-indigo-600 tracking-tight" id="fr-rate">0%</p>
                            <p class="text-[10px] text-slate-400 mt-1">Pression Totale</p>
                        </div>
                    </div>

                    <!-- Stacked Bar Chart -->
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-medium text-slate-500 uppercase tracking-wide">
                            <span>Distribution</span>
                            <span>100% du Brut</span>
                        </div>
                        <div class="h-6 w-full bg-slate-100 rounded-md overflow-hidden flex shadow-inner relative">
                            <div id="bar-fr-net" class="h-full bg-indigo-500 transition-all-300 relative group/segment" style="width: 60%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Salaire Net</div>
                            </div>
                            <div id="bar-fr-tax" class="h-full bg-indigo-300 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Imp√¥t (IR)</div>
                            </div>
                            <div id="bar-fr-soc" class="h-full bg-indigo-100 transition-all-300 relative group/segment" style="width: 20%">
                                <div class="opacity-0 group-hover/segment:opacity-100 absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[10px] py-1 px-2 rounded whitespace-nowrap z-10 pointer-events-none shadow-lg">Cotisations</div>
                            </div>
                        </div>
                        <div class="flex justify-between text-[10px] text-slate-400">
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-500"></div>Net</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-300"></div>Imp√¥t</div>
                            <div class="flex items-center gap-1.5"><div class="w-2 h-2 rounded-full bg-indigo-100"></div>Social</div>
                        </div>
                    </div>

                    <!-- Breakdown Table -->
                    <div class="mt-2 border rounded-lg border-slate-200 overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-slate-50 text-[10px] uppercase text-slate-500 font-semibold border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-3">Poste</th>
                                    <th class="px-4 py-3 text-right" colspan="2">Montant</th>
                                    <th class="px-4 py-3 text-right text-slate-400">%</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="fr-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </article>

        </div>

        <!-- Verdict Banner -->
        <div class="bg-slate-900 text-white rounded-xl shadow-lg p-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <span class="iconify w-8 h-8 text-yellow-400" data-icon="lucide:trophy"></span>
                <div>
                    <h3 class="font-semibold text-lg tracking-tight" id="verdict-title">Analyse Pr√™te</h3>
                    <p class="text-sm text-slate-400" id="verdict-text">Saisissez votre salaire pour comparer.</p>
                </div>
            </div>
            <div class="text-right flex flex-col items-end">
                <p class="text-xs uppercase tracking-widest text-slate-500 font-medium mb-1">Diff√©rence Annuelle</p>
                <div class="flex flex-col items-end">
                    <p class="text-2xl font-bold font-mono tracking-tight text-white leading-none mb-1" id="verdict-diff">--</p>
                    <p class="text-sm font-medium text-slate-400 font-mono tracking-tight" id="verdict-diff-eur"></p>
                </div>
            </div>
        </div>

        <!-- Reassurance -->
        <section class="bg-white rounded-xl border border-slate-200 p-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div>
                    <div class="text-2xl mb-2">üîí</div>
                    <h4 class="text-sm font-semibold text-slate-900">100% S√©curis√©</h4>
                    <p class="text-xs text-slate-500">Aucune donn√©e stock√©e</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">üìä</div>
                    <h4 class="text-sm font-semibold text-slate-900">Bar√®mes 2025</h4>
                    <p class="text-xs text-slate-500">Loi de finances actuelle</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">‚ö°</div>
                    <h4 class="text-sm font-semibold text-slate-900">Calcul Instantan√©</h4>
                    <p class="text-xs text-slate-500">R√©sultats en temps r√©el</p>
                </div>
                <div>
                    <div class="text-2xl mb-2">üåç</div>
                    <h4 class="text-sm font-semibold text-slate-900">Taux Live</h4>
                    <p class="text-xs text-slate-500">Taux de change du jour</p>
                </div>
            </div>
        </section>

        <p class="text-center text-[10px] text-slate-400 mt-8 pb-4 max-w-2xl mx-auto leading-relaxed">
            Avertissement L√©gal : Cet outil est fourni √† titre indicatif uniquement. Les lois fiscales en France et au Maroc sont complexes et sujettes √† modifications (Loi de Finances 2025). Les cotisations sociales sont des estimations moyennes. Les calculs excluent les niches fiscales complexes.
        </p>

        <!-- SEO Content Section -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">Comprendre les diff√©rences fiscales France-Maroc</h2>

            <div class="prose prose-slate max-w-none">
                <h3 class="text-xl font-semibold text-slate-800 mt-6 mb-3">Deux syst√®mes fiscaux diff√©rents</h3>
                <p class="text-slate-600 mb-4">
                    La <strong>France</strong> et le <strong>Maroc</strong> ont des syst√®mes fiscaux fondamentalement diff√©rents. En France, le syst√®me repose sur le <strong>quotient familial</strong> qui divise le revenu imposable par le nombre de parts du foyer, r√©duisant ainsi l'imp√¥t pour les familles. Au Maroc, c'est un syst√®me d'<strong>abattement familial</strong> forfaitaire qui s'applique : 360 MAD par personne √† charge, avec un plafond de 2 160 MAD par an (6 personnes max).
                </p>
                <p class="text-slate-600 mb-4">
                    Les <strong>cotisations sociales</strong> repr√©sentent √©galement une diff√©rence majeure. En France, elles atteignent environ 22% √† 25% du salaire brut (selon le statut cadre/non-cadre), finan√ßant un syst√®me de protection sociale complet. Au Maroc, les cotisations CNSS et AMO sont plus faibles (environ 6,7%), mais la couverture sociale est √©galement moins √©tendue.
                </p>

                <h3 class="text-xl font-semibold text-slate-800 mt-8 mb-3">Pourquoi utiliser ce comparateur ?</h3>
                <p class="text-slate-600 mb-4">
                    Ce comparateur est indispensable pour les <strong>Marocains R√©sidant en France (MRE)</strong> qui envisagent un retour au pays, les <strong>expatri√©s fran√ßais</strong> consid√©rant une mobilit√© au Maroc, ou les <strong>binationaux</strong> h√©sitant entre les deux pays. Il permet de comparer objectivement la <strong>pression fiscale totale</strong> (cotisations + imp√¥ts) et le <strong>salaire net r√©el</strong> dans chaque pays.
                </p>
                <p class="text-slate-600 mb-4">
                    Le comparateur prend en compte le <strong>taux de change EUR/MAD en temps r√©el</strong>, permettant une comparaison pr√©cise des montants. Il int√®gre √©galement les sp√©cificit√©s de chaque syst√®me : quotient familial fran√ßais, abattement pour frais professionnels marocain (20%), plafond CNSS, etc.
                </p>

                <h3 class="text-xl font-semibold text-slate-800 mt-8 mb-3">Les facteurs √† consid√©rer</h3>
                <ul class="list-disc pl-6 text-slate-600 space-y-2 mb-6">
                    <li><strong>Co√ªt de la vie</strong> : Le Maroc est g√©n√©ralement 40-60% moins cher que la France</li>
                    <li><strong>Couverture sociale</strong> : La France offre une protection plus compl√®te (ch√¥mage, retraite, sant√©)</li>
                    <li><strong>Imp√¥t progressif</strong> : Les hauts revenus sont plus tax√©s en France (jusqu'√† 45%) qu'au Maroc (37%)</li>
                    <li><strong>Situation familiale</strong> : Le quotient familial fran√ßais avantage les familles nombreuses</li>
                    <li><strong>Conventions fiscales</strong> : La France et le Maroc ont sign√© une convention pour √©viter la double imposition</li>
                </ul>
            </div>
        </section>

        <!-- Examples Section -->
        <section class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-2xl p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">3 exemples concrets de comparaison</h2>

            <div class="grid md:grid-cols-3 gap-6">
                <!-- Example 1 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üë®‚Äçüéì</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Jeune dipl√¥m√© : 35 000 ‚Ç¨/an</h3>
                    <p class="text-xs text-slate-500 mb-3">Celibataire, sans enfant</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Cotisations: ~7 700 ‚Ç¨ | IR: ~1 460 ‚Ç¨</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~25 840 ‚Ç¨/an</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Maroc (378 000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~11 800 MAD | IR: ~103 400 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~262 800 MAD (~24 300 ‚Ç¨)</div>
                    </div>
                    <p class="text-xs text-indigo-600 mt-4 font-semibold">‚Üí France +1 500 ‚Ç¨/an</p>
                </div>

                <!-- Example 2 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Famille : 60 000 ‚Ç¨/an</h3>
                    <p class="text-xs text-slate-500 mb-3">Marie, 2 enfants</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Cotisations: ~13 200 ‚Ç¨ | IR: ~906 ‚Ç¨ (3 parts)</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~45 900 ‚Ç¨/an</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Maroc (648 000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~17 900 MAD | IR: ~202 600 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~427 500 MAD (~39 600 ‚Ç¨)</div>
                    </div>
                    <p class="text-xs text-indigo-600 mt-4 font-semibold">‚Üí France +6 300 ‚Ç¨/an</p>
                </div>

                <!-- Example 3 -->
                <div class="bg-white rounded-xl p-6 shadow-sm">
                    <div class="text-3xl mb-3">üëî</div>
                    <h3 class="font-bold text-lg text-slate-900 mb-2">Cadre sup√©rieur : 120 000 ‚Ç¨/an</h3>
                    <p class="text-xs text-slate-500 mb-3">Marie, 3 enfants, statut cadre</p>
                    <div class="space-y-2 text-sm border-t pt-3">
                        <div class="flex justify-between"><span class="text-slate-600">üá´üá∑ France</span></div>
                        <div class="text-xs text-slate-500 ml-4">Cotisations: ~30 000 ‚Ç¨ | IR: ~3 940 ‚Ç¨ (4 parts)</div>
                        <div class="font-semibold text-indigo-600 ml-4">Net: ~86 060 ‚Ç¨/an</div>

                        <div class="flex justify-between mt-3"><span class="text-slate-600">üá≤üá¶ Maroc (1 296 000 MAD)</span></div>
                        <div class="text-xs text-slate-500 ml-4">CNSS/AMO: ~32 500 MAD | IR: ~442 900 MAD</div>
                        <div class="font-semibold text-emerald-600 ml-4">Net: ~820 600 MAD (~76 000 ‚Ç¨)</div>
                    </div>
                    <p class="text-xs text-indigo-600 mt-4 font-semibold">‚Üí France +10 000 ‚Ç¨/an</p>
                </div>
            </div>

            <p class="text-xs text-slate-500 text-center mt-6">
                * Estimations bas√©es sur les bar√®mes 2025. Taux de change: 1 EUR = 10.8 MAD. Les montants r√©els peuvent varier.
            </p>
        </section>

        <!-- FAQ Section -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 mt-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6">Questions fr√©quentes France vs Maroc</h2>

            <div class="space-y-6">
                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Quel pays est le plus avantageux fiscalement ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">La France est souvent plus avantageuse fiscalement pour les salari√©s, surtout pour les familles gr√¢ce au quotient familial. Pour un c√©libataire, la diff√©rence peut √™tre faible. En revanche, pour les familles avec enfants, la France offre un net sensiblement sup√©rieur. N'oubliez pas que le co√ªt de la vie est 40-60% moins √©lev√© au Maroc, ce qui peut compenser une fiscalit√© plus √©lev√©e.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Comment fonctionne le quotient familial francais ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Le quotient familial divise le revenu imposable par le nombre de parts : 1 part pour un c√©libataire, 2 parts pour un couple mari√©, +0.5 part pour les 2 premiers enfants, +1 part par enfant suppl√©mentaire. Cela r√©duit la progressivit√© de l'imp√¥t et avantage significativement les familles.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Qu'est-ce que l'abattement familial au Maroc ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Au Maroc, l'abattement familial est une r√©duction forfaitaire de 360 MAD par an et par personne √† charge (conjoint + enfants), plafonn√©e √† 2 160 MAD par an (soit 6 personnes maximum). C'est beaucoup moins avantageux que le quotient familial fran√ßais, surtout pour les familles nombreuses.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Les MRE doivent-ils payer des imp√¥ts en France ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Les Marocains R√©sidant en France (MRE) sont soumis √† l'imp√¥t fran√ßais sur leurs revenus de source fran√ßaise. Gr√¢ce √† la convention fiscale franco-marocaine, ils ne sont pas doublement impos√©s sur les m√™mes revenus. Leurs revenus marocains peuvent √™tre d√©clar√©s en France mais avec un cr√©dit d'imp√¥t.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Quelle est la diff√©rence entre CNSS et S√©curit√© sociale ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">La CNSS (Caisse Nationale de S√©curit√© Sociale) marocaine pr√©l√®ve environ 4,48% du salaire (plafonn√© √† 6 000 MAD/mois) contre ~22-25% pour les cotisations sociales fran√ßaises. La diff√©rence majeure : la France finance ch√¥mage, retraite compl√®te et allocations familiales, tandis que la CNSS offre une couverture plus limit√©e.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Les frais professionnels sont-ils d√©duits pareil ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">En France, un abattement forfaitaire de 10% est appliqu√© automatiquement sur le revenu imposable. Au Maroc, c'est 20% du salaire brut apr√®s cotisations sociales, mais plafonn√© √† 30 000 MAD par an. Le syst√®me marocain est donc plus g√©n√©reux pour les salaires moyens.</p>
                </details>

                <details class="group border-b border-slate-200 pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Comment est calcul√© le taux de change ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Notre comparateur utilise le taux de change EUR/MAD fourni par la Banque Centrale Europ√©enne via l'API Frankfurter. Le taux est mis √† jour en temps r√©el. Vous pouvez √©galement saisir un taux personnalis√© si vous avez un taux sp√©cifique en t√™te.</p>
                </details>

                <details class="group pb-4">
                    <summary class="flex justify-between items-center cursor-pointer list-none">
                        <h3 class="font-semibold text-slate-800">Faut-il consid√©rer le co√ªt de la vie ?</h3>
                        <span class="text-slate-400 group-open:rotate-180 transition-transform">‚ñº</span>
                    </summary>
                    <p class="text-slate-600 mt-3">Absolument ! Ce comparateur ne montre que la fiscalit√©. Le co√ªt de la vie au Maroc est environ 40-60% moins √©lev√© qu'en France (loyer, alimentation, services). Un salaire net inf√©rieur au Maroc peut donc offrir un meilleur pouvoir d'achat qu'en France.</p>
                </details>
            </div>
        </section>

        <!-- Sources Section -->
        <section class="bg-slate-50 rounded-2xl p-6 mt-8">
            <h3 class="font-semibold text-slate-800 mb-4">Sources officielles</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm text-slate-600">
                <div>
                    <p>üá´üá∑ <a href="https://www.impots.gouv.fr" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">impots.gouv.fr</a> - Bareme IR 2025</p>
                    <p>üá´üá∑ <a href="https://www.urssaf.fr" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">urssaf.fr</a> - Taux de cotisations sociales</p>
                </div>
                <div>
                    <p>üá≤üá¶ <a href="https://www.tax.gov.ma" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">tax.gov.ma</a> - Bareme IR Maroc 2025</p>
                    <p>üá≤üá¶ <a href="https://www.cnss.ma" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">cnss.ma</a> - Taux CNSS et AMO</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
        <footer class="py-12 px-6 border-t border-slate-200 bg-white">
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <div class="flex items-center gap-2 mb-4">
                        <div class="w-6 h-6 bg-slate-900 rounded flex items-center justify-center text-white text-xs font-bold">N.</div>
                        <span class="font-semibold text-slate-900">NetSalaire</span>
                    </div>
                    <p class="text-sm text-slate-500">Simulateurs fiscaux gratuits pour la France et le Maroc.</p>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-3 text-sm">France</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="/fr/france/simulateur-salaire-brut-net/" class="hover:text-slate-900">Brut vers Net</a></li>
                        <li><a href="/fr/france/simulateur-impot-revenu/" class="hover:text-slate-900">Simulateur Imp√¥t</a></li>
                        <li><a href="/fr/france/guide/" class="hover:text-slate-900">Guide Fiscal</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-3 text-sm">Maroc</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="/fr/maroc/simulateur-salaire-brut-net/" class="hover:text-slate-900">Brut vers Net</a></li>
                        <li><a href="/fr/maroc/simulateur-impot-revenu/" class="hover:text-slate-900">Simulateur Imp√¥t</a></li>
                        <li><a href="/fr/maroc/guide/" class="hover:text-slate-900">Guide Fiscal</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-3 text-sm">Informations</h4>
                    <ul class="space-y-2 text-sm text-slate-500">
                        <li><a href="/fr/faq/" class="hover:text-slate-900">FAQ</a></li>
                        <li><a href="/fr/mentions-legales/" class="hover:text-slate-900">Mentions L√©gales</a></li>
                        <li><a href="/fr/politique-confidentialite/" class="hover:text-slate-900">Confidentialit√©</a></li>
                    </ul>
                </div>
            </div>
            <div class="pt-8 border-t border-slate-200"><p class="text-sm text-slate-500">&copy; 2025 NetSalaire.com - Tous droits r√©serv√©s</p></div>
        </div>
    </footer>

    <!-- i18n Script -->
    <script src="/assets/js/i18n.js"></script>

    <script>
        // --- CONSTANTS & CONFIG ---
        const TAX_CONFIG = {
            fr: {
                brackets: [
                    { limit: 11294, rate: 0 },
                    { limit: 28797, rate: 0.11 },
                    { limit: 82341, rate: 0.30 },
                    { limit: 177106, rate: 0.41 },
                    { limit: Infinity, rate: 0.45 }
                ],
                cotis_rate_noncadre: 0.22,
                cotis_rate_cadre: 0.25,
                abattement: 0.10
            },
            ma: {
                brackets: [
                    { limit: 30000, rate: 0, deduct: 0 },
                    { limit: 50000, rate: 0.10, deduct: 3000 },
                    { limit: 60000, rate: 0.20, deduct: 8000 },
                    { limit: 80000, rate: 0.30, deduct: 14000 },
                    { limit: 180000, rate: 0.34, deduct: 17200 },
                    { limit: Infinity, rate: 0.38, deduct: 24400 }
                ],
                cnss_rate: 0.0448,
                cnss_ceiling_monthly: 6000,
                amo_rate: 0.0226,
                family_deduction: 360,
                family_deduction_cap: 2160
            }
        };

        // --- STATE ---
        const state = {
            salaryInput: 0,
            salaryCurrency: 'EUR',
            exchangeRate: 10.8,
            period: 'monthly',
            status: 'single',
            children: 0,
            isCadre: false
        };

        // --- DOM ELEMENTS ---
        const els = {
            inputMad: document.getElementById('input-mad'),
            inputEur: document.getElementById('input-eur'),
            inputRate: document.getElementById('exchange-rate'),
            btnMonthly: document.getElementById('period-monthly'),
            btnAnnual: document.getElementById('period-annual'),

            btnSingle: document.getElementById('status-single'),
            btnMarried: document.getElementById('status-married'),
            btnDivorced: document.getElementById('status-divorced'),

            btnChildMinus: document.getElementById('child-minus'),
            btnChildPlus: document.getElementById('child-plus'),
            displayChildren: document.getElementById('children-display'),

            toggleCadre: document.getElementById('toggle-cadre'),

            maNet: document.getElementById('ma-net'),
            maNetEur: document.getElementById('ma-net-eur'),
            maRate: document.getElementById('ma-rate'),
            maTable: document.getElementById('ma-table-body'),
            barMaNet: document.getElementById('bar-ma-net'),
            barMaTax: document.getElementById('bar-ma-tax'),
            barMaSoc: document.getElementById('bar-ma-soc'),

            frNet: document.getElementById('fr-net'),
            frNetMad: document.getElementById('fr-net-mad'),
            frRate: document.getElementById('fr-rate'),
            frTable: document.getElementById('fr-table-body'),
            barFrNet: document.getElementById('bar-fr-net'),
            barFrTax: document.getElementById('bar-fr-tax'),
            barFrSoc: document.getElementById('bar-fr-soc'),

            verdictTitle: document.getElementById('verdict-title'),
            verdictText: document.getElementById('verdict-text'),
            verdictDiff: document.getElementById('verdict-diff'),
            verdictDiffEur: document.getElementById('verdict-diff-eur'),
        };

        // --- FORMATTERS ---
        const formatNumber = (num) => {
            return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        const formatMoney = (amount, currency) => {
            const formatted = formatNumber(amount);
            if (currency === 'MAD') return formatted + ' MAD';
            if (currency === 'EUR') return formatted + ' ‚Ç¨';
            return formatted + ' ' + currency;
        };
        const formatPct = (val) => (val * 100).toFixed(1) + '%';

        const formatInputValue = (value) => {
            const num = value.toString().replace(/\s/g, '').replace(/[^\d]/g, '');
            if (!num) return '';
            return num.replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        const parseInputValue = (value) => {
            return parseFloat(value.replace(/\s/g, '')) || 0;
        };

        function toggleTranches(country) {
            const rows = document.querySelectorAll(`.${country}-tranches-row`);
            const arrow = document.getElementById(`${country}-tranches-arrow`);
            const isHidden = rows[0]?.classList.contains('hidden');

            rows.forEach(row => {
                if (isHidden) {
                    row.classList.remove('hidden');
                } else {
                    row.classList.add('hidden');
                }
            });

            if (arrow) {
                arrow.textContent = isHidden ? '‚ñº' : '‚ñ∂';
            }
        }

        // --- LOGIC ---

        function calculateFrance() {
            let annualGrossEur = state.salaryInput;
            if (state.salaryCurrency === 'MAD') annualGrossEur /= state.exchangeRate;
            if (state.period === 'monthly') annualGrossEur *= 12;

            if (annualGrossEur === 0) return null;

            const cotisRate = state.isCadre ? TAX_CONFIG.fr.cotis_rate_cadre : TAX_CONFIG.fr.cotis_rate_noncadre;
            const socialContrib = annualGrossEur * cotisRate;

            const netImposable = (annualGrossEur - socialContrib) * 0.90;

            let parts = state.status === 'married' ? 2 : 1;

            if (state.children > 0) {
                if (state.children === 1) parts += 0.5;
                else if (state.children === 2) parts += 1.0;
                else parts += 1.0 + (state.children - 2);
            }

            const incomePerPart = netImposable / parts;
            let taxPerPart = 0;
            let previousLimit = 0;
            const bracketsDetail = [];

            for (let i = 0; i < TAX_CONFIG.fr.brackets.length; i++) {
                const bracket = TAX_CONFIG.fr.brackets[i];
                const prevLimit = i === 0 ? 0 : TAX_CONFIG.fr.brackets[i-1].limit;

                if (incomePerPart > prevLimit) {
                    const taxableInBracket = Math.min(incomePerPart, bracket.limit) - prevLimit;
                    const taxInBracket = taxableInBracket * bracket.rate;
                    taxPerPart += taxInBracket;

                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: taxableInBracket,
                        rate: bracket.rate,
                        tax: taxInBracket
                    });
                } else {
                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: 0,
                        rate: bracket.rate,
                        tax: 0
                    });
                }
                previousLimit = bracket.limit;
            }

            const totalTax = taxPerPart * parts;
            const netInPocket = annualGrossEur - socialContrib - totalTax;

            return {
                gross: annualGrossEur,
                social: socialContrib,
                tax: totalTax,
                taxPerPart: taxPerPart,
                parts: parts,
                netImposable: netImposable,
                incomePerPart: incomePerPart,
                bracketsDetail: bracketsDetail,
                net: netInPocket,
                rate: (socialContrib + totalTax) / annualGrossEur
            };
        }

        function calculateMorocco() {
            let annualGrossMad = state.salaryInput;
            if (state.salaryCurrency === 'EUR') annualGrossMad *= state.exchangeRate;
            if (state.period === 'monthly') annualGrossMad *= 12;

            if (annualGrossMad === 0) return null;

            const cnssBase = Math.min(annualGrossMad, 72000);
            const cnss = cnssBase * TAX_CONFIG.ma.cnss_rate;
            const amo = annualGrossMad * TAX_CONFIG.ma.amo_rate;
            const socialContrib = cnss + amo;

            const grossLessSocial = annualGrossMad - socialContrib;
            const proDeduction = Math.min(grossLessSocial * 0.20, 30000);
            const netImposable = grossLessSocial - proDeduction;

            let tax = 0;
            let taxPerPart = 0;
            let previousLimit = 0;
            const bracketsDetail = [];

            for (let i = 0; i < TAX_CONFIG.ma.brackets.length; i++) {
                const bracket = TAX_CONFIG.ma.brackets[i];
                const prevLimit = i === 0 ? 0 : TAX_CONFIG.ma.brackets[i-1].limit;

                if (netImposable > prevLimit) {
                    const taxableInBracket = Math.min(netImposable, bracket.limit) - prevLimit;
                    const taxInBracket = taxableInBracket * bracket.rate;
                    taxPerPart += taxInBracket;

                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: taxableInBracket,
                        rate: bracket.rate,
                        tax: taxInBracket
                    });
                } else {
                    bracketsDetail.push({
                        from: prevLimit,
                        to: bracket.limit,
                        amount: 0,
                        rate: bracket.rate,
                        tax: 0
                    });
                }
                previousLimit = bracket.limit;
            }

            tax = taxPerPart;
            if(tax < 0) tax = 0;

            const spouseCount = state.status === 'married' ? 1 : 0;
            const dependants = spouseCount + state.children;
            const familyReduc = Math.min(dependants * TAX_CONFIG.ma.family_deduction, TAX_CONFIG.ma.family_deduction_cap);
            const taxBeforeReduc = tax;
            tax = Math.max(0, tax - familyReduc);

            const netInPocket = annualGrossMad - socialContrib - tax;

            return {
                gross: annualGrossMad,
                social: socialContrib,
                tax: tax,
                taxBeforeReduc: taxBeforeReduc,
                familyReduc: familyReduc,
                dependants: dependants,
                net: netInPocket,
                rate: (socialContrib + tax) / annualGrossMad,
                netImposable: netImposable,
                bracketsDetail: bracketsDetail
            };
        }

        // --- UI UPDATER ---

        function render() {
            const frData = calculateFrance();
            const maData = calculateMorocco();

            if (!frData || !maData) {
                els.verdictDiff.textContent = "--";
                els.verdictDiffEur.textContent = "";
                return;
            }

            const maMultiplier = state.period === 'monthly' ? 1/12 : 1;

            els.maNet.innerHTML = `${formatNumber(maData.net * maMultiplier)} <span class="text-sm font-normal text-slate-400">MAD</span>`;
            els.maNetEur.textContent = `‚âà ${formatMoney((maData.net * maMultiplier) / state.exchangeRate, 'EUR')}`;
            els.maRate.textContent = formatPct(maData.rate);

            const maTotal = maData.gross;
            els.barMaNet.style.width = (maData.net / maTotal * 100) + '%';
            els.barMaTax.style.width = (maData.tax / maTotal * 100) + '%';
            els.barMaSoc.style.width = (maData.social / maTotal * 100) + '%';

            const familyReducRow = maData.familyReduc > 0
                ? `<tr class="text-emerald-600"><td class="px-4 py-2 pl-6 text-xs">Abattement familial (${maData.dependants} pers.)</td><td class="px-4 py-2 text-right text-xs" colspan="2">+${formatMoney(maData.familyReduc * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>`
                : '';

            let maBracketsHtml = '';
            maData.bracketsDetail.forEach((b, i) => {
                if (b.amount > 0) {
                    const toLabel = b.to === Infinity ? '+' : formatMoney(b.to, 'MAD');
                    maBracketsHtml += `<tr class="text-slate-900 text-[10px]">
                        <td class="px-4 py-1">${formatMoney(b.from, 'MAD')} ‚Üí ${toLabel}</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.amount, 'MAD')}</td>
                        <td class="px-4 py-1 text-right">${(b.rate * 100).toFixed(0)}%</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.tax, 'MAD')}</td>
                    </tr>`;
                }
            });

            els.maTable.innerHTML = `
                <tr><td class="px-4 py-2 font-medium">Salaire Brut</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(maData.gross * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-slate-400">100%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Social (CNSS/AMO)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(maData.social * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(maData.social/maData.gross)}</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Net imposable</td><td class="px-4 py-2 text-right text-xs" colspan="2">${formatMoney(maData.netImposable * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Impot (IR)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(maData.tax * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(maData.tax/maData.gross)}</td></tr>
                ${familyReducRow}
                <tr class="bg-emerald-50/50 font-semibold text-emerald-900"><td class="px-4 py-2">Salaire Net</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(maData.net * maMultiplier, 'MAD')}</td><td class="px-4 py-2 text-right text-emerald-600">${formatPct(maData.net/maData.gross)}</td></tr>
                <tr class="bg-emerald-50 cursor-pointer hover:bg-emerald-100 transition-colors border-t border-emerald-200" onclick="toggleTranches('ma')">
                    <td colspan="4" class="px-4 py-2.5">
                        <span class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2">
                            <span class="flex items-center gap-2 text-[11px] font-semibold text-emerald-700">
                                <span id="ma-tranches-arrow" class="text-emerald-500 transition-transform">‚ñ∂</span>
                                Tranches IR appliquees
                            </span>
                            <span class="text-[10px] text-emerald-600 bg-emerald-100 px-2 py-0.5 rounded-full w-fit">Cliquez pour voir</span>
                        </span>
                    </td>
                </tr>
                <tr class="bg-slate-50 text-[10px] text-slate-500 font-medium ma-tranches-row hidden">
                    <td class="px-4 py-1">Tranche</td>
                    <td class="px-4 py-1 text-right">Montant</td>
                    <td class="px-4 py-1 text-right">Taux</td>
                    <td class="px-4 py-1 text-right">Impot</td>
                </tr>
                ${maBracketsHtml.replace(/class="text-slate-900 text-\[10px\]"/g, 'class="text-slate-900 text-[10px] ma-tranches-row hidden"')}
            `;

            els.frNet.innerHTML = `${formatNumber(frData.net * maMultiplier)} <span class="text-sm font-normal text-slate-400">‚Ç¨</span>`;
            els.frNetMad.textContent = `‚âà ${formatMoney((frData.net * maMultiplier) * state.exchangeRate, 'MAD')}`;
            els.frRate.textContent = formatPct(frData.rate);

            const frTotal = frData.gross;
            els.barFrNet.style.width = (frData.net / frTotal * 100) + '%';
            els.barFrTax.style.width = (frData.tax / frTotal * 100) + '%';
            els.barFrSoc.style.width = (frData.social / frTotal * 100) + '%';

            const netAvantAbattement = (frData.gross - frData.social) * maMultiplier;
            const abattement10 = netAvantAbattement * 0.10;

            let frBracketsHtml = '';
            frData.bracketsDetail.forEach((b, i) => {
                if (b.amount > 0) {
                    const toLabel = b.to === Infinity ? '+' : formatMoney(b.to, 'EUR');
                    frBracketsHtml += `<tr class="text-slate-900 text-[10px]">
                        <td class="px-4 py-1">${formatMoney(b.from, 'EUR')} ‚Üí ${toLabel}</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.amount, 'EUR')}</td>
                        <td class="px-4 py-1 text-right">${(b.rate * 100).toFixed(0)}%</td>
                        <td class="px-4 py-1 text-right">${formatMoney(b.tax, 'EUR')}</td>
                    </tr>`;
                }
            });

            els.frTable.innerHTML = `
                <tr><td class="px-4 py-2 font-medium">Salaire Brut</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(frData.gross * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-slate-400">100%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Charges Sociales (Est.)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(frData.social * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(frData.social/frData.gross)}</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Abattement 10%</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(abattement10, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">10%</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Net imposable</td><td class="px-4 py-2 text-right text-xs" colspan="2">${formatMoney(frData.netImposable * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">-</td></tr>
                <tr class="text-slate-500"><td class="px-4 py-2 pl-6 text-xs">Impot (IR)</td><td class="px-4 py-2 text-right text-xs" colspan="2">-${formatMoney(frData.tax * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-xs">${formatPct(frData.tax/frData.gross)}</td></tr>
                <tr class="bg-indigo-50/50 font-semibold text-indigo-900"><td class="px-4 py-2">Salaire Net</td><td class="px-4 py-2 text-right" colspan="2">${formatMoney(frData.net * maMultiplier, 'EUR')}</td><td class="px-4 py-2 text-right text-indigo-600">${formatPct(frData.net/frData.gross)}</td></tr>
                <tr class="bg-indigo-50 cursor-pointer hover:bg-indigo-100 transition-colors border-t border-indigo-200" onclick="toggleTranches('fr')">
                    <td colspan="4" class="px-4 py-2.5">
                        <span class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2">
                            <span class="flex items-center gap-2 text-[11px] font-semibold text-indigo-700">
                                <span id="fr-tranches-arrow" class="text-indigo-500 transition-transform">‚ñ∂</span>
                                Tranches IR appliquees (${frData.parts} part${frData.parts > 1 ? 's' : ''})
                            </span>
                            <span class="text-[10px] text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded-full w-fit">Cliquez pour voir</span>
                        </span>
                    </td>
                </tr>
                <tr class="bg-slate-50 text-[10px] text-slate-500 font-medium fr-tranches-row hidden">
                    <td class="px-4 py-1">Tranche</td>
                    <td class="px-4 py-1 text-right">Montant</td>
                    <td class="px-4 py-1 text-right">Taux</td>
                    <td class="px-4 py-1 text-right">Impot</td>
                </tr>
                ${frBracketsHtml.replace(/class="text-slate-900 text-\[10px\]"/g, 'class="text-slate-900 text-[10px] fr-tranches-row hidden"')}
                <tr class="text-slate-900 text-[10px] border-t border-slate-200 font-semibold fr-tranches-row hidden">
                    <td class="px-4 py-1">Total (${frData.parts} part${frData.parts > 1 ? 's' : ''})</td>
                    <td class="px-4 py-1 text-right" colspan="2"></td>
                    <td class="px-4 py-1 text-right">${formatMoney(frData.tax, 'EUR')}</td>
                </tr>
            `;

            const frNetInMad = frData.net * state.exchangeRate;
            const maNetInMad = maData.net;
            const diffAnnualMad = Math.abs(frNetInMad - maNetInMad);
            const diffAnnualEur = diffAnnualMad / state.exchangeRate;

            const winner = frNetInMad > maNetInMad ? 'France' : 'Maroc';

            els.verdictDiff.textContent = formatMoney(diffAnnualEur, 'EUR');
            els.verdictDiffEur.textContent = formatMoney(diffAnnualMad, 'MAD');

            const diffPct = Math.abs(frData.rate - maData.rate) * 100;

            if(winner === 'Maroc') {
                els.verdictTitle.innerHTML = `<span class="text-2xl mr-2">üá≤üá¶</span> Le Maroc l'emporte !`;
                els.verdictTitle.className = "font-semibold text-xl tracking-tight text-emerald-400 flex items-center";
                els.verdictText.innerHTML = `
                    <div class="flex items-center gap-4 mt-2">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-emerald-500/20 rounded-lg">
                            <span>üá≤üá¶</span>
                            <span class="font-bold text-emerald-400">${formatPct(maData.rate)}</span>
                        </div>
                        <span class="text-slate-500">vs</span>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 rounded-lg">
                            <span>üá´üá∑</span>
                            <span class="text-slate-300">${formatPct(frData.rate)}</span>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mt-2">Vous economisez <span class="text-emerald-400 font-semibold">${diffPct.toFixed(1)} points</span> de pression fiscale</p>
                `;
            } else {
                els.verdictTitle.innerHTML = `<span class="text-2xl mr-2">üá´üá∑</span> La France l'emporte !`;
                els.verdictTitle.className = "font-semibold text-xl tracking-tight text-indigo-400 flex items-center";
                els.verdictText.innerHTML = `
                    <div class="flex items-center gap-4 mt-2">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-indigo-500/20 rounded-lg">
                            <span>üá´üá∑</span>
                            <span class="font-bold text-indigo-400">${formatPct(frData.rate)}</span>
                        </div>
                        <span class="text-slate-500">vs</span>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 rounded-lg">
                            <span>üá≤üá¶</span>
                            <span class="text-slate-300">${formatPct(maData.rate)}</span>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 mt-2">Vous economisez <span class="text-indigo-400 font-semibold">${diffPct.toFixed(1)} points</span> de pression fiscale</p>
                `;
            }
        }

        // --- EVENT LISTENERS ---

        els.inputMad.addEventListener('input', (e) => {
            const cursorPos = e.target.selectionStart;
            const oldLen = e.target.value.length;

            if(!e.target.value.replace(/\s/g, '')) {
                state.salaryInput = 0;
                e.target.value = '';
                els.inputEur.value = '';
                render();
                return;
            }

            const val = parseInputValue(e.target.value);
            state.salaryInput = val;
            state.salaryCurrency = 'MAD';

            e.target.value = formatInputValue(e.target.value);
            els.inputEur.value = formatInputValue(Math.round(val / state.exchangeRate));

            const newLen = e.target.value.length;
            const newPos = cursorPos + (newLen - oldLen);
            e.target.setSelectionRange(newPos, newPos);

            render();
        });

        els.inputEur.addEventListener('input', (e) => {
            const cursorPos = e.target.selectionStart;
            const oldLen = e.target.value.length;

            if(!e.target.value.replace(/\s/g, '')) {
                state.salaryInput = 0;
                e.target.value = '';
                els.inputMad.value = '';
                render();
                return;
            }

            const val = parseInputValue(e.target.value);
            state.salaryInput = val;
            state.salaryCurrency = 'EUR';

            e.target.value = formatInputValue(e.target.value);
            els.inputMad.value = formatInputValue(Math.round(val * state.exchangeRate));

            const newLen = e.target.value.length;
            const newPos = cursorPos + (newLen - oldLen);
            e.target.setSelectionRange(newPos, newPos);

            render();
        });

        els.inputRate.addEventListener('change', (e) => {
            state.exchangeRate = parseFloat(e.target.value) || 10.8;
            render();
        });

        const setPeriod = (p) => {
            state.period = p;
            if(p === 'monthly') {
                els.btnMonthly.className = "px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300";
                els.btnAnnual.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";
            } else {
                els.btnAnnual.className = "px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900 transition-all-300";
                els.btnMonthly.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";
            }
            render();
        };
        els.btnMonthly.addEventListener('click', () => setPeriod('monthly'));
        els.btnAnnual.addEventListener('click', () => setPeriod('annual'));

        const setStatus = (status) => {
            state.status = status;

            const activeClass = "flex-1 py-1.5 text-[11px] font-medium rounded-md bg-white shadow-sm text-slate-900 border border-slate-100 transition-all-300";
            const inactiveClass = "flex-1 py-1.5 text-[11px] font-medium rounded-md text-slate-500 hover:text-slate-900 transition-all-300";

            els.btnSingle.className = status === 'single' ? activeClass : inactiveClass;
            els.btnMarried.className = status === 'married' ? activeClass : inactiveClass;
            els.btnDivorced.className = status === 'divorced' ? activeClass : inactiveClass;

            render();
        };
        els.btnSingle.addEventListener('click', () => setStatus('single'));
        els.btnMarried.addEventListener('click', () => setStatus('married'));
        els.btnDivorced.addEventListener('click', () => setStatus('divorced'));

        const updateChildren = (val) => {
            if (val < 0) val = 0;
            if (val > 10) val = 10;
            state.children = val;
            els.displayChildren.textContent = state.children;
            render();
        };
        els.btnChildMinus.addEventListener('click', () => updateChildren(state.children - 1));
        els.btnChildPlus.addEventListener('click', () => updateChildren(state.children + 1));

        els.toggleCadre.addEventListener('click', () => {
            state.isCadre = !state.isCadre;
            const dot = els.toggleCadre.querySelector('span');
            if(state.isCadre) {
                els.toggleCadre.classList.replace('bg-slate-200', 'bg-indigo-500');
                dot.classList.add('translate-x-3');
                dot.classList.remove('translate-x-0.5');
            } else {
                els.toggleCadre.classList.replace('bg-indigo-500', 'bg-slate-200');
                dot.classList.remove('translate-x-3');
                dot.classList.add('translate-x-0.5');
            }
            render();
        });

        async function fetchExchangeRate() {
            const rateStatus = document.getElementById('rate-status');
            try {
                const response = await fetch('https://api.frankfurter.app/latest?from=EUR&to=MAD');
                const data = await response.json();
                if (data.rates && data.rates.MAD) {
                    const rate = data.rates.MAD;
                    els.inputRate.value = rate.toFixed(2);
                    state.exchangeRate = rate;
                    rateStatus.textContent = '‚úì';
                    rateStatus.className = 'text-[10px] text-emerald-500';
                    render();
                }
            } catch (error) {
                rateStatus.textContent = '(defaut)';
                rateStatus.className = 'text-[10px] text-slate-400';
            }
        }

        // Init
        fetchExchangeRate();
        setPeriod('annual');
        els.inputEur.value = '100 000';
        els.inputEur.dispatchEvent(new Event('input'));

    </script>

</body>
</html>
