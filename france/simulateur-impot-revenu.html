<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur Impot sur le Revenu 2025 | NetSalaire</title>
    <meta name="description" content="Simulez votre impot sur le revenu 2025 (revenus 2024). Calcul avec quotient familial, PER, dons. Baremes officiels.">
    <meta name="keywords" content="simulateur impot 2025, IR france, quotient familial, PER, reduction impot">
    <link rel="canonical" href="https://netsalaire.com/france/simulateur-impot-revenu.html">

    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
    <link rel="stylesheet" href="/assets/css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Range slider styling */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, #0ea5e9 0%, #0ea5e9 var(--progress, 0%), #e2e8f0 var(--progress, 0%), #e2e8f0 100%);
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 3px solid #0ea5e9;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            transition: transform 0.15s;
        }
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 3px solid #0ea5e9;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        input[type="range"].accent-emerald {
            background: linear-gradient(to right, #10b981 0%, #10b981 var(--progress, 0%), #e2e8f0 var(--progress, 0%), #e2e8f0 100%);
        }
        input[type="range"].accent-emerald::-webkit-slider-thumb {
            border-color: #10b981;
        }
        input[type="range"].accent-violet {
            background: linear-gradient(to right, #8b5cf6 0%, #8b5cf6 var(--progress, 0%), #e2e8f0 var(--progress, 0%), #e2e8f0 100%);
        }
        input[type="range"].accent-violet::-webkit-slider-thumb {
            border-color: #8b5cf6;
        }

        /* Toggle switch */
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            inset: 0;
            background-color: #cbd5e1;
            border-radius: 24px;
            transition: 0.3s;
        }
        .toggle-slider::before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            border-radius: 50%;
            transition: 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .toggle-switch input:checked + .toggle-slider {
            background-color: #0ea5e9;
        }
        .toggle-switch input:checked + .toggle-slider::before {
            transform: translateX(20px);
        }
        .toggle-switch.emerald input:checked + .toggle-slider {
            background-color: #10b981;
        }
        .toggle-switch.violet input:checked + .toggle-slider {
            background-color: #8b5cf6;
        }

        /* Donut chart */
        .donut-chart {
            position: relative;
            width: 180px;
            height: 180px;
        }
        .donut-chart svg {
            transform: rotate(-90deg);
        }
        .donut-center {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Mobile sticky button */
        .mobile-results-btn {
            display: none;
        }
        @media (max-width: 1023px) {
            .mobile-results-btn {
                display: flex;
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 40;
            }
        }

        /* Number input - hide spinners */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }

        /* Sticky results */
        @media (min-width: 1024px) {
            .sticky-results {
                position: sticky;
                top: 80px;
            }
        }
    </style>
</head>
<body class="font-sans bg-slate-50 text-slate-900 min-h-screen">

    <!-- Navigation -->
    <nav class="nav-container">
        <div class="nav-inner">
            <a href="/" class="nav-logo">
                <img src="/assets/images/logo.svg" alt="NetSalaire" height="32">
            </a>

            <button class="nav-toggle" onclick="document.querySelector('.nav-menu').classList.toggle('active')">
                <span class="iconify" data-icon="lucide:menu" width="24"></span>
            </button>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="/comparateur-salaire-france-maroc.html" class="nav-link">
                        <span class="iconify" data-icon="lucide:scale" width="18"></span>
                        Comparateur
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" style="background: var(--bg); color: var(--primary);">
                        <span class="iconify" data-icon="lucide:flag" width="18"></span>
                        France
                        <span class="iconify" data-icon="lucide:chevron-down" width="16"></span>
                    </a>
                    <ul class="nav-dropdown">
                        <li><a href="/france/simulateur-salaire-brut-net.html">Brut vers Net</a></li>
                        <li><a href="/france/simulateur-impot-revenu.html">Simulateur IR</a></li>
                        <li><a href="/france/guide/">Guide Fiscal</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="iconify" data-icon="lucide:flag" width="18"></span>
                        Maroc
                        <span class="iconify" data-icon="lucide:chevron-down" width="16"></span>
                    </a>
                    <ul class="nav-dropdown">
                        <li><a href="/maroc/simulateur-salaire-brut-net.html">Brut vers Net</a></li>
                        <li><a href="/maroc/simulateur-ir.html">Simulateur IR</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="/faq.html" class="nav-link">
                        <span class="iconify" data-icon="lucide:help-circle" width="18"></span>
                        FAQ
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 py-8 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-3">Simulateur Impots 2025</h1>
            <p class="text-slate-500 text-lg max-w-2xl mx-auto">Calculez votre impot sur le revenu 2025 sur les revenus 2024. Baremes officiels.</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">

            <!-- Left Column: Form (3/5) -->
            <div class="lg:col-span-3 space-y-6">

                <!-- Situation Familiale -->
                <section class="bg-white rounded-2xl border border-slate-200 p-6">
                    <h2 class="font-semibold text-lg text-slate-900 mb-6">Situation familiale</h2>

                    <!-- Statut Marital -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-3">Situation au 1er janvier 2024</label>
                        <div class="flex flex-wrap gap-3">
                            <label class="cursor-pointer">
                                <input type="radio" name="status" value="single" class="sr-only peer" checked>
                                <div class="px-5 py-2.5 rounded-full border-2 border-slate-200 text-sm font-medium transition-all peer-checked:border-brand-500 peer-checked:bg-brand-50 peer-checked:text-brand-700 hover:border-slate-300">
                                    Celibataire
                                </div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="status" value="married" class="sr-only peer">
                                <div class="px-5 py-2.5 rounded-full border-2 border-slate-200 text-sm font-medium transition-all peer-checked:border-brand-500 peer-checked:bg-brand-50 peer-checked:text-brand-700 hover:border-slate-300">
                                    Marie(e) / Pacse(e)
                                </div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="status" value="divorced" class="sr-only peer">
                                <div class="px-5 py-2.5 rounded-full border-2 border-slate-200 text-sm font-medium transition-all peer-checked:border-brand-500 peer-checked:bg-brand-50 peer-checked:text-brand-700 hover:border-slate-300">
                                    Divorce(e) / Veuf(ve)
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Enfants -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-3">Enfants a charge</label>
                        <div class="flex items-center gap-4">
                            <button type="button" id="btn-child-minus" class="w-10 h-10 rounded-full border-2 border-slate-200 bg-white flex items-center justify-center hover:bg-slate-50 hover:border-slate-300 transition-colors text-slate-600 text-xl font-medium">
                                -
                            </button>
                            <span id="children-count" class="text-3xl font-bold text-slate-900 w-12 text-center">0</span>
                            <button type="button" id="btn-child-plus" class="w-10 h-10 rounded-full border-2 border-slate-200 bg-white flex items-center justify-center hover:bg-slate-50 hover:border-slate-300 transition-colors text-slate-600 text-xl font-medium">
                                +
                            </button>
                        </div>
                    </div>

                    <!-- Parent Isole -->
                    <div id="parent-isole-section" class="hidden">
                        <label class="flex items-center justify-between p-4 bg-amber-50 rounded-xl cursor-pointer">
                            <div>
                                <span class="font-medium text-slate-900">Parent isole</span>
                                <p class="text-sm text-slate-500">Vous elevez seul(e) vos enfants</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="parent-isole">
                                <span class="toggle-slider"></span>
                            </label>
                        </label>
                    </div>
                </section>

                <!-- Revenus -->
                <section class="bg-white rounded-2xl border border-slate-200 p-6">
                    <h2 class="font-semibold text-lg text-slate-900 mb-6">Revenus annuels 2024</h2>

                    <!-- Revenu Declarant 1 -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Revenu net imposable</label>
                        <div class="relative mb-3">
                            <input type="text" id="income1" inputmode="numeric"
                                class="w-full pl-4 pr-16 py-3 text-right text-xl font-semibold border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500"
                                placeholder="35 000" value="35 000">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm">EUR</span>
                        </div>
                        <input type="range" id="income1-slider" min="0" max="200000" step="1000" value="35000" class="w-full">
                        <div class="flex justify-between text-xs text-slate-400 mt-2">
                            <span>0 EUR</span>
                            <span>200 000 EUR</span>
                        </div>
                    </div>

                    <!-- Revenu Declarant 2 (si marie) -->
                    <div id="income2-section" class="hidden mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Revenu declarant 2</label>
                        <div class="relative mb-3">
                            <input type="text" id="income2" inputmode="numeric"
                                class="w-full pl-4 pr-16 py-3 text-right text-xl font-semibold border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500"
                                placeholder="0" value="0">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm">EUR</span>
                        </div>
                        <input type="range" id="income2-slider" min="0" max="200000" step="1000" value="0" class="w-full">
                    </div>

                    <!-- Revenus Fonciers (collapsible) -->
                    <details class="group">
                        <summary class="flex items-center justify-between py-3 cursor-pointer text-sm font-medium text-slate-600 hover:text-slate-900">
                            <span>+ Ajouter des revenus fonciers</span>
                            <span class="iconify group-open:rotate-180 transition-transform" data-icon="lucide:chevron-down" width="18"></span>
                        </summary>
                        <div class="pt-4">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Revenus fonciers nets</label>
                            <div class="relative">
                                <input type="text" id="foncier" inputmode="numeric"
                                    class="w-full pl-4 pr-16 py-3 text-right font-semibold border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500"
                                    placeholder="0" value="0">
                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm">EUR</span>
                            </div>
                        </div>
                    </details>
                </section>

                <!-- PER -->
                <section class="bg-white rounded-2xl border border-slate-200 p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h2 class="font-semibold text-lg text-slate-900">Plan Epargne Retraite</h2>
                            <p class="text-sm text-slate-500">Deductible du revenu imposable</p>
                        </div>
                        <label class="toggle-switch emerald">
                            <input type="checkbox" id="per-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div id="per-content" class="hidden space-y-4 pt-4 border-t border-slate-100">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-2">Versements PER en 2024</label>
                            <div class="relative mb-3">
                                <input type="text" id="per-amount" inputmode="numeric"
                                    class="w-full pl-4 pr-16 py-3 text-right text-xl font-semibold border border-emerald-200 rounded-xl bg-emerald-50/50 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500"
                                    placeholder="5 000" value="0">
                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-emerald-600 text-sm">EUR</span>
                            </div>
                            <input type="range" id="per-slider" min="0" max="30000" step="500" value="0" class="w-full accent-emerald">
                            <div class="flex justify-between text-xs text-slate-400 mt-2">
                                <span>0 EUR</span>
                                <span>30 000 EUR</span>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="plafond-unknown" class="w-4 h-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500">
                            <label for="plafond-unknown" class="text-sm text-slate-600">Je ne connais pas mon plafond de deduction</label>
                        </div>

                        <div id="plafond-section">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Plafond de deduction disponible</label>
                            <div class="relative">
                                <input type="text" id="per-plafond" inputmode="numeric"
                                    class="w-full pl-4 pr-16 py-3 text-right font-semibold border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500"
                                    placeholder="10 000" value="">
                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm">EUR</span>
                            </div>
                            <p class="text-xs text-slate-400 mt-1">Visible sur votre avis d'imposition</p>
                        </div>
                    </div>
                </section>

                <!-- Dons -->
                <section class="bg-white rounded-2xl border border-slate-200 p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h2 class="font-semibold text-lg text-slate-900">Dons et reductions</h2>
                            <p class="text-sm text-slate-500">Reduction d'impot 66% ou 75%</p>
                        </div>
                        <label class="toggle-switch violet">
                            <input type="checkbox" id="dons-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div id="dons-content" class="hidden space-y-5 pt-4 border-t border-slate-100">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Dons aux associations (66%)</label>
                            <p class="text-xs text-slate-400 mb-2">Associations d'interet general</p>
                            <div class="relative mb-3">
                                <input type="text" id="dons66" inputmode="numeric"
                                    class="w-full pl-4 pr-16 py-3 text-right font-semibold border border-violet-200 rounded-xl bg-violet-50/50 focus:outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500"
                                    placeholder="0" value="0">
                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-violet-600 text-sm">EUR</span>
                            </div>
                            <input type="range" id="dons66-slider" min="0" max="10000" step="100" value="0" class="w-full accent-violet">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Dons aide aux personnes (75%)</label>
                            <p class="text-xs text-slate-400 mb-2">Plafond 1 000 EUR a 75%, le reste a 66%</p>
                            <div class="relative mb-3">
                                <input type="text" id="dons75" inputmode="numeric"
                                    class="w-full pl-4 pr-16 py-3 text-right font-semibold border border-violet-200 rounded-xl bg-violet-50/50 focus:outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500"
                                    placeholder="0" value="0">
                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-violet-600 text-sm">EUR</span>
                            </div>
                            <input type="range" id="dons75-slider" min="0" max="2000" step="50" value="0" class="w-full accent-violet">
                        </div>
                    </div>
                </section>

                <!-- Reset button -->
                <div class="flex items-center justify-between text-sm text-slate-500">
                    <button id="btn-reset" class="px-4 py-2 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors">
                        Reinitialiser
                    </button>
                    <span>Bareme 2025 - Mis a jour janvier 2025</span>
                </div>

            </div>

            <!-- Right Column: Results (2/5) -->
            <div class="lg:col-span-2">
                <div class="sticky-results space-y-4" id="results-container">

                    <!-- Estimation Impot -->
                    <div class="bg-white rounded-2xl border border-slate-200 p-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-slate-500">Estimation impot 2025</span>
                            <button id="btn-share" class="p-2 hover:bg-slate-100 rounded-lg transition-colors" title="Partager">
                                <span class="iconify" data-icon="lucide:share-2" width="18"></span>
                            </button>
                        </div>

                        <div class="text-4xl font-bold text-slate-900 mb-4" id="tax-amount">0 EUR</div>

                        <!-- Metrics -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-slate-50 rounded-xl p-3">
                                <p class="text-xs text-slate-500 mb-1">Taux moyen</p>
                                <p class="text-lg font-bold text-slate-900" id="effective-rate">0%</p>
                            </div>
                            <div class="bg-slate-50 rounded-xl p-3">
                                <p class="text-xs text-slate-500 mb-1">Taux marginal</p>
                                <p class="text-lg font-bold text-slate-900" id="marginal-rate">0%</p>
                            </div>
                        </div>

                        <!-- Progress bar -->
                        <div class="mb-2">
                            <div class="h-2 bg-slate-100 rounded-full overflow-hidden">
                                <div id="tax-progress" class="h-full bg-gradient-to-r from-brand-400 to-brand-600 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Donut Chart + Reste a vivre -->
                    <div class="bg-white rounded-2xl border border-slate-200 p-6">
                        <div class="flex flex-col items-center">
                            <!-- Donut -->
                            <div class="donut-chart mb-6">
                                <svg width="180" height="180" viewBox="0 0 180 180">
                                    <circle cx="90" cy="90" r="70" fill="none" stroke="#e2e8f0" stroke-width="20"/>
                                    <circle id="donut-progress" cx="90" cy="90" r="70" fill="none" stroke="#0ea5e9" stroke-width="20" stroke-dasharray="439.8" stroke-dashoffset="439.8" stroke-linecap="round"/>
                                </svg>
                                <div class="donut-center">
                                    <span class="text-2xl font-bold text-slate-900" id="donut-percent">100%</span>
                                    <span class="text-xs text-slate-500">Net d'impot</span>
                                </div>
                            </div>

                            <!-- Reste a vivre -->
                            <div class="w-full space-y-3">
                                <div class="flex justify-between items-center py-2 border-b border-slate-100">
                                    <span class="text-slate-600">Revenu brut annuel</span>
                                    <span class="font-semibold text-slate-900" id="revenu-brut">0 EUR</span>
                                </div>
                                <div class="flex justify-between items-center py-2 border-b border-slate-100">
                                    <span class="text-slate-600">Impot sur le revenu</span>
                                    <span class="font-semibold text-red-600" id="impot-display">-0 EUR</span>
                                </div>
                                <div class="flex justify-between items-center py-2">
                                    <span class="font-medium text-slate-900">Revenu net annuel</span>
                                    <span class="font-bold text-lg text-emerald-600" id="revenu-net">0 EUR</span>
                                </div>
                                <div class="flex justify-between items-center py-3 bg-emerald-50 rounded-xl px-4 -mx-2">
                                    <span class="font-medium text-emerald-800">Mensuel net d'impot</span>
                                    <span class="font-bold text-xl text-emerald-700" id="mensuel-net">0 EUR</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PER Saving Card -->
                    <div id="per-saving-card" class="hidden bg-gradient-to-r from-emerald-500 to-teal-500 rounded-2xl p-5 text-white">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                                <span class="iconify" data-icon="lucide:piggy-bank" width="24"></span>
                            </div>
                            <div>
                                <p class="text-emerald-100 text-sm">Economie grace au PER</p>
                                <p class="text-2xl font-bold" id="per-saving-display">0 EUR</p>
                            </div>
                        </div>
                    </div>

                    <!-- Dons Saving Card -->
                    <div id="dons-saving-card" class="hidden bg-gradient-to-r from-violet-500 to-purple-500 rounded-2xl p-5 text-white">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                                <span class="iconify" data-icon="lucide:heart" width="24"></span>
                            </div>
                            <div>
                                <p class="text-violet-100 text-sm">Reduction grace aux dons</p>
                                <p class="text-2xl font-bold" id="dons-saving-display">0 EUR</p>
                            </div>
                        </div>
                    </div>

                    <!-- Details du calcul -->
                    <details class="bg-white rounded-2xl border border-slate-200 overflow-hidden">
                        <summary class="p-5 cursor-pointer hover:bg-slate-50 transition-colors flex items-center justify-between font-semibold text-slate-900">
                            Detail du calcul
                            <span class="iconify" data-icon="lucide:chevron-down" width="20"></span>
                        </summary>
                        <div class="px-5 pb-5 space-y-3 text-sm border-t border-slate-100 pt-4">
                            <div class="flex justify-between">
                                <span class="text-slate-600">Revenu brut global</span>
                                <span class="font-medium" id="detail-brut">0 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-600">Abattement 10%</span>
                                <span class="font-medium text-emerald-600" id="detail-abattement">-0 EUR</span>
                            </div>
                            <div id="detail-per-row" class="flex justify-between hidden">
                                <span class="text-slate-600">Deduction PER</span>
                                <span class="font-medium text-emerald-600" id="detail-per">-0 EUR</span>
                            </div>
                            <div class="flex justify-between pt-2 border-t border-slate-100">
                                <span class="font-medium text-slate-900">Revenu net imposable</span>
                                <span class="font-bold" id="detail-net">0 EUR</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-600">Nombre de parts</span>
                                <span class="font-medium" id="detail-parts">1</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-slate-600">Quotient familial</span>
                                <span class="font-medium" id="detail-qf">0 EUR</span>
                            </div>

                            <!-- Tranches -->
                            <div class="pt-3 border-t border-slate-100">
                                <h4 class="font-semibold text-slate-900 mb-3">Tranches d'imposition</h4>
                                <div class="space-y-2 text-xs" id="tranches-list"></div>
                            </div>

                            <div id="detail-dons-row" class="flex justify-between hidden pt-2">
                                <span class="text-slate-600">Reduction dons</span>
                                <span class="font-medium text-violet-600" id="detail-dons">-0 EUR</span>
                            </div>

                            <div class="flex justify-between pt-3 border-t-2 border-slate-200">
                                <span class="font-bold text-slate-900">Impot net a payer</span>
                                <span class="font-bold text-lg text-brand-600" id="detail-final">0 EUR</span>
                            </div>
                        </div>
                    </details>

                    <!-- Conseil -->
                    <div class="bg-amber-50 border border-amber-200 rounded-2xl p-5">
                        <div class="flex gap-3">
                            <span class="iconify text-amber-600 flex-shrink-0 mt-0.5" data-icon="lucide:lightbulb" width="20"></span>
                            <div>
                                <h4 class="font-semibold text-amber-900 text-sm mb-1">Conseil personnalise</h4>
                                <p class="text-sm text-amber-800" id="conseil-text">Entrez vos revenus pour obtenir des conseils.</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </main>

    <!-- Mobile sticky button -->
    <button id="mobile-results-btn" class="mobile-results-btn items-center gap-2 px-6 py-3 bg-brand-600 text-white font-semibold rounded-full shadow-lg hover:bg-brand-700 transition-colors" onclick="document.getElementById('results-container').scrollIntoView({behavior: 'smooth'})">
        <span class="iconify" data-icon="lucide:calculator" width="20"></span>
        Voir mes resultats
    </button>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-inner">
            <div class="footer-grid">
                <div>
                    <h4>NetSalaire</h4>
                    <p>Simulateurs fiscaux gratuits pour la France et le Maroc. Comparez, simulez, optimisez.</p>
                </div>
                <div>
                    <h4>France</h4>
                    <ul>
                        <li><a href="/france/simulateur-salaire-brut-net.html">Brut vers Net</a></li>
                        <li><a href="/france/simulateur-impot-revenu.html">Simulateur IR</a></li>
                        <li><a href="/france/guide/">Guide Fiscal</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Maroc</h4>
                    <ul>
                        <li><a href="/maroc/simulateur-salaire-brut-net.html">Brut vers Net</a></li>
                        <li><a href="/maroc/simulateur-ir.html">Simulateur IR</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Informations</h4>
                    <ul>
                        <li><a href="/faq.html">FAQ</a></li>
                        <li><a href="/mentions-legales.html">Mentions Legales</a></li>
                        <li><a href="/politique-confidentialite.html">Confidentialite</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 NetSalaire.com - Estimation indicative, ne remplace pas l'avis de l'administration fiscale</p>
            </div>
        </div>
    </footer>

    <script>
        // ========== CONSTANTS ==========
        const TAX_BRACKETS_2025 = [
            { limit: 11497, rate: 0 },
            { limit: 29315, rate: 0.11 },
            { limit: 83823, rate: 0.30 },
            { limit: 180294, rate: 0.41 },
            { limit: Infinity, rate: 0.45 }
        ];

        const ABATTEMENT_MIN = 495;
        const ABATTEMENT_MAX = 14171;
        const ABATTEMENT_RATE = 0.10;

        // ========== STATE ==========
        const state = {
            status: 'single',
            children: 0,
            parentIsole: false,
            income1: 35000,
            income2: 0,
            foncier: 0,
            perEnabled: false,
            perAmount: 0,
            perPlafond: null,
            plafondUnknown: false,
            donsEnabled: false,
            dons66: 0,
            dons75: 0
        };

        // ========== DOM ELEMENTS ==========
        const $ = id => document.getElementById(id);
        const $$ = sel => document.querySelectorAll(sel);

        // ========== FORMATTERS ==========
        const formatNumber = (num) => Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        const formatMoney = (num) => formatNumber(num) + ' EUR';
        const parseNumber = (str) => parseFloat(String(str).replace(/\s/g, '').replace(/[^\d.-]/g, '')) || 0;

        // ========== SLIDER PROGRESS ==========
        function updateSliderProgress(slider) {
            const min = parseFloat(slider.min);
            const max = parseFloat(slider.max);
            const val = parseFloat(slider.value);
            const progress = ((val - min) / (max - min)) * 100;
            slider.style.setProperty('--progress', progress + '%');
        }

        // ========== CALCULATIONS ==========
        function calculateParts() {
            let parts = 1;
            if (state.status === 'married') parts = 2;
            if (state.children > 0) {
                if (state.children === 1) parts += 0.5;
                else if (state.children === 2) parts += 1;
                else parts += 1 + (state.children - 2);
            }
            if (state.parentIsole && state.children > 0 && state.status !== 'married') {
                parts += 0.5;
            }
            return parts;
        }

        function calculateAbattement(income) {
            const abattement = income * ABATTEMENT_RATE;
            return Math.min(Math.max(abattement, income > 0 ? ABATTEMENT_MIN : 0), ABATTEMENT_MAX);
        }

        function calculateTax(quotientFamilial) {
            let tax = 0;
            let previousLimit = 0;
            const details = [];

            for (const bracket of TAX_BRACKETS_2025) {
                const taxableInBracket = Math.max(0, Math.min(quotientFamilial, bracket.limit) - previousLimit);
                const taxInBracket = taxableInBracket * bracket.rate;
                tax += taxInBracket;
                details.push({
                    from: previousLimit,
                    to: bracket.limit,
                    amount: taxableInBracket,
                    rate: bracket.rate,
                    tax: taxInBracket,
                    active: taxableInBracket > 0
                });
                previousLimit = bracket.limit;
            }
            return { tax, details };
        }

        function getMarginalRate(quotientFamilial) {
            for (let i = TAX_BRACKETS_2025.length - 1; i >= 0; i--) {
                if (quotientFamilial > (i > 0 ? TAX_BRACKETS_2025[i-1].limit : 0)) {
                    return TAX_BRACKETS_2025[i].rate;
                }
            }
            return 0;
        }

        function calculateDonsReduction() {
            let reduction = 0;
            if (state.dons75 > 0) {
                const at75 = Math.min(state.dons75, 1000);
                const at66 = Math.max(0, state.dons75 - 1000);
                reduction += at75 * 0.75 + at66 * 0.66;
            }
            reduction += state.dons66 * 0.66;
            return reduction;
        }

        // ========== MAIN CALCULATION ==========
        function calculate() {
            // Total income
            let totalIncome = state.income1;
            if (state.status === 'married') totalIncome += state.income2;
            totalIncome += state.foncier;

            // Abattement 10%
            let abattement = 0;
            if (state.income1 > 0) abattement += calculateAbattement(state.income1);
            if (state.status === 'married' && state.income2 > 0) {
                abattement += calculateAbattement(state.income2);
            }

            // PER deduction
            let perDeduction = 0;
            if (state.perEnabled && state.perAmount > 0) {
                if (state.plafondUnknown || !state.perPlafond) {
                    perDeduction = state.perAmount;
                } else {
                    perDeduction = Math.min(state.perAmount, state.perPlafond);
                }
            }

            // Net imposable
            const revenuNetImposable = Math.max(0, totalIncome - abattement - perDeduction);

            // Parts & quotient
            const parts = calculateParts();
            const quotientFamilial = revenuNetImposable / parts;

            // Tax calculation
            const { tax: taxPerPart, details: tranchesDetails } = calculateTax(quotientFamilial);
            let taxBrut = taxPerPart * parts;

            // Dons reduction
            let donsReduction = 0;
            if (state.donsEnabled) {
                donsReduction = calculateDonsReduction();
                const plafondDons = revenuNetImposable * 0.20;
                donsReduction = Math.min(donsReduction, plafondDons);
            }

            const taxFinal = Math.max(0, taxBrut - donsReduction);

            // Marginal rate & PER saving
            const marginalRate = getMarginalRate(quotientFamilial);
            const perSaving = perDeduction * marginalRate;

            // Effective rate
            const effectiveRate = totalIncome > 0 ? (taxFinal / totalIncome * 100) : 0;

            // Net after tax
            const revenuNet = totalIncome - taxFinal;
            const netPercent = totalIncome > 0 ? (revenuNet / totalIncome * 100) : 100;

            // ========== UPDATE UI ==========
            $('tax-amount').textContent = formatMoney(taxFinal);
            $('effective-rate').textContent = effectiveRate.toFixed(1) + '%';
            $('marginal-rate').textContent = (marginalRate * 100) + '%';
            $('tax-progress').style.width = Math.min(effectiveRate * 2.2, 100) + '%';

            // Donut chart
            const circumference = 2 * Math.PI * 70; // 439.8
            const offset = circumference * (1 - netPercent / 100);
            $('donut-progress').style.strokeDashoffset = offset;
            $('donut-percent').textContent = Math.round(netPercent) + '%';

            // Reste a vivre
            $('revenu-brut').textContent = formatMoney(totalIncome);
            $('impot-display').textContent = '-' + formatMoney(taxFinal);
            $('revenu-net').textContent = formatMoney(revenuNet);
            $('mensuel-net').textContent = formatMoney(revenuNet / 12);

            // PER card
            if (state.perEnabled && perSaving > 0) {
                $('per-saving-card').classList.remove('hidden');
                $('per-saving-display').textContent = formatMoney(perSaving);
            } else {
                $('per-saving-card').classList.add('hidden');
            }

            // Dons card
            if (state.donsEnabled && donsReduction > 0) {
                $('dons-saving-card').classList.remove('hidden');
                $('dons-saving-display').textContent = formatMoney(donsReduction);
            } else {
                $('dons-saving-card').classList.add('hidden');
            }

            // Details
            $('detail-brut').textContent = formatMoney(totalIncome);
            $('detail-abattement').textContent = '-' + formatMoney(abattement);

            if (perDeduction > 0) {
                $('detail-per-row').classList.remove('hidden');
                $('detail-per').textContent = '-' + formatMoney(perDeduction);
            } else {
                $('detail-per-row').classList.add('hidden');
            }

            $('detail-net').textContent = formatMoney(revenuNetImposable);
            $('detail-parts').textContent = parts;
            $('detail-qf').textContent = formatMoney(quotientFamilial);

            // Tranches
            let tranchesHtml = '';
            tranchesDetails.forEach((t, i) => {
                if (t.amount > 0) {
                    const toLabel = t.to === Infinity ? '+' : formatNumber(t.to);
                    tranchesHtml += `
                        <div class="flex justify-between py-1.5 px-2 rounded ${t.active ? 'bg-brand-50' : ''}">
                            <span class="text-slate-600">${formatNumber(t.from)} - ${toLabel} EUR (${(t.rate*100)}%)</span>
                            <span class="font-medium">${formatNumber(t.tax)} EUR</span>
                        </div>
                    `;
                }
            });
            $('tranches-list').innerHTML = tranchesHtml;

            if (donsReduction > 0) {
                $('detail-dons-row').classList.remove('hidden');
                $('detail-dons').textContent = '-' + formatMoney(donsReduction);
            } else {
                $('detail-dons-row').classList.add('hidden');
            }

            $('detail-final').textContent = formatMoney(taxFinal);

            // Conseil
            updateConseil(taxFinal, marginalRate, perDeduction, revenuNetImposable);

            // Update URL
            updateURL();
        }

        function updateConseil(tax, marginalRate, perDeduction, revenuNet) {
            let conseil = '';
            if (revenuNet < 11497) {
                conseil = 'Vos revenus sont en dessous du seuil d\'imposition. Vous ne payez pas d\'impot.';
            } else if (!state.perEnabled && marginalRate >= 0.30) {
                conseil = 'Avec un taux marginal de ' + (marginalRate * 100) + '%, un versement PER vous ferait economiser ' + (marginalRate * 100) + '% du montant verse.';
            } else if (state.perEnabled && perDeduction > 0) {
                conseil = 'Votre versement PER vous permet d\'economiser ' + formatMoney(perDeduction * marginalRate) + ' d\'impot cette annee.';
            } else if (state.children >= 2) {
                conseil = 'Avec ' + state.children + ' enfants, le quotient familial reduit significativement votre impot.';
            } else {
                conseil = 'Pensez au PER pour reduire votre impot : chaque euro verse est deductible a votre taux marginal.';
            }
            $('conseil-text').textContent = conseil;
        }

        // ========== URL ==========
        function updateURL() {
            const params = new URLSearchParams();
            params.set('status', state.status);
            params.set('children', state.children);
            if (state.parentIsole) params.set('isole', '1');
            params.set('income1', state.income1);
            if (state.status === 'married' && state.income2 > 0) {
                params.set('income2', state.income2);
            }
            if (state.foncier > 0) params.set('foncier', state.foncier);
            if (state.perEnabled && state.perAmount > 0) {
                params.set('per', state.perAmount);
            }
            if (state.donsEnabled) {
                if (state.dons66 > 0) params.set('dons66', state.dons66);
                if (state.dons75 > 0) params.set('dons75', state.dons75);
            }
            window.history.replaceState({}, '', window.location.pathname + '?' + params.toString());
        }

        function loadFromURL() {
            const params = new URLSearchParams(window.location.search);
            if (params.has('status')) state.status = params.get('status');
            if (params.has('children')) state.children = parseInt(params.get('children')) || 0;
            if (params.has('isole')) state.parentIsole = params.get('isole') === '1';
            if (params.has('income1')) state.income1 = parseNumber(params.get('income1'));
            if (params.has('income2')) state.income2 = parseNumber(params.get('income2'));
            if (params.has('foncier')) state.foncier = parseNumber(params.get('foncier'));
            if (params.has('per')) {
                state.perEnabled = true;
                state.perAmount = parseNumber(params.get('per'));
            }
            if (params.has('dons66') || params.has('dons75')) {
                state.donsEnabled = true;
                state.dons66 = parseNumber(params.get('dons66') || '0');
                state.dons75 = parseNumber(params.get('dons75') || '0');
            }
        }

        // ========== UI SYNC ==========
        function syncUI() {
            // Status radios
            $$('input[name="status"]').forEach(r => {
                r.checked = r.value === state.status;
            });

            // Children
            $('children-count').textContent = state.children;

            // Parent isole
            if ((state.status === 'single' || state.status === 'divorced') && state.children > 0) {
                $('parent-isole-section').classList.remove('hidden');
            } else {
                $('parent-isole-section').classList.add('hidden');
                state.parentIsole = false;
            }
            $('parent-isole').checked = state.parentIsole;

            // Income2 section
            if (state.status === 'married') {
                $('income2-section').classList.remove('hidden');
            } else {
                $('income2-section').classList.add('hidden');
                state.income2 = 0;
            }

            // Incomes
            $('income1').value = formatNumber(state.income1);
            $('income1-slider').value = state.income1;
            updateSliderProgress($('income1-slider'));

            $('income2').value = formatNumber(state.income2);
            $('income2-slider').value = state.income2;
            updateSliderProgress($('income2-slider'));

            $('foncier').value = formatNumber(state.foncier);

            // PER
            $('per-toggle').checked = state.perEnabled;
            $('per-content').classList.toggle('hidden', !state.perEnabled);
            $('per-amount').value = formatNumber(state.perAmount);
            $('per-slider').value = state.perAmount;
            updateSliderProgress($('per-slider'));
            $('plafond-unknown').checked = state.plafondUnknown;
            $('plafond-section').classList.toggle('hidden', state.plafondUnknown);

            // Dons
            $('dons-toggle').checked = state.donsEnabled;
            $('dons-content').classList.toggle('hidden', !state.donsEnabled);
            $('dons66').value = formatNumber(state.dons66);
            $('dons66-slider').value = state.dons66;
            updateSliderProgress($('dons66-slider'));
            $('dons75').value = formatNumber(state.dons75);
            $('dons75-slider').value = state.dons75;
            updateSliderProgress($('dons75-slider'));
        }

        // ========== EVENT LISTENERS ==========

        // Status
        $$('input[name="status"]').forEach(radio => {
            radio.addEventListener('change', () => {
                state.status = radio.value;
                syncUI();
                calculate();
            });
        });

        // Children
        $('btn-child-minus').addEventListener('click', () => {
            if (state.children > 0) { state.children--; syncUI(); calculate(); }
        });
        $('btn-child-plus').addEventListener('click', () => {
            if (state.children < 10) { state.children++; syncUI(); calculate(); }
        });

        // Parent isole
        $('parent-isole').addEventListener('change', () => {
            state.parentIsole = $('parent-isole').checked;
            calculate();
        });

        // Income 1
        $('income1').addEventListener('input', (e) => {
            state.income1 = parseNumber(e.target.value);
            $('income1-slider').value = state.income1;
            updateSliderProgress($('income1-slider'));
            calculate();
        });
        $('income1').addEventListener('blur', () => {
            $('income1').value = formatNumber(state.income1);
        });
        $('income1-slider').addEventListener('input', (e) => {
            state.income1 = parseInt(e.target.value);
            $('income1').value = formatNumber(state.income1);
            updateSliderProgress(e.target);
            calculate();
        });

        // Income 2
        $('income2').addEventListener('input', (e) => {
            state.income2 = parseNumber(e.target.value);
            $('income2-slider').value = state.income2;
            updateSliderProgress($('income2-slider'));
            calculate();
        });
        $('income2').addEventListener('blur', () => {
            $('income2').value = formatNumber(state.income2);
        });
        $('income2-slider').addEventListener('input', (e) => {
            state.income2 = parseInt(e.target.value);
            $('income2').value = formatNumber(state.income2);
            updateSliderProgress(e.target);
            calculate();
        });

        // Foncier
        $('foncier').addEventListener('input', (e) => {
            state.foncier = parseNumber(e.target.value);
            calculate();
        });
        $('foncier').addEventListener('blur', () => {
            $('foncier').value = formatNumber(state.foncier);
        });

        // PER toggle
        $('per-toggle').addEventListener('change', () => {
            state.perEnabled = $('per-toggle').checked;
            syncUI();
            calculate();
        });

        // PER amount
        $('per-amount').addEventListener('input', (e) => {
            state.perAmount = parseNumber(e.target.value);
            $('per-slider').value = state.perAmount;
            updateSliderProgress($('per-slider'));
            calculate();
        });
        $('per-amount').addEventListener('blur', () => {
            $('per-amount').value = formatNumber(state.perAmount);
        });
        $('per-slider').addEventListener('input', (e) => {
            state.perAmount = parseInt(e.target.value);
            $('per-amount').value = formatNumber(state.perAmount);
            updateSliderProgress(e.target);
            calculate();
        });

        // Plafond unknown
        $('plafond-unknown').addEventListener('change', () => {
            state.plafondUnknown = $('plafond-unknown').checked;
            syncUI();
            calculate();
        });

        // PER plafond
        $('per-plafond').addEventListener('input', (e) => {
            state.perPlafond = parseNumber(e.target.value);
            calculate();
        });

        // Dons toggle
        $('dons-toggle').addEventListener('change', () => {
            state.donsEnabled = $('dons-toggle').checked;
            syncUI();
            calculate();
        });

        // Dons 66
        $('dons66').addEventListener('input', (e) => {
            state.dons66 = parseNumber(e.target.value);
            $('dons66-slider').value = state.dons66;
            updateSliderProgress($('dons66-slider'));
            calculate();
        });
        $('dons66').addEventListener('blur', () => {
            $('dons66').value = formatNumber(state.dons66);
        });
        $('dons66-slider').addEventListener('input', (e) => {
            state.dons66 = parseInt(e.target.value);
            $('dons66').value = formatNumber(state.dons66);
            updateSliderProgress(e.target);
            calculate();
        });

        // Dons 75
        $('dons75').addEventListener('input', (e) => {
            state.dons75 = parseNumber(e.target.value);
            $('dons75-slider').value = state.dons75;
            updateSliderProgress($('dons75-slider'));
            calculate();
        });
        $('dons75').addEventListener('blur', () => {
            $('dons75').value = formatNumber(state.dons75);
        });
        $('dons75-slider').addEventListener('input', (e) => {
            state.dons75 = parseInt(e.target.value);
            $('dons75').value = formatNumber(state.dons75);
            updateSliderProgress(e.target);
            calculate();
        });

        // Share
        $('btn-share').addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(window.location.href);
                $('btn-share').innerHTML = '<span class="iconify" data-icon="lucide:check" width="18"></span>';
                setTimeout(() => {
                    $('btn-share').innerHTML = '<span class="iconify" data-icon="lucide:share-2" width="18"></span>';
                }, 2000);
            } catch (err) {
                alert('Lien copie: ' + window.location.href);
            }
        });

        // Reset
        $('btn-reset').addEventListener('click', () => {
            state.status = 'single';
            state.children = 0;
            state.parentIsole = false;
            state.income1 = 35000;
            state.income2 = 0;
            state.foncier = 0;
            state.perEnabled = false;
            state.perAmount = 0;
            state.perPlafond = null;
            state.plafondUnknown = false;
            state.donsEnabled = false;
            state.dons66 = 0;
            state.dons75 = 0;
            syncUI();
            calculate();
        });

        // ========== INIT ==========
        loadFromURL();
        syncUI();
        calculate();

    </script>

</body>
</html>
